webpackJsonp([0],[
/* 0 */
/*!*****************!*\
  !*** multi app ***!
  \*****************/
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = __webpack_require__(/*! ./src/app/index */1);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** multi app\n ** module id = 0\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///multi_app?");

/***/ },
/* 1 */
/*!**************************!*\
  !*** ./src/app/index.js ***!
  \**************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function () {\n\t'use strict';\n\n\t/* global screen: true */\n\n\t/*\n\trequire('style!css!../../bower_components/leaflet/dist/leaflet.css');\n\trequire('../../scss/opennms.scss');\n\trequire('../../bower_components/onmsicons/scss/onmsicons.scss');\n\t*/\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\t__webpack_require__(/*! ionic/release/js/ionic */ 6);\n\t__webpack_require__(/*! ionic/release/js/ionic-angular */ 8);\n\n\t__webpack_require__(/*! ngCordova */ 9);\n\n\t__webpack_require__(/*! ./misc/Array */ 10);\n\t__webpack_require__(/*! ./misc/String */ 11);\n\n\t__webpack_require__(/*! ./misc/Analytics */ 12);\n\t__webpack_require__(/*! ./misc/BuildConfig */ 118);\n\t__webpack_require__(/*! ./misc/Info */ 119);\n\t__webpack_require__(/*! ./misc/Ionic */ 171);\n\t__webpack_require__(/*! ./misc/Modals */ 172);\n\n\t__webpack_require__(/*! ./alarms/AlarmsController */ 183);\n\t__webpack_require__(/*! ./dashboard/DashboardController */ 187);\n\t__webpack_require__(/*! ./nodes/NodeController */ 200);\n\t__webpack_require__(/*! ./nodes/NodesController */ 205);\n\t__webpack_require__(/*! ./nodes/ResourceController */ 207);\n\t__webpack_require__(/*! ./nodes/ResourcesController */ 209);\n\t__webpack_require__(/*! ./settings/SettingsController */ 211);\n\n\t__webpack_require__(/*! ./servers/Servers */ 167);\n\t__webpack_require__(/*! ./misc/util */ 129);\n\n\tvar templates = {\n\t};\n\n\tangular.module('opennms.Main', [\n\t\t'ionic',\n\t\t'ngCordova',\n\t\t'rt.debounce',\n\t\t'opennms.services.BuildConfig',\n\t\t'opennms.services.Analytics',\n\t\t'opennms.services.Info',\n\t\t/*'opennms.services.Ionic',*/\n\t\t'opennms.services.Modals',\n\t\t'opennms.services.Outages',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Util',\n\t\t'opennms.controllers.Alarms',\n\t\t'opennms.controllers.Dashboard',\n\t\t'opennms.controllers.Node',\n\t\t'opennms.controllers.NodeResource',\n\t\t'opennms.controllers.NodeResources',\n\t\t'opennms.controllers.Nodes',\n\t\t'opennms.controllers.Settings'\n\t])\n\t.config(['$compileProvider', '$logProvider', 'config.build.debug', function($compileProvider, $logProvider, isDebug) {\n      /* eslint-disable no-console */\n\t\tisDebug = !!isDebug;\n\t\tconsole.log('debug mode: ' + isDebug);\n\t\t$compileProvider.debugInfoEnabled(isDebug);\n\t\t$logProvider.debugEnabled(isDebug);\n      /* eslint-enable no-console */\n\t}])\n\t.config(function($stateProvider, $urlRouterProvider, $ionicConfigProvider, $cordovaInAppBrowserProvider) {\n\t\t$urlRouterProvider.otherwise('/dashboard');\n\n\t\t$cordovaInAppBrowserProvider.setDefaultOptions({\n\t\t\tlocation:'no',\n\t\t\tenableViewportScale:'yes',\n\t\t\ttransitionstyle:'fliphorizontal',\n\t\t\ttoolbarposition:'top'\n\t\t});\n\n\t\t$ionicConfigProvider.views.maxCache(20);\n\t\t$ionicConfigProvider.views.forwardCache(true);\n\t\t$ionicConfigProvider.views.swipeBackEnabled(false);\n\t\t$ionicConfigProvider.tabs.position('bottom');\n\t\t$ionicConfigProvider.backButton.previousTitleText(false);\n\n\t\t$cordovaInAppBrowserProvider.setDefaultOptions({\n\t\t\tlocation:'no',\n\t\t\tenableViewportScale:'yes',\n\t\t\ttransitionstyle:'fliphorizontal',\n\t\t\ttoolbarposition:'top'\n\t\t});\n\t})\n\t.run(function($rootScope, $http, $log, $templateCache, $timeout, $window, $ionicPlatform, $ionicPopup, debounce, Info, /*IonicService, */ Modals, Servers, util) {\n\n\t\tvar calculateSizes = function() {\n\t\t\t$rootScope.width  = angular.element($window).width();\n\t\t\t$rootScope.height = angular.element($window).height();\n\t\t\tif ($rootScope.height === 0) {\n\t\t\t\t$rootScope.height = $rootScope.width;\n\t\t\t}\n\t\t\tif ($rootScope.width === 0) {\n\t\t\t\t$rootScope.width = $rootScope.height;\n\t\t\t}\n\t\t\tvar minDim = Math.min($rootScope.width, $rootScope.height),\n\t\t\t\tmaxDim = Math.max($rootScope.width, $rootScope.height);\n\n\t\t\t$rootScope.wide = minDim / maxDim >= 0.7 && minDim >= 767; // tablet-sized\n\n\t\t\t$log.debug('main.handleResize complete: width=' + $rootScope.width + ', height=' + $rootScope.height + ', wide=' + $rootScope.wide);\n\t\t};\n\t\tvar handleResize = debounce(100, calculateSizes);\n\n\t\t$rootScope.$on('resize', handleResize);\n\t\t$window.addEventListener('orientationchange', handleResize);\n\t\tcalculateSizes();\n\t\tif (!$rootScope.wide) {\n\t\t\t$log.debug('Looks like we\\'re on a phone-like device.  Locking orientation to portrait.');\n\t\t\tscreen.lockOrientation('portrait');\n\t\t} else {\n\t\t\t$log.debug('Looks like we\\'re on a tablet-like device.');\n\t\t}\n\n\t\tvar updateTheme = function(info) {\n\t\t\tif (!info) {\n\t\t\t\tinfo = Info.get();\n\t\t\t}\n\t\t\tif (info.packageName === 'meridian') {\n\t\t\t\t$rootScope.themeType = 'meridian';\n\t\t\t} else {\n\t\t\t\t$rootScope.themeType = 'horizon';\n\t\t\t}\n\t\t};\n\t\tupdateTheme();\n\t\tutil.onInfoUpdated(updateTheme);\n\n\t\tServers.getDefault().then(function(server) {\n\t\t\t$log.debug('main: default server: ' + (server? server.name : 'unknown'));\n\t\t\tif (server && server.name) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tModals.settings(true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, function(err) {\n\t\t\t$log.error('Failed to get default server: ' + angular.toJson(err));\n\t\t\treturn Modals.settings(true).then(function() {\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}).finally(function() {\n\t\t\t$timeout(function() {\n\t\t\t\tutil.hideSplashscreen();\n\t\t\t}, 1000);\n\t\t});\n\n\t\t$log.info('Ionic is ready.');\n\t});\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/index.js\n ** module id = 1\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/index.js?");

/***/ },
/* 2 */,
/* 3 */,
/* 4 */,
/* 5 */,
/* 6 */,
/* 7 */,
/* 8 */,
/* 9 */,
/* 10 */
/*!*******************************!*\
  !*** ./src/app/misc/Array.js ***!
  \*******************************/
/***/ function(module, exports) {

	eval("if (typeof Array.prototype.filter !== 'function') {\n\tArray.prototype.filter = function(fun/*, thisArg*/) {\n\t\t'use strict';\n\t\t/*jshint bitwise: false*/\n\n\t\tif (this === void 0 || this === null) {\n\t\t\tthrow new TypeError();\n\t\t}\n\n\t\tvar t = Object(this);\n\t\tvar len = t.length >>> 0;\n\t\tif (typeof fun !== 'function') {\n\t\t\tthrow new TypeError();\n\t\t}\n\n\t\tvar res = [];\n\t\tvar thisArg = arguments.length >= 2 ? arguments[1] : void 0;\n\t\tfor (var i = 0; i < len; i++) {\n\t\t\tif (i in t) {\n\t\t\t\tvar val = t[i];\n\n\t\t\t\t// NOTE: Technically this should Object.defineProperty at\n\t\t\t\t//\t\t\t the next index, as push can be affected by\n\t\t\t\t//\t\t\t properties on Object.prototype and Array.prototype.\n\t\t\t\t//\t\t\t But that method's new, and collisions should be\n\t\t\t\t//\t\t\t rare, so use the more-compatible alternative.\n\t\t\t\tif (fun.call(thisArg, val, i, t)) {\n\t\t\t\t\tres.push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t};\n}\n\nif (typeof Array.prototype.difference !== 'function') {\n\tArray.prototype.difference = function(e) {\n\t\t'use strict';\n\t\treturn this.filter(function(i) {return e.indexOf(i) < 0;});\n\t};\n}\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Array.js\n ** module id = 10\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Array.js?");

/***/ },
/* 11 */
/*!********************************!*\
  !*** ./src/app/misc/String.js ***!
  \********************************/
/***/ function(module, exports) {

	eval("if (typeof String.prototype.capitalize !== 'function') {\n\tString.prototype.capitalize = function() {\n\t\t'use strict';\n\t\treturn this.charAt(0).toUpperCase() + this.slice(1).toLowerCase();\n\t};\n}\nif (typeof String.prototype.startsWith !== 'function') {\n\tString.prototype.startsWith = function(str) {\n\t\t'use strict';\n\t\treturn this.lastIndexOf(str, 0) === 0;\n\t};\n}\nif (typeof String.prototype.endsWith !== 'function') {\n\tString.prototype.endsWith = function(suffix) {\n\t\t'use strict';\n\t\treturn this.indexOf(suffix, this.length - suffix.length) !== -1;\n\t};\n}\nif (typeof String.prototype.contains !== 'function') {\n\tString.prototype.contains = function(comparator) {\n\t\t'use strict';\n\t\treturn comparator === undefined? true : this.toLowerCase().indexOf(comparator.toLowerCase()) > -1;\n\t};\n}\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/String.js\n ** module id = 11\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/String.js?");

/***/ },
/* 12 */
/*!***********************************!*\
  !*** ./src/app/misc/Analytics.js ***!
  \***********************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tionic = __webpack_require__(/*! ionic/release/js/ionic */ 6);\n\n\t__webpack_require__(/*! ngCordova */ 9);\n\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\tangular.module('opennms.services.Analytics', [\n\t\t'ionic',\n\t\t'ngCordova',\n\t\t'opennms.services.Settings'\n\t])\n\t.factory('Analytics', ['$rootScope', '$log', '$window', '$cordovaGoogleAnalytics', 'Settings',\n\t\t'config.build.analyticsIdAndroid', 'config.build.analyticsIdIos', 'config.build.analyticsIdOther',\n\t\tfunction($rootScope, $log, $window, $cordovaGoogleAnalytics, Settings,\n\t\tandroidAnalyticsId, iosAnalyticsId, otherAnalyticsId) {\n\n\t\t$log.info('Analytics: Initializing.');\n\n\t\tif ($window.plugins && $window.plugins.analytics) {\n\t\t\t$cordovaGoogleAnalytics.debugMode();\n\t\t\tif (ionic.Platform.isIOS() && iosAnalyticsId) {\n\t\t\t\t$cordovaGoogleAnalytics.startTrackerWithId(iosAnalyticsId);\n\t\t\t} else if (ionic.Platform.isAndroid() && androidAnalyticsId) {\n\t\t\t\t$cordovaGoogleAnalytics.startTrackerWithId(androidAnalyticsId);\n\t\t\t} else if (otherAnalyticsId) {\n\t\t\t\t$cordovaGoogleAnalytics.startTrackerWithId(otherAnalyticsId);\n\t\t\t}\n\t\t\tSettings.uuid().then(function(uuid) {\n\t\t\t\t$cordovaGoogleAnalytics.setUserId(uuid);\n\t\t\t});\n\n\t\t\t$rootScope.$on('opennms.analytics.trackEvent', function(ev, category, name, label, value) {\n\t\t\t\t$cordovaGoogleAnalytics.trackEvent(category, name, label, value);\n\t\t\t});\n\n\t\t\t$rootScope.$on('$ionicView.enter', function(ev, view) {\n\t\t\t\t$cordovaGoogleAnalytics.trackView(view.stateName);\n\t\t\t});\n\t\t}\n\n\t\tvar trackView = function(viewName) {\n\t\t\tif ($window.plugins && $window.plugins.analytics) {\n\t\t\t\t$cordovaGoogleAnalytics.trackView(viewName);\n\t\t\t}\n\t\t};\n\n\t\treturn {\n\t\t\ttrackView: trackView\n\t\t};\n\t}]);\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Analytics.js\n ** module id = 12\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Analytics.js?");

/***/ },
/* 13 */
/*!*********************************************!*\
  !*** ./src/app/settings/SettingsService.js ***!
  \*********************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar DB_NAME = 'settings';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tmoment = __webpack_require__(/*! moment */ 14);\n\n\t__webpack_require__(/*! ../db/db */ 114);\n\t__webpack_require__(/*! ../misc/Analytics */ 12);\n\t__webpack_require__(/*! ../misc/BuildConfig */ 118);\n\n\tangular.module('opennms.services.Settings', [\n\t\t'angularLocalStorage',\n\t\t'uuid4',\n\t\t'opennms.services.BuildConfig',\n\t\t'opennms.services.DB'\n\t])\n\t.value('default-graph-min-range', 30 * 24 * 60 * 60 * 1000) // 1 month\n\t.value('default-graph-range', 24 * 60 * 60 * 1000) // 1 day\n\t.factory('Settings', function($q, $rootScope, $injector, $log, storage, db, uuid4) {\n\t\tvar $scope = $rootScope.$new();\n\n\t\tvar defaultRestLimit = 100;\n\t\tvar defaultRefreshInterval = 10000;\n\n\t\tvar settingsDB = db.get(DB_NAME);\n\t\tsettingsDB.createIndex({\n\t\t\tindex: {\n\t\t\t\tfields: ['key']\n\t\t\t}\n\t\t});\n\n\t\tvar _get = function(key) {\n\t\t\treturn settingsDB.find({\n\t\t\t\tselector: {key: key}\n\t\t\t}).then(function(result) {\n\t\t\t\tif (result && result.docs && result.docs.length === 1) {\n\t\t\t\t\treturn result.docs[0].value;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}).catch(function(err) {\n\t\t\t\treturn null;\n\t\t\t});\n\t\t};\n\n\t\tvar isEmpty = function(v) {\n\t\t\treturn !!(angular.isUndefined(v) || v === '' || v === 'undefined' || v === null);\n\t\t};\n\n\t\tvar ready = $q.defer();\n\n\t\tvar isReady = function() {\n\t\t\tvar deferred = $q.defer();\n\t\t\tready.promise.then(function(r) {\n\t\t\t\tdeferred.resolve(r);\n\t\t\t}, function(err) {\n\t\t\t\tdeferred.resolve(false);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar _saveSettings = function(settings) {\n\t\t\tvar saveme = angular.copy(settings);\n\n\t\t\tif (saveme.defaultServerId) {\n\t\t\t\tstorage.set('opennms.default-server-id', saveme.defaultServerId);\n\t\t\t} else {\n\t\t\t\tstorage.remove('opennms.default-server-id');\n\t\t\t}\n\t\t\tdelete saveme.defaultServerId;\n\n\t\t\tdb.find({\n\t\t\t\tselector: {name: {$gt: null}},\n\t\t\t\tsort: ['key']\n\t\t\t}).then(function(result) {\n\t\t\t\tvar entries = result.docs;\n\t\t\t\tvar existing = {};\n\t\t\t\tfor (var i=0, len=entries.length, entry; i < len; i++) {\n\t\t\t\t\tentry = entries[i];\n\t\t\t\t\texisting[entry.key] = entry;\n\t\t\t\t}\n\n\t\t\t\tvar newKeys = Object.keys(saveme),\n\t\t\t\t\texistingKeys = Object.keys(existing),\n\t\t\t\t\tdeletedKeys = existingKeys.difference(newKeys);\n\n\t\t\t\t$log.debug('Settings._saveSettings: setting: ' + newKeys);\n\t\t\t\t$log.debug('Settings._saveSettings: deleting: ' + deletedKeys);\n\n\t\t\t\tvar operations = [];\n\n\t\t\t\tfor (var i=0, len=newKeys.length, key, entry; i < len; i++) {\n\t\t\t\t\tkey = newKeys[i];\n\t\t\t\t\tif (key === 'defaultServerId') {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tentry = saveme[key];\n\t\t\t\t\t$log.debug('SettingsService: saving ' + angular.toJson(entry));\n\t\t\t\t\tif (existing[key]) {\n\t\t\t\t\t\tif (existing[key].value !== saveme[key].value) {\n\t\t\t\t\t\t\tentry = angular.extend({}, existing[key], saveme[key]);\n\t\t\t\t\t\t\toperations.push(settingsDB.put(entry));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$log.debug('SettingsService: * ' + key + ' has not changed');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\toperations.push(settingsDB.post(entry));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (var i=0, len=deletedKeys.length, key; i < len; i++) {\n\t\t\t\t\tkey = deletedKeys[i];\n\t\t\t\t\toperations.push(settingsDB.remove(existing[key]));\n\t\t\t\t}\n\n\t\t\t\treturn $q.all(operations).then(function() {\n\t\t\t\t\treturn settings;\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar storeSettings = function(settings) {\n\t\t\treturn isReady().then(function() {\n\t\t\t\treturn _saveSettings(settings);\n\t\t\t});\n\t\t};\n\n\t\tvar _loadSettings = function() {\n\t\t\treturn settingsDB.find({\n\t\t\t\tselector: {key: {$gt: null}},\n\t\t\t\tsort: ['key']\n\t\t\t}).then(function(result) {\n\t\t\t\tvar docs = result.docs;\n\t\t\t\tvar settings = {},\n\t\t\t\t\tdefaultServerId = storage.get('opennms.default-server-id');\n\n\t\t\t\tfor (var i=0, len=docs.length, doc; i < len; i++) {\n\t\t\t\t\tdoc = docs[i];\n\t\t\t\t\tsettings[doc.key] = doc.value;\n\t\t\t\t}\n\n\t\t\t\tif (!isEmpty(defaultServerId)) {\n\t\t\t\t\tsettings.defaultServerId = defaultServerId;\n\t\t\t\t}\n\n\t\t\t\t$log.debug('Settings._loadSettings: ' + angular.toJson(settings));\n\t\t\t\treturn settings;\n\t\t\t});\n\t\t};\n\n\t\tvar getSettings = function() {\n\t\t\treturn isReady().then(function() {\n\t\t\t\treturn _loadSettings();\n\t\t\t}).then(function(settings) {\n\t\t\t\tif (isEmpty(settings)) {\n\t\t\t\t\treturn $q.reject('No settings found.');\n\t\t\t\t} else {\n\t\t\t\t\treturn settings;\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\treturn {};\n\t\t\t});\n\t\t};\n\n\t\tvar init = function() {\n\t\t\t$log.info('Settings.init: Initializing.');\n\n\t\t\treturn db.all(DB_NAME).then(function(docs) {\n\t\t\t\tif (docs.length > 0) {\n\t\t\t\t\treturn ready.resolve(true);\n\t\t\t\t}\n\n\t\t\t\tvar oldSettings = storage.get('opennms.settings') || {};\n\n\t\t\t\tif (!oldSettings.uuid) {\n\t\t\t\t\toldSettings.uuid = uuid4.generate();\n\t\t\t\t}\n\t\t\t\tif (!oldSettings.restLimit) {\n\t\t\t\t\toldSettings.restLimit = defaultRestLimit;\n\t\t\t\t}\n\t\t\t\tif (!oldSettings.refreshInterval) {\n\t\t\t\t\toldSettings.refreshInterval = defaultRefreshInterval;\n\t\t\t\t}\n\n\t\t\t\tif (!isEmpty(oldSettings)) {\n\t\t\t\t\tvar keys = Object.keys(oldSettings);\n\t\t\t\t\tfor (var i=0, len=keys.length, key, value; i < len; i++) {\n\t\t\t\t\t\tkey = keys[i];\n\t\t\t\t\t\tvalue = oldSettings[key];\n\t\t\t\t\t\tif (!isEmpty(value)) {\n\t\t\t\t\t\t\tif (key === 'refreshInterval' || key === 'restLimit') {\n\t\t\t\t\t\t\t\tvalue = parseInt(value, 10);\n\t\t\t\t\t\t\t\tif (isNaN(value)) {\n\t\t\t\t\t\t\t\t\tvalue = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsettingsDB.post({key:key,value:value});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstorage.remove('opennms.settings');\n\n\t\t\t\treturn ready.resolve(true);\n\t\t\t});\n\t\t};\n\n\t\tvar saveSettings = function(settings) {\n\t\t\tif (!settings) {\n\t\t\t\treturn $q.reject('Settings.saveSettings: ERROR: no settings provided.');\n\t\t\t}\n\n\t\t\tvar serverTypeMatch = new RegExp('^([Hh][Tt][Tt][Pp][Ss]?):');\n\t\t\tvar changedSettings = {};\n\n\t\t\tif (isEmpty(settings.defaultServerId)) {\n\t\t\t\tsettings.defaultServerId = undefined;\n\t\t\t}\n\n\t\t\tif (settings.defaultServerId) {\n\t\t\t\tdelete settings.server;\n\t\t\t\tdelete settings.username;\n\t\t\t\tdelete settings.password;\n\t\t\t}\n\n\t\t\tif (angular.isUndefined(settings.refreshInterval) || settings.refreshInterval === 'undefined') {\n\t\t\t\tsettings.refreshInterval = undefined;\n\t\t\t} else {\n\t\t\t\tsettings.refreshInterval =  parseInt(settings.refreshInterval, 10);\n\t\t\t\tif (isNaN(settings.refreshInterval)) {\n\t\t\t\t\tsettings.refreshInterval = defaultRefreshInterval;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn getSettings().then(function(oldSettings) {\n\t\t\t\tvar newSettings = angular.copy(settings), prop;\n\n\t\t\t\tif (!oldSettings) {\n\t\t\t\t\toldSettings = {};\n\t\t\t\t}\n\n\t\t\t\tfor (prop in newSettings) {\n\t\t\t\t\tif (newSettings.hasOwnProperty(prop) && newSettings[prop] !== oldSettings[prop]) {\n\t\t\t\t\t\tchangedSettings[prop] = newSettings[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (prop in oldSettings) {\n\t\t\t\t\tif (oldSettings.hasOwnProperty(prop) && !newSettings.hasOwnProperty(prop)) {\n\t\t\t\t\t\tchangedSettings[prop] = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar o = angular.toJson(oldSettings),\n\t\t\t\t\tn = angular.toJson(newSettings),\n\t\t\t\t\tc = angular.toJson(changedSettings);\n\n\t\t\t\tif (c === '{}') {\n\t\t\t\t\t//$log.debug('Settings.saveSettings: settings are unchanged.');\n\t\t\t\t\treturn oldSettings;\n\t\t\t\t} else {\n\t\t\t\t\t$log.debug('Settings.saveSettings: settings have changed.  Updating.');\n\t\t\t\t\t$log.debug('Settings.saveSettings: Old Settings: ' + o);\n\t\t\t\t\t$log.debug('Settings.saveSettings: New Settings: ' + n);\n\n\t\t\t\t\treturn storeSettings(newSettings).then(function(stored) {\n\t\t\t\t\t\tif (changedSettings.server) {\n\t\t\t\t\t\t\tvar match = serverTypeMatch.exec(changedSettings.server);\n\t\t\t\t\t\t\tif (match && match.length > 0) {\n\t\t\t\t\t\t\t\t$rootScope.$broadcast('opennms.analytics.trackEvent', 'settings', 'serverType', 'Server Type', match[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$rootScope.$broadcast('opennms.settings.updated', newSettings, oldSettings, changedSettings);\n\t\t\t\t\t\treturn stored;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tinit();\n\n\t\tvar _getDefaultServerId = function() {\n\t\t\treturn $q.when(storage.get('opennms.default-server-id') || undefined);\n\t\t};\n\n\t\tvar _setDefaultServerId = function(id) {\n\t\t\tstorage.set('opennms.default-server-id', id);\n\t\t\treturn $q.when(id);\n\t\t};\n\n\t\tvar _getRestLimit = function() {\n\t\t\treturn _get('restLimit').then(function(restLimit) {\n\t\t\t\tif (angular.isUndefined(restLimit)) {\n\t\t\t\t\treturn defaultRestLimit;\n\t\t\t\t} else {\n\t\t\t\t\treturn restLimit;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar _uuid = function() {\n\t\t\treturn _get('uuid');\n\t\t};\n\n\t\tvar _version = function() {\n\t\t\treturn $q.when($injector.get('config.build.version'));\n\t\t};\n\n\t\tvar _build = function() {\n\t\t\treturn $q.when($injector.get('config.build.build'));\n\t\t};\n\n\t\tvar _refreshInterval = function() {\n\t\t\treturn _get('refreshInterval').then(function(refreshInterval) {\n\t\t\t\tif (angular.isUndefined(refreshInterval)) {\n\t\t\t\t\treturn defaultRefreshInterval;\n\t\t\t\t} else {\n\t\t\t\t\treturn refreshInterval;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\treturn {\n\t\t\tget: getSettings,\n\t\t\tset: saveSettings,\n\t\t\tgetDefaultServerId: _getDefaultServerId,\n\t\t\tsetDefaultServerId: _setDefaultServerId,\n\t\t\trefreshInterval: _refreshInterval,\n\t\t\trestLimit: _getRestLimit,\n\t\t\tuuid: _uuid,\n\t\t\tversion: _version,\n\t\t\tbuild: _build\n\t\t};\n\t});\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/settings/SettingsService.js\n ** module id = 13\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/settings/SettingsService.js?");

/***/ },
/* 14 */,
/* 15 */,
/* 16 */,
/* 17 */,
/* 18 */,
/* 19 */,
/* 20 */,
/* 21 */,
/* 22 */,
/* 23 */,
/* 24 */,
/* 25 */,
/* 26 */,
/* 27 */,
/* 28 */,
/* 29 */,
/* 30 */,
/* 31 */,
/* 32 */,
/* 33 */,
/* 34 */,
/* 35 */,
/* 36 */,
/* 37 */,
/* 38 */,
/* 39 */,
/* 40 */,
/* 41 */,
/* 42 */,
/* 43 */,
/* 44 */,
/* 45 */,
/* 46 */,
/* 47 */,
/* 48 */,
/* 49 */,
/* 50 */,
/* 51 */,
/* 52 */,
/* 53 */,
/* 54 */,
/* 55 */,
/* 56 */,
/* 57 */,
/* 58 */,
/* 59 */,
/* 60 */,
/* 61 */,
/* 62 */,
/* 63 */,
/* 64 */,
/* 65 */,
/* 66 */,
/* 67 */,
/* 68 */,
/* 69 */,
/* 70 */,
/* 71 */,
/* 72 */,
/* 73 */,
/* 74 */,
/* 75 */,
/* 76 */,
/* 77 */,
/* 78 */,
/* 79 */,
/* 80 */,
/* 81 */,
/* 82 */,
/* 83 */,
/* 84 */,
/* 85 */,
/* 86 */,
/* 87 */,
/* 88 */,
/* 89 */,
/* 90 */,
/* 91 */,
/* 92 */,
/* 93 */,
/* 94 */,
/* 95 */,
/* 96 */,
/* 97 */,
/* 98 */,
/* 99 */,
/* 100 */,
/* 101 */,
/* 102 */,
/* 103 */,
/* 104 */,
/* 105 */,
/* 106 */,
/* 107 */,
/* 108 */,
/* 109 */,
/* 110 */,
/* 111 */,
/* 112 */,
/* 113 */,
/* 114 */
/*!**************************!*\
  !*** ./src/app/db/db.js ***!
  \**************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\twindow.PouchDB = __webpack_require__(/*! pouchdb/dist/pouchdb.min */ 115);\n\t__webpack_require__(/*! pouchdb-find/dist/pouchdb.find.min */ 116);\n\t__webpack_require__(/*! angular-pouchdb */ 117);\n\n\tangular.module('opennms.services.DB', [\n\t\t'ionic',\n\t\t'pouchdb',\n\t\t'uuid4'\n\t]).factory('db', function($q, $rootScope, $log, $window, $ionicPlatform, pouchDB, pouchDBDecorators, uuid4) {\n\t\t$log.info('DB: Initializing.');\n\n\t\tvar dbs = {};\n\t\tvar pouchDbs = {};\n\n\t\tvar getPouch = function(dbname) {\n\t\t\tif (!pouchDbs.hasOwnProperty(dbname)) {\n\t\t\t\tvar db = pouchDB(dbname);\n\n\t\t\t\tdb.find        = pouchDBDecorators.qify(db.find);\n\t\t\t\tdb.createIndex = pouchDBDecorators.qify(db.createIndex);\n\t\t\t\tdb.getIndexes  = pouchDBDecorators.qify(db.getIndexes);\n\t\t\t\tdb.deleteIndex = pouchDBDecorators.qify(db.deleteIndex);\n\n\t\t\t\tpouchDbs[dbname] = db;\n\t\t\t}\n\t\t\treturn pouchDbs[dbname];\n\t\t};\n\n\t\tvar noindexes = function(entry) {\n\t\t\treturn entry.id.indexOf('_design') !== 0;\n\t\t};\n\n\t\tvar allDocs = function(dbname) {\n\t\t\treturn getPouch(dbname).allDocs({\n\t\t\t\tinclude_docs: true\n\t\t\t}).then(function(docs) {\n\t\t\t\tif (docs.total_rows > 0) {\n\t\t\t\t\treturn docs.rows.filter(noindexes).map(function(row) {\n\t\t\t\t\t\treturn row.doc;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar upsert = function(dbname, doc) {\n\t\t\tvar createDoc = function() {\n\t\t\t\treturn getPouch(dbname).post(doc).then(function(response) {\n\t\t\t\t\tdoc._id = response.id;\n\t\t\t\t\tdoc._rev = response.rev;\n\t\t\t\t\treturn doc;\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tif (!doc._id) {\n\t\t\t\treturn createDoc();\n\t\t\t}\n\n\t\t\treturn getPouch(dbname).get(doc._id).then(function(existing) {\n\t\t\t\tdelete doc._id;\n\t\t\t\tdelete doc._rev;\n\t\t\t\tangular.extend(existing, doc);\n\t\t\t\treturn getPouch(dbname).put(existing).then(function(response) {\n\t\t\t\t\tdoc._id = response.id;\n\t\t\t\t\tdoc._rev = response.rev;\n\t\t\t\t\treturn doc;\n\t\t\t\t});\n\t\t\t}).catch(function(err) {\n\t\t\t\tif (err.error && err.reason === 'missing') {\n\t\t\t\t\treturn createDoc();\n\t\t\t\t} else {\n\t\t\t\t\t$log.error('Unable to upsert ' + doc._id + ': ' + err.reason);\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\treturn {\n\t\t\tget: getPouch,\n\t\t\tall: allDocs,\n\t\t\tupsert: upsert\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/db/db.js\n ** module id = 114\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/db/db.js?");

/***/ },
/* 115 */
/*!******************************************************!*\
  !*** ./bower_components/pouchdb/dist/pouchdb.min.js ***!
  \******************************************************/
/***/ function(module, exports) {

	eval("// PouchDB 5.3.0\n// \n// (c) 2012-2016 Dale Harvey and the PouchDB team\n// PouchDB may be freely distributed under the Apache license, version 2.0.\n// For all details and documentation:\n// http://pouchdb.com\n!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var t;t=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,t.PouchDB=e()}}(function(){var e;return function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var u=\"function\"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error(\"Cannot find module '\"+a+\"'\");throw c.code=\"MODULE_NOT_FOUND\",c}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var n=e[a][1][t];return o(n?n:t)},f,f.exports,t,e,n,r)}return n[a].exports}for(var i=\"function\"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){\"use strict\";function r(e){return function(){var t=arguments.length;if(t){for(var n=[],r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}return e.call(this,[])}}t.exports=r},{}],2:[function(e,t,n){function r(){return\"WebkitAppearance\"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var e=arguments,t=this.useColors;if(e[0]=(t?\"%c\":\"\")+this.namespace+(t?\" %c\":\" \")+e[0]+(t?\"%c \":\" \")+\"+\"+n.humanize(this.diff),!t)return e;var r=\"color: \"+this.color;e=[e[0],r,\"color: inherit\"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){\"%%\"!==e&&(o++,\"%c\"===e&&(i=o))}),e.splice(i,0,r),e}function i(){return\"object\"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?n.storage.removeItem(\"debug\"):n.storage.debug=e}catch(t){}}function s(){var e;try{e=n.storage.debug}catch(t){}return e}function u(){try{return window.localStorage}catch(e){}}n=t.exports=e(3),n.log=i,n.formatArgs=o,n.save=a,n.load=s,n.useColors=r,n.storage=\"undefined\"!=typeof chrome&&\"undefined\"!=typeof chrome.storage?chrome.storage.local:u(),n.colors=[\"lightseagreen\",\"forestgreen\",\"goldenrod\",\"dodgerblue\",\"darkorchid\",\"crimson\"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(s())},{3:3}],3:[function(e,t,n){function r(){return n.colors[f++%n.colors.length]}function o(e){function t(){}function o(){var e=o,t=+new Date,i=t-(c||t);e.diff=i,e.prev=c,e.curr=t,c=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=r());var a=Array.prototype.slice.call(arguments);a[0]=n.coerce(a[0]),\"string\"!=typeof a[0]&&(a=[\"%o\"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(t,r){if(\"%%\"===t)return t;s++;var o=n.formatters[r];if(\"function\"==typeof o){var i=a[s];t=o.call(e,i),a.splice(s,1),s--}return t}),\"function\"==typeof n.formatArgs&&(a=n.formatArgs.apply(e,a));var u=o.log||n.log||console.log.bind(console);u.apply(e,a)}t.enabled=!1,o.enabled=!0;var i=n.enabled(e)?o:t;return i.namespace=e,i}function i(e){n.save(e);for(var t=(e||\"\").split(/[\\s,]+/),r=t.length,o=0;r>o;o++)t[o]&&(e=t[o].replace(/\\*/g,\".*?\"),\"-\"===e[0]?n.skips.push(new RegExp(\"^\"+e.substr(1)+\"$\")):n.names.push(new RegExp(\"^\"+e+\"$\")))}function a(){n.enable(\"\")}function s(e){var t,r;for(t=0,r=n.skips.length;r>t;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;r>t;t++)if(n.names[t].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=o,n.coerce=u,n.disable=a,n.enable=i,n.enabled=s,n.humanize=e(9),n.names=[],n.skips=[],n.formatters={};var c,f=0},{9:9}],4:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return\"function\"==typeof e}function i(e){return\"number\"==typeof e}function a(e){return\"object\"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError(\"n must be a positive number\");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,u,c;if(this._events||(this._events={}),\"error\"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified \"error\" event.')}if(n=this._events[e],s(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(a(n))for(i=Array.prototype.slice.call(arguments,1),c=n.slice(),r=c.length,u=0;r>u;u++)c[u].apply(this,i);return!0},r.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError(\"listener must be a function\");return this._events||(this._events={}),this._events.newListener&&this.emit(\"newListener\",e,o(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error(\"(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.\",this._events[e].length),\"function\"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError(\"listener must be a function\");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,i,s;if(!o(t))throw TypeError(\"listener must be a function\");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit(\"removeListener\",e,t);else if(a(n)){for(s=i;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit(\"removeListener\",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)\"removeListener\"!==t&&this.removeAllListeners(t);return this.removeAllListeners(\"removeListener\"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],5:[function(e,t,n){(function(e){\"use strict\";function n(){f=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}f=!1}function r(e){1!==l.push(e)||f||o()}var o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,s=new i(n),u=e.document.createTextNode(\"\");s.observe(u,{characterData:!0}),o=function(){u.data=a=++a%2}}else if(e.setImmediate||\"undefined\"==typeof e.MessageChannel)o=\"document\"in e&&\"onreadystatechange\"in e.document.createElement(\"script\")?function(){var t=e.document.createElement(\"script\");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,o=function(){c.port2.postMessage(0)}}var f,l=[];t.exports=r}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],6:[function(e,t,n){\"function\"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],7:[function(e,t,n){(function(e){e(\"object\"==typeof n?n:this)}).call(this,function(e){var t=Array.prototype.slice,n=Array.prototype.forEach,r=function(e){if(\"object\"!=typeof e)throw e+\" is not an object\";var o=t.call(arguments,1);return n.call(o,function(t){if(t)for(var n in t)\"object\"==typeof t[n]&&e[n]?r.call(e,e[n],t[n]):e[n]=t[n]}),e};e.extend=r})},{}],8:[function(e,t,n){\"use strict\";function r(){}function o(e){if(\"function\"!=typeof e)throw new TypeError(\"resolver must be a function\");this.state=m,this.queue=[],this.outcome=void 0,e!==r&&u(this,e)}function i(e,t,n){this.promise=e,\"function\"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),\"function\"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){p(function(){var r;try{r=t(n)}catch(o){return v.reject(e,o)}r===e?v.reject(e,new TypeError(\"Cannot resolve promise with itself\")):v.resolve(e,r)})}function s(e){var t=e&&e.then;return e&&\"object\"==typeof e&&\"function\"==typeof t?function(){t.apply(e,arguments)}:void 0}function u(e,t){function n(t){i||(i=!0,v.reject(e,t))}function r(t){i||(i=!0,v.resolve(e,t))}function o(){t(r,n)}var i=!1,a=c(o);\"error\"===a.status&&n(a.value)}function c(e,t){var n={};try{n.value=e(t),n.status=\"success\"}catch(r){n.status=\"error\",n.value=r}return n}function f(e){return e instanceof this?e:v.resolve(new this(r),e)}function l(e){var t=new this(r);return v.reject(t,e)}function d(e){function t(e,t){function r(e){a[t]=e,++s!==o||i||(i=!0,v.resolve(c,a))}n.resolve(e).then(r,function(e){i||(i=!0,v.reject(c,e))})}var n=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var a=new Array(o),s=0,u=-1,c=new this(r);++u<o;)t(e[u],u);return c}function h(e){function t(e){n.resolve(e).then(function(e){i||(i=!0,v.resolve(s,e))},function(e){i||(i=!0,v.reject(s,e))})}var n=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var a=-1,s=new this(r);++a<o;)t(e[a]);return s}var p=e(5),v={},y=[\"REJECTED\"],_=[\"FULFILLED\"],m=[\"PENDING\"];t.exports=n=o,o.prototype[\"catch\"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if(\"function\"!=typeof e&&this.state===_||\"function\"!=typeof t&&this.state===y)return this;var n=new this.constructor(r);if(this.state!==m){var o=this.state===_?e:t;a(n,o,this.outcome)}else this.queue.push(new i(n,e,t));return n},i.prototype.callFulfilled=function(e){v.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){v.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},v.resolve=function(e,t){var n=c(s,t);if(\"error\"===n.status)return v.reject(e,n.value);var r=n.value;if(r)u(e,r);else{e.state=_,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},v.reject=function(e,t){e.state=y,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},n.resolve=f,n.reject=l,n.all=d,n.race=h},{5:5}],9:[function(e,t,n){function r(e){if(e=\"\"+e,!(e.length>1e4)){var t=/^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||\"ms\").toLowerCase();switch(r){case\"years\":case\"year\":case\"yrs\":case\"yr\":case\"y\":return n*l;case\"days\":case\"day\":case\"d\":return n*f;case\"hours\":case\"hour\":case\"hrs\":case\"hr\":case\"h\":return n*c;case\"minutes\":case\"minute\":case\"mins\":case\"min\":case\"m\":return n*u;case\"seconds\":case\"second\":case\"secs\":case\"sec\":case\"s\":return n*s;case\"milliseconds\":case\"millisecond\":case\"msecs\":case\"msec\":case\"ms\":return n}}}}function o(e){return e>=f?Math.round(e/f)+\"d\":e>=c?Math.round(e/c)+\"h\":e>=u?Math.round(e/u)+\"m\":e>=s?Math.round(e/s)+\"s\":e+\"ms\"}function i(e){return a(e,f,\"day\")||a(e,c,\"hour\")||a(e,u,\"minute\")||a(e,s,\"second\")||e+\" ms\"}function a(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+\" \"+n:Math.ceil(e/t)+\" \"+n+\"s\"}var s=1e3,u=60*s,c=60*u,f=24*c,l=365.25*f;t.exports=function(e,t){return t=t||{},\"string\"==typeof e?r(e):t[\"long\"]?i(e):o(e)}},{}],10:[function(e,t,n){\"use strict\";function r(e){if(null!==e)switch(typeof e){case\"boolean\":return e?1:0;case\"number\":return f(e);case\"string\":return e.replace(/\\u0002/g,\"\u0002\u0002\").replace(/\\u0001/g,\"\u0001\u0002\").replace(/\\u0000/g,\"\u0001\u0001\");case\"object\":var t=Array.isArray(e),r=t?e:Object.keys(e),o=-1,i=r.length,a=\"\";if(t)for(;++o<i;)a+=n.toIndexableString(r[o]);else for(;++o<i;){var s=r[o];a+=n.toIndexableString(s)+n.toIndexableString(e[s])}return a}return\"\"}function o(e,t){var n,r=t,o=\"1\"===e[t];if(o)n=0,t++;else{var i=\"0\"===e[t];t++;var a=\"\",s=e.substring(t,t+d),u=parseInt(s,10)+l;for(i&&(u=-u),t+=d;;){var c=e[t];if(\"\\x00\"===c)break;a+=c,t++}a=a.split(\".\"),n=1===a.length?parseInt(a,10):parseFloat(a[0]+\".\"+a[1]),i&&(n-=10),0!==u&&(n=parseFloat(n+\"e\"+u))}return{num:n,length:t-r}}function i(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var o=r.element,i=r.index;if(Array.isArray(o))o.push(n);else if(i===e.length-2){var a=e.pop();o[a]=n}else e.push(n)}}function a(e,t){for(var r=Math.min(e.length,t.length),o=0;r>o;o++){var i=n.collate(e[o],t[o]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function s(e,t){return e===t?0:e>t?1:-1}function u(e,t){for(var r=Object.keys(e),o=Object.keys(t),i=Math.min(r.length,o.length),a=0;i>a;a++){var s=n.collate(r[a],o[a]);if(0!==s)return s;if(s=n.collate(e[r[a]],t[o[a]]),0!==s)return s}return r.length===o.length?0:r.length>o.length?1:-1}function c(e){var t=[\"boolean\",\"number\",\"string\",\"object\"],n=t.indexOf(typeof e);return~n?null===e?1:Array.isArray(e)?5:3>n?n+2:n+3:Array.isArray(e)?5:void 0}function f(e){if(0===e)return\"1\";var t=e.toExponential().split(/e\\+?/),n=parseInt(t[1],10),r=0>e,o=r?\"0\":\"2\",i=(r?-n:n)-l,a=p.padLeft(i.toString(),\"0\",d);o+=h+a;var s=Math.abs(parseFloat(t[0]));r&&(s=10-s);var u=s.toFixed(20);return u=u.replace(/\\.?0+$/,\"\"),o+=h+u}var l=-324,d=3,h=\"\",p=e(11);n.collate=function(e,t){if(e===t)return 0;e=n.normalizeKey(e),t=n.normalizeKey(t);var r=c(e),o=c(t);if(r-o!==0)return r-o;if(null===e)return 0;switch(typeof e){case\"number\":return e-t;case\"boolean\":return e===t?0:t>e?-1:1;case\"string\":return s(e,t)}return Array.isArray(e)?a(e,t):u(e,t)},n.normalizeKey=function(e){switch(typeof e){case\"undefined\":return null;case\"number\":return e===1/0||e===-(1/0)||isNaN(e)?null:e;case\"object\":var t=e;if(Array.isArray(e)){var r=e.length;e=new Array(r);for(var o=0;r>o;o++)e[o]=n.normalizeKey(t[o])}else{if(e instanceof Date)return e.toJSON();if(null!==e){e={};for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];\"undefined\"!=typeof a&&(e[i]=n.normalizeKey(a))}}}}return e},n.toIndexableString=function(e){var t=\"\\x00\";return e=n.normalizeKey(e),c(e)+h+r(e)+t},n.parseIndexableString=function(e){for(var t=[],n=[],r=0;;){var a=e[r++];if(\"\\x00\"!==a)switch(a){case\"1\":t.push(null);break;case\"2\":t.push(\"1\"===e[r]),r++;break;case\"3\":var s=o(e,r);t.push(s.num),r+=s.length;break;case\"4\":for(var u=\"\";;){var c=e[r];if(\"\\x00\"===c)break;u+=c,r++}u=u.replace(/\\u0001\\u0001/g,\"\\x00\").replace(/\\u0001\\u0002/g,\"\u0001\").replace(/\\u0002\\u0002/g,\"\u0002\"),t.push(u);break;case\"5\":var f={element:[],index:t.length};t.push(f.element),n.push(f);break;case\"6\":var l={element:{},index:t.length};t.push(l.element),n.push(l);break;default:throw new Error(\"bad collationIndex or unexpectedly reached end of input: \"+a)}else{if(1===t.length)return t.pop();i(t,n)}}}},{11:11}],11:[function(e,t,n){\"use strict\";function r(e,t,n){for(var r=\"\",o=n-e.length;r.length<o;)r+=t;return r}n.padLeft=function(e,t,n){var o=r(e,t,n);return o+e},n.padRight=function(e,t,n){var o=r(e,t,n);return e+o},n.stringLexCompare=function(e,t){var n,r=e.length,o=t.length;for(n=0;r>n;n++){if(n===o)return 1;var i=e.charAt(n),a=t.charAt(n);if(i!==a)return a>i?-1:1}return o>r?-1:0},n.intToDecimalForm=function(e){var t=0>e,n=\"\";do{var r=t?-Math.ceil(e%10):Math.floor(e%10);n=r+n,e=t?Math.ceil(e/10):Math.floor(e/10)}while(e);return t&&\"0\"!==n&&(n=\"-\"+n),n}},{}],12:[function(e,t,n){\"use strict\";function r(){this.store={}}function o(e){if(this.store=new r,e&&Array.isArray(e))for(var t=0,n=e.length;n>t;t++)this.add(e[t])}n.Map=r,n.Set=o,r.prototype.mangle=function(e){if(\"string\"!=typeof e)throw new TypeError(\"key must be a string but Got \"+e);return\"$\"+e},r.prototype.unmangle=function(e){return e.substring(1)},r.prototype.get=function(e){var t=this.mangle(e);return t in this.store?this.store[t]:void 0},r.prototype.set=function(e,t){var n=this.mangle(e);return this.store[n]=t,!0},r.prototype.has=function(e){var t=this.mangle(e);return t in this.store},r.prototype[\"delete\"]=function(e){var t=this.mangle(e);return t in this.store?(delete this.store[t],!0):!1},r.prototype.forEach=function(e){for(var t=Object.keys(this.store),n=0,r=t.length;r>n;n++){var o=t[n],i=this.store[o];o=this.unmangle(o),e(i,o)}},o.prototype.add=function(e){return this.store.set(e,!0)},o.prototype.has=function(e){return this.store.has(e)},o.prototype[\"delete\"]=function(e){return this.store[\"delete\"](e)}},{}],13:[function(e,t,n){function r(){f=!1,s.length?c=s.concat(c):l=-1,c.length&&o()}function o(){if(!f){var e=setTimeout(r);f=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,f=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function a(){}var s,u=t.exports={},c=[],f=!1,l=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new i(e,t)),1!==c.length||f||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title=\"browser\",u.browser=!0,u.env={},u.argv=[],u.version=\"\",u.versions={},u.on=a,u.addListener=a,u.once=a,u.off=a,u.removeListener=a,u.removeAllListeners=a,u.emit=a,u.binding=function(e){throw new Error(\"process.binding is not supported\")},u.cwd=function(){return\"/\"},u.chdir=function(e){throw new Error(\"process.chdir is not supported\")},u.umask=function(){return 0}},{}],14:[function(e,t,n){(function(){var e={}.hasOwnProperty,n=[].slice;t.exports=function(t,r){var o,i,a,s;i=[],s=[];for(o in r)e.call(r,o)&&(a=r[o],\"this\"!==o&&(i.push(o),s.push(a)));return Function.apply(null,n.call(i).concat([t])).apply(r[\"this\"],s)}}).call(this)},{}],15:[function(t,n,r){!function(t){if(\"object\"==typeof r)n.exports=t();else if(\"function\"==typeof e&&e.amd)e(t);else{var o;try{o=window}catch(i){o=self}o.SparkMD5=t()}}(function(e){\"use strict\";function t(e,t,n,r,o,i){return t=g(g(t,e),g(r,i)),g(t<<o|t>>>32-o,n)}function n(e,n,r,o,i,a,s){return t(n&r|~n&o,e,n,i,a,s)}function r(e,n,r,o,i,a,s){return t(n&o|r&~o,e,n,i,a,s)}function o(e,n,r,o,i,a,s){return t(n^r^o,e,n,i,a,s)}function i(e,n,r,o,i,a,s){return t(r^(n|~o),e,n,i,a,s)}function a(e,t){var a=e[0],s=e[1],u=e[2],c=e[3];a=n(a,s,u,c,t[0],7,-680876936),c=n(c,a,s,u,t[1],12,-389564586),u=n(u,c,a,s,t[2],17,606105819),s=n(s,u,c,a,t[3],22,-1044525330),a=n(a,s,u,c,t[4],7,-176418897),c=n(c,a,s,u,t[5],12,1200080426),u=n(u,c,a,s,t[6],17,-1473231341),s=n(s,u,c,a,t[7],22,-45705983),a=n(a,s,u,c,t[8],7,1770035416),c=n(c,a,s,u,t[9],12,-1958414417),u=n(u,c,a,s,t[10],17,-42063),s=n(s,u,c,a,t[11],22,-1990404162),a=n(a,s,u,c,t[12],7,1804603682),c=n(c,a,s,u,t[13],12,-40341101),u=n(u,c,a,s,t[14],17,-1502002290),s=n(s,u,c,a,t[15],22,1236535329),a=r(a,s,u,c,t[1],5,-165796510),c=r(c,a,s,u,t[6],9,-1069501632),u=r(u,c,a,s,t[11],14,643717713),s=r(s,u,c,a,t[0],20,-373897302),a=r(a,s,u,c,t[5],5,-701558691),c=r(c,a,s,u,t[10],9,38016083),u=r(u,c,a,s,t[15],14,-660478335),s=r(s,u,c,a,t[4],20,-405537848),a=r(a,s,u,c,t[9],5,568446438),c=r(c,a,s,u,t[14],9,-1019803690),u=r(u,c,a,s,t[3],14,-187363961),s=r(s,u,c,a,t[8],20,1163531501),a=r(a,s,u,c,t[13],5,-1444681467),c=r(c,a,s,u,t[2],9,-51403784),u=r(u,c,a,s,t[7],14,1735328473),s=r(s,u,c,a,t[12],20,-1926607734),a=o(a,s,u,c,t[5],4,-378558),c=o(c,a,s,u,t[8],11,-2022574463),u=o(u,c,a,s,t[11],16,1839030562),s=o(s,u,c,a,t[14],23,-35309556),a=o(a,s,u,c,t[1],4,-1530992060),c=o(c,a,s,u,t[4],11,1272893353),u=o(u,c,a,s,t[7],16,-155497632),s=o(s,u,c,a,t[10],23,-1094730640),a=o(a,s,u,c,t[13],4,681279174),c=o(c,a,s,u,t[0],11,-358537222),u=o(u,c,a,s,t[3],16,-722521979),s=o(s,u,c,a,t[6],23,76029189),a=o(a,s,u,c,t[9],4,-640364487),c=o(c,a,s,u,t[12],11,-421815835),u=o(u,c,a,s,t[15],16,530742520),s=o(s,u,c,a,t[2],23,-995338651),a=i(a,s,u,c,t[0],6,-198630844),c=i(c,a,s,u,t[7],10,1126891415),u=i(u,c,a,s,t[14],15,-1416354905),s=i(s,u,c,a,t[5],21,-57434055),a=i(a,s,u,c,t[12],6,1700485571),c=i(c,a,s,u,t[3],10,-1894986606),u=i(u,c,a,s,t[10],15,-1051523),s=i(s,u,c,a,t[1],21,-2054922799),a=i(a,s,u,c,t[8],6,1873313359),c=i(c,a,s,u,t[15],10,-30611744),u=i(u,c,a,s,t[6],15,-1560198380),s=i(s,u,c,a,t[13],21,1309151649),a=i(a,s,u,c,t[4],6,-145523070),c=i(c,a,s,u,t[11],10,-1120210379),u=i(u,c,a,s,t[2],15,718787259),s=i(s,u,c,a,t[9],21,-343485551),e[0]=g(a,e[0]),e[1]=g(s,e[1]),e[2]=g(u,e[2]),e[3]=g(c,e[3])}function s(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function u(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function c(e){var t,n,r,o,i,u,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;c>=t;t+=64)a(f,s(e.substring(t-64,t)));for(e=e.substring(t-64),n=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;n>t;t+=1)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(a(f,r),t=0;16>t;t+=1)r[t]=0;return o=8*c,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),u=parseInt(o[1],16)||0,r[14]=i,r[15]=u,a(f,r),f}function f(e){var t,n,r,o,i,s,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;c>=t;t+=64)a(f,u(e.subarray(t-64,t)));for(e=c>t-64?e.subarray(t-64):new Uint8Array(0),n=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;n>t;t+=1)r[t>>2]|=e[t]<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(a(f,r),t=0;16>t;t+=1)r[t]=0;return o=8*c,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),s=parseInt(o[1],16)||0,r[14]=i,r[15]=s,a(f,r),f}function l(e){var t,n=\"\";for(t=0;4>t;t+=1)n+=b[e>>8*t+4&15]+b[e>>8*t&15];return n}function d(e){var t;for(t=0;t<e.length;t+=1)e[t]=l(e[t]);return e.join(\"\")}function h(e){return/[\\u0080-\\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function p(e,t){var n,r=e.length,o=new ArrayBuffer(r),i=new Uint8Array(o);for(n=0;r>n;n+=1)i[n]=e.charCodeAt(n);return t?i:o}function v(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function y(e,t,n){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e)),r.set(new Uint8Array(t),e.byteLength),n?r:r.buffer}function _(e){var t,n=[],r=e.length;for(t=0;r-1>t;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function m(){this.reset()}var g=function(e,t){return e+t&4294967295},b=[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\"];return\"5d41402abc4b2a76b9719d911017c592\"!==d(c(\"hello\"))&&(g=function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}),\"undefined\"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function t(e,t){return e=0|e||0,0>e?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,r){var o,i,a,s,u=this.byteLength,c=t(n,u),f=u;return r!==e&&(f=t(r,u)),c>f?new ArrayBuffer(0):(o=f-c,i=new ArrayBuffer(o),a=new Uint8Array(i),s=new Uint8Array(this,c,o),a.set(s),i)}}(),m.prototype.append=function(e){return this.appendBinary(h(e)),this},m.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,n=this._buff.length;for(t=64;n>=t;t+=64)a(this._hash,s(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},m.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;o>t;t+=1)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),n=d(this._hash),e&&(n=_(n)),this.reset(),n},m.prototype.reset=function(){return this._buff=\"\",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},m.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(e,t){var n,r,o,i=t;if(e[i>>2]|=128<<(i%4<<3),i>55)for(a(this._hash,e),i=0;16>i;i+=1)e[i]=0;n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=r,e[15]=o,a(this._hash,e)},m.hash=function(e,t){return m.hashBinary(h(e),t)},m.hashBinary=function(e,t){var n=c(e),r=d(n);return t?_(r):r},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(e){var t,n=y(this._buff.buffer,e,!0),r=n.length;for(this._length+=e.byteLength,t=64;r>=t;t+=64)a(this._hash,u(n.subarray(t-64,t)));return this._buff=r>t-64?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;o>t;t+=1)i[t>>2]|=r[t]<<(t%4<<3);return this._finish(i,o),n=d(this._hash),e&&(n=_(n)),this.reset(),n},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var e=m.prototype.getState.call(this);return e.buff=v(e.buff),e},m.ArrayBuffer.prototype.setState=function(e){return e.buff=p(e.buff,!0),m.prototype.setState.call(this,e)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(e,t){var n=f(new Uint8Array(e)),r=d(n);return t?_(r):r},m})},{}],16:[function(e,t,n){\"use strict\";function r(e,t,n){var r=n[n.length-1];e===r.element&&(n.pop(),r=n[n.length-1]);var o=r.element,i=r.index;if(Array.isArray(o))o.push(e);else if(i===t.length-2){var a=t.pop();o[a]=e}else t.push(e)}n.stringify=function(e){var t=[];t.push({obj:e});for(var n,r,o,i,a,s,u,c,f,l,d,h=\"\";n=t.pop();)if(r=n.obj,o=n.prefix||\"\",i=n.val||\"\",h+=o,i)h+=i;else if(\"object\"!=typeof r)h+=\"undefined\"==typeof r?null:JSON.stringify(r);else if(null===r)h+=\"null\";else if(Array.isArray(r)){for(t.push({val:\"]\"}),a=r.length-1;a>=0;a--)s=0===a?\"\":\",\",t.push({obj:r[a],prefix:s});t.push({val:\"[\"})}else{u=[];for(c in r)r.hasOwnProperty(c)&&u.push(c);for(t.push({val:\"}\"}),a=u.length-1;a>=0;a--)f=u[a],l=r[f],d=a>0?\",\":\"\",d+=JSON.stringify(f)+\":\",t.push({obj:l,prefix:d});t.push({val:\"{\"})}return h},n.parse=function(e){for(var t,n,o,i,a,s,u,c,f,l=[],d=[],h=0;;)if(t=e[h++],\"}\"!==t&&\"]\"!==t&&\"undefined\"!=typeof t)switch(t){case\" \":case\"\t\":case\"\\n\":case\":\":case\",\":break;case\"n\":h+=3,r(null,l,d);break;case\"t\":h+=3,r(!0,l,d);break;case\"f\":h+=4,r(!1,l,d);break;case\"0\":case\"1\":case\"2\":case\"3\":case\"4\":case\"5\":case\"6\":case\"7\":case\"8\":case\"9\":case\"-\":for(n=\"\",h--;;){if(o=e[h++],!/[\\d\\.\\-e\\+]/.test(o)){h--;break}n+=o}r(parseFloat(n),l,d);break;case'\"':for(i=\"\",a=void 0,s=0;;){if(u=e[h++],'\"'===u&&(\"\\\\\"!==a||s%2!==1))break;i+=u,a=u,\"\\\\\"===a?s++:s=0}r(JSON.parse('\"'+i+'\"'),l,d);break;case\"[\":c={element:[],index:l.length},l.push(c.element),d.push(c);break;case\"{\":f={element:{},index:l.length},l.push(f.element),d.push(f);break;default:throw new Error(\"unexpectedly reached end of input: \"+t)}else{if(1===l.length)return l.pop();r(l.pop(),l,d)}}},{}],17:[function(e,t,n){(function(n,r){\"use strict\";function o(e){return e&&\"object\"==typeof e&&\"default\"in e?e[\"default\"]:e}function i(e,t){for(var n={},r=0,o=t.length;o>r;r++){var i=t[r];i in e&&(n[i]=e[i])}return n}function a(e){return e instanceof ArrayBuffer||\"undefined\"!=typeof Blob&&e instanceof Blob}function s(e){if(\"function\"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function u(e){if(e instanceof ArrayBuffer)return s(e);var t=e.size,n=e.type;return\"function\"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}function c(e){var t,n,r;if(!e||\"object\"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;r>n;n++)t[n]=c(e[n]);return t}if(e instanceof Date)return e.toISOString();if(a(e))return u(e);t={};for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=c(e[n]);\"undefined\"!=typeof o&&(t[n]=o)}return t}function f(e){var t=!1;return rr(function(n){if(t)throw new Error(\"once called more than once\");t=!0,e.apply(this,n)})}function l(e){return rr(function(t){t=c(t);var r,o=this,i=\"function\"==typeof t[t.length-1]?t.pop():!1;i&&(r=function(e,t){n.nextTick(function(){i(e,t)})});var a=new fr(function(n,r){var i;try{var a=f(function(e,t){e?r(e):n(t)});t.push(a),i=e.apply(o,t),i&&\"function\"==typeof i.then&&n(i)}catch(s){r(s)}});return r&&a.then(function(e){r(null,e)},r),a})}function d(e,t){function n(e,t,n){if(lr.enabled){for(var r=[e._db_name,t],o=0;o<n.length-1;o++)r.push(n[o]);lr.apply(null,r);var i=n[n.length-1];n[n.length-1]=function(n,r){var o=[e._db_name,t];o=o.concat(n?[\"error\",n]:[\"success\",r]),lr.apply(null,o),i(n,r)}}}return l(rr(function(r){if(this._closed)return fr.reject(new Error(\"database is closed\"));if(this._destroyed)return fr.reject(new Error(\"database is destroyed\"));var o=this;return n(o,e,r),this.taskqueue.isReady?t.apply(this,r):new fr(function(t,n){o.taskqueue.addTask(function(i){i?n(i):t(o[e].apply(o,r))})})}))}function h(e,t,n){return new fr(function(r,o){e.get(t,function(i,a){if(i){if(404!==i.status)return o(i);a={}}var s=a._rev,u=n(a);return u?(u._id=t,u._rev=s,void r(p(e,u,n))):r({updated:!1,rev:s})})})}function p(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(r){if(409!==r.status)throw r;return h(e,t._id,n)})}function v(e){for(var t,n,r,o,i=e.rev_tree.slice();o=i.pop();){var a=o.ids,s=a[2],u=o.pos;if(s.length)for(var c=0,f=s.length;f>c;c++)i.push({pos:u+1,ids:s[c]});else{var l=!!a[1].deleted,d=a[0];t&&!(r!==l?r:n!==u?u>n:d>t)||(t=d,n=u,r=l)}}return n+\"-\"+t}function y(e){return e.ids}function _(e,t){t||(t=v(e));for(var n,r=t.substring(t.indexOf(\"-\")+1),o=e.rev_tree.map(y);n=o.pop();){if(n[0]===r)return!!n[1].deleted;o=o.concat(n[2])}}function m(e){return ir(\"return \"+e+\";\",{})}function g(e){return new Function(\"doc\",[\"var emitted = false;\",\"var emit = function (a, b) {\",\"  emitted = true;\",\"};\",\"var view = \"+e+\";\",\"view(doc);\",\"if (emitted) {\",\"  return true;\",\"}\"].join(\"\\n\"))}function b(e){if(!e)return null;var t=e.split(\"/\");return 2===t.length?t:1===t.length?[e,e]:null}function w(e){var t=b(e);return t?t.join(\"/\"):null}function E(e,t){for(var n,r=e.slice();n=r.pop();)for(var o=n.pos,i=n.ids,a=i[2],s=t(0===a.length,o,i[0],n.ctx,i[1]),u=0,c=a.length;c>u;u++)r.push({pos:o+1,ids:a[u],ctx:s})}function S(e,t){return e.pos-t.pos}function k(e){var t=[];E(e,function(e,n,r,o,i){e&&t.push({rev:n+\"-\"+r,pos:n,opts:i})}),t.sort(S).reverse();for(var n=0,r=t.length;r>n;n++)delete t[n].pos;return t}function q(e){for(var t=v(e),n=k(e.rev_tree),r=[],o=0,i=n.length;i>o;o++){var a=n[o];a.rev===t||a.opts.deleted||r.push(a.rev)}return r}function x(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}function A(e,t,n){function r(t){for(var r in e)\"function\"!=typeof e[r]&&(this[r]=e[r]);void 0!==n&&(this.name=n),void 0!==t&&(this.reason=t)}return r.prototype=x.prototype,new r(t)}function T(e){var t,n,r,o,i;return n=e.error===!0&&\"string\"==typeof e.name?e.name:e.error,i=e.reason,\nr=Br(\"name\",n,i),e.missing||\"missing\"===i||\"deleted\"===i||\"not_found\"===n?r=pr:\"doc_validation\"===n?(r=kr,o=i):\"bad_request\"===n&&r.message!==i&&(r=qr),r||(r=Br(\"status\",e.status,i)||br),t=A(r,i,n),o&&(t.message=o),e.id&&(t.id=e.id),e.status&&(t.status=e.status),e.missing&&(t.missing=e.missing),t}function O(e,t,n){function r(){o.cancel()}or.EventEmitter.call(this);var o=this;this.db=e,t=t?c(t):{};var i=t.complete=f(function(t,n){t?o.emit(\"error\",t):o.emit(\"complete\",n),o.removeAllListeners(),e.removeListener(\"destroyed\",r)});n&&(o.on(\"complete\",function(e){n(null,e)}),o.on(\"error\",n)),e.once(\"destroyed\",r),t.onChange=function(e){t.isCancelled||(o.emit(\"change\",e),o.startSeq&&o.startSeq<=e.seq&&(o.startSeq=!1))};var a=new fr(function(e,n){t.complete=function(t,r){t?n(t):e(r)}});o.once(\"cancel\",function(){e.removeListener(\"destroyed\",r),t.complete(null,{status:\"cancelled\"})}),this.then=a.then.bind(a),this[\"catch\"]=a[\"catch\"].bind(a),this.then(function(e){i(null,e)},i),e.taskqueue.isReady?o.doChanges(t):e.taskqueue.addTask(function(){o.isCancelled?o.emit(\"cancel\"):o.doChanges(t)})}function j(e,t,n){var r=[{rev:e._rev}];\"all_docs\"===n.style&&(r=k(t.rev_tree).map(function(e){return{rev:e.rev}}));var o={id:t.id,changes:r,doc:e};return _(t,e._rev)&&(o.deleted=!0),n.conflicts&&(o.doc._conflicts=q(t),o.doc._conflicts.length||delete o.doc._conflicts),o}function C(e,t,n){function r(){var e=[];l.forEach(function(t){t.docs.forEach(function(n){e.push({id:t.id,docs:[n]})})}),n(null,{results:e})}function o(){++f===c&&r()}function a(e,t,n){l[e]={id:t,docs:n},o()}var s=Array.isArray(t)?t:t.docs,u={};s.forEach(function(e){e.id in u?u[e.id].push(e):u[e.id]=[e]});var c=Object.keys(u).length,f=0,l=new Array(c);Object.keys(u).forEach(function(n,r){var o=u[n],s=i(o[0],[\"atts_since\",\"attachments\"]);s.open_revs=o.map(function(e){return e.rev}),s.open_revs=s.open_revs.filter(function(e){return e});var c=function(e){return e};0===s.open_revs.length&&(delete s.open_revs,c=function(e){return[{ok:e}]}),[\"revs\",\"attachments\",\"binary\"].forEach(function(e){e in t&&(s[e]=t[e])}),e.get(n,s,function(e,t){a(r,n,e?[{error:e}]:c(t))})})}function I(e){return/^_local/.test(e)}function L(e){for(var t,n=[],r=e.slice();t=r.pop();){var o=t.pos,i=t.ids,a=i[0],s=i[1],u=i[2],c=0===u.length,f=t.history?t.history.slice():[];f.push({id:a,opts:s}),c&&n.push({pos:o+1-f.length,ids:f});for(var l=0,d=u.length;d>l;l++)r.push({pos:o+1,ids:u[l],history:f})}return n.reverse()}function R(e){return 0|Math.random()*e}function D(e,t){t=t||Fr.length;var n=\"\",r=-1;if(e){for(;++r<e;)n+=Fr[R(t)];return n}for(;++r<36;)switch(r){case 8:case 13:case 18:case 23:n+=\"-\";break;case 19:n+=Fr[3&R(16)|8];break;default:n+=Fr[R(16)]}return n}function N(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}function B(e){var t;if(e?\"string\"!=typeof e?t=A(yr):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=A(mr)):t=A(_r),t)throw t}function F(e){if(!/^\\d+\\-./.test(e))return A(Ir);var t=e.indexOf(\"-\"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function M(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,o=[r[0],t,[]],i=1,a=r.length;a>i;i++)o=[r[i],{status:\"missing\"},[o]];return[{pos:n,ids:o}]}function U(e,t){var n,r,o,i={status:\"available\"};if(e._deleted&&(i.deleted=!0),t)if(e._id||(e._id=D()),r=D(32,16).toLowerCase(),e._rev){if(o=F(e._rev),o.error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:\"missing\"},[[r,i,[]]]]}],n=o.prefix+1}else e._rev_tree=[{pos:1,ids:[r,i,[]]}],n=1;else if(e._revisions&&(e._rev_tree=M(e._revisions,i),n=e._revisions.start,r=e._revisions.ids[0]),!e._rev_tree){if(o=F(e._rev),o.error)return o;n=o.prefix,r=o.id,e._rev_tree=[{pos:n,ids:[r,i,[]]}]}B(e._id),e._rev=n+\"-\"+r;var a={metadata:{},data:{}};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var u=\"_\"===s[0];if(u&&!Mr[s]){var c=A(kr,s);throw c.message=kr.message+\": \"+s,c}u&&!Ur[s]?a.metadata[s.slice(1)]=e[s]:a.data[s]=e[s]}return a}function P(e,t){return t>e?-1:e>t?1:0}function H(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n)===!0)return e[n]}function K(e){return function(t,n){t||n[0]&&n[0].error?e(t||n[0]):e(null,n.length?n[0]:n)}}function W(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),o=0;o<r.length;o++){var a=r[o];n._attachments[a]=i(n._attachments[a],[\"data\",\"digest\",\"content_type\",\"length\",\"revpos\",\"stub\"])}}}function J(e,t){var n=P(e._id,t._id);if(0!==n)return n;var r=e._revisions?e._revisions.start:0,o=t._revisions?t._revisions.start:0;return P(r,o)}function V(e){var t={},n=[];return E(e,function(e,r,o,i){var a=r+\"-\"+o;return e&&(t[a]=0),void 0!==i&&n.push({from:i,to:a}),a}),n.reverse(),n.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function G(e,t,n){var r=\"limit\"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&r.reverse(),!r.length)return e._allDocs({limit:0},n);var o={offset:t.skip};return fr.all(r.map(function(n){var r=$n.extend({key:n,deleted:\"ok\"},t);return[\"limit\",\"skip\",\"keys\"].forEach(function(e){delete r[e]}),new fr(function(t,i){e._allDocs(r,function(e,r){return e?i(e):(o.total_rows=r.total_rows,void t(r.rows[0]||{key:n,error:\"not_found\"}))})})})).then(function(e){return o.rows=e,o})}function X(e){var t=e._compactionQueue[0],r=t.opts,o=t.callback;e.get(\"_local/compaction\")[\"catch\"](function(){return!1}).then(function(t){t&&t.last_seq&&(r.last_seq=t.last_seq),e._compact(r,function(t,r){t?o(t):o(null,r),n.nextTick(function(){e._compactionQueue.shift(),e._compactionQueue.length&&X(e)})})})}function z(e){return\"_\"===e.charAt(0)?e+\"is not a valid attachment name, attachment names cannot start with '_'\":!1}function Q(e,t,n,r){t.seq=t.seq||0;var o={doc_ids:[\"_design/\"+n],limit:1,since:t.seq};e.changes(o).then(function(e){var n=e.results&&e.results.length&&e.results[0].seq;n&&n>t.seq&&(t.seq=n,delete t.promise),r()})[\"catch\"](r)}function $(e,t,n){e._ddocCache=e._ddocCache||{},e._ddocCache[t]=e._ddocCache[t]||{};var r=e._ddocCache[t];Q(e,r,t,function(o){return o?n(o):(r.promise||(r.promise=new fr(function(n,r){e._get(\"_design/\"+t,{},function(e,t){if(e)return r(e);var o={};[\"views\",\"filters\"].forEach(function(e){o[e]=t.doc[e]}),n(o)})})),void r.promise.then(function(e){n(null,e)})[\"catch\"](n))})}function Y(e,t,n,r,o){$(e,t,function(e,t){if(e)return o(e);var i=t[n]&&t[n][r];return i?void o(null,i):o(A(pr))})}function Z(){or.EventEmitter.call(this)}function ee(){this.isReady=!1,this.failed=!1,this.queue=[]}function te(e){e&&r.debug&&console.error(e)}function ne(e,t){function n(){i.emit(\"destroyed\",o)}function r(){e.removeListener(\"destroyed\",n),e.emit(\"destroyed\",e)}var o=t.originalName,i=e.constructor,a=i._destructionListeners;e.once(\"destroyed\",n),a.has(o)||a.set(o,[]),a.get(o).push(r)}function re(e,t,n){if(!(this instanceof re))return new re(e,t,n);var r=this;\"function\"!=typeof t&&\"undefined\"!=typeof t||(n=t,t={}),e&&\"object\"==typeof e&&(t=e,e=void 0),\"undefined\"==typeof n&&(n=te),e=e||t.name,t=c(t),delete t.name,this.__opts=t;var o=n;r.auto_compaction=t.auto_compaction,r.prefix=re.prefix,Z.call(r),r.taskqueue=new ee;var i=new fr(function(o,i){n=function(e,t){return e?i(e):(delete t.then,void o(t))},t=c(t);var a,s,u=t.name||e;return function(){try{if(\"string\"!=typeof u)throw s=new Error(\"Missing/invalid DB name\"),s.code=400,s;if(a=re.parseAdapter(u,t),t.originalName=u,t.name=a.name,t.prefix&&\"http\"!==a.adapter&&\"https\"!==a.adapter&&(t.name=t.prefix+t.name),t.adapter=t.adapter||a.adapter,r._adapter=t.adapter,Zn(\"pouchdb:adapter\")(\"Picked adapter: \"+t.adapter),r._db_name=u,!re.adapters[t.adapter])throw s=new Error(\"Adapter is missing\"),s.code=404,s;if(!re.adapters[t.adapter].valid())throw s=new Error(\"Invalid Adapter\"),s.code=404,s}catch(e){r.taskqueue.fail(e)}}(),s?i(s):(r.adapter=t.adapter,r.replicate={},r.replicate.from=function(e,t,n){return r.constructor.replicate(e,r,t,n)},r.replicate.to=function(e,t,n){return r.constructor.replicate(r,e,t,n)},r.sync=function(e,t,n){return r.constructor.sync(r,e,t,n)},r.replicate.sync=r.sync,void re.adapters[t.adapter].call(r,t,function(e){return e?(r.taskqueue.fail(e),void n(e)):(ne(r,t),r.emit(\"created\",r),re.emit(\"created\",t.originalName),r.taskqueue.ready(r),void n(null,r))}))});i.then(function(e){o(null,e)},o),r.then=i.then.bind(i),r[\"catch\"]=i[\"catch\"].bind(i)}function oe(){return\"undefined\"!=typeof chrome&&\"undefined\"!=typeof chrome.storage&&\"undefined\"!=typeof chrome.storage.local}function ie(){return Pr}function ae(e){Object.keys(or.EventEmitter.prototype).forEach(function(t){\"function\"==typeof or.EventEmitter.prototype[t]&&(e[t]=Kr[t].bind(Kr))});var t=e._destructionListeners=new nr.Map;e.on(\"destroyed\",function(e){t.has(e)&&(t.get(e).forEach(function(e){e()}),t[\"delete\"](e))})}function se(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(n){if(\"TypeError\"!==n.name)throw n;for(var r=\"undefined\"!=typeof BlobBuilder?BlobBuilder:\"undefined\"!=typeof MSBlobBuilder?MSBlobBuilder:\"undefined\"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,o=new r,i=0;i<e.length;i+=1)o.append(e[i]);return o.getBlob(t.type)}}function ue(e,t){if(\"undefined\"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}function ce(){for(var e={},t=new fr(function(t,n){e.resolve=t,e.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.promise=t,fr.resolve().then(function(){return fetch.apply(null,n)}).then(function(t){e.resolve(t)})[\"catch\"](function(t){e.reject(t)}),e}function fe(e,t){var n,r,o,i=new Headers,a={method:e.method,credentials:\"include\",headers:i};return e.json&&(i.set(\"Accept\",\"application/json\"),i.set(\"Content-Type\",e.headers[\"Content-Type\"]||\"application/json\")),e.body&&e.body instanceof Blob?ue(e.body,function(e){a.body=e}):e.body&&e.processData&&\"string\"!=typeof e.body?a.body=JSON.stringify(e.body):\"body\"in e?a.body=e.body:a.body=null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&i.set(t,e.headers[t])}),n=ce(e.url,a),e.timeout>0&&(r=setTimeout(function(){n.reject(new Error(\"Load timeout for resource: \"+e.url))},e.timeout)),n.promise.then(function(t){return o={statusCode:t.status},e.timeout>0&&clearTimeout(r),o.statusCode>=200&&o.statusCode<300?e.binary?t.blob():t.text():t.json()}).then(function(e){o.statusCode>=200&&o.statusCode<300?t(null,o,e):t(e,o)})[\"catch\"](function(e){t(e,o)}),{abort:n.reject}}function le(e,t){var n,r,o=function(){n.abort()};n=e.xhr?new e.xhr:new XMLHttpRequest;try{n.open(e.method,e.url)}catch(i){t(i,{statusCode:413})}n.withCredentials=\"withCredentials\"in e?e.withCredentials:!0,\"GET\"===e.method?delete e.headers[\"Content-Type\"]:e.json&&(e.headers.Accept=\"application/json\",e.headers[\"Content-Type\"]=e.headers[\"Content-Type\"]||\"application/json\",e.body&&e.processData&&\"string\"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(n.responseType=\"arraybuffer\"),\"body\"in e||(e.body=null);for(var a in e.headers)e.headers.hasOwnProperty(a)&&n.setRequestHeader(a,e.headers[a]);return e.timeout>0&&(r=setTimeout(o,e.timeout),n.onprogress=function(){clearTimeout(r),r=setTimeout(o,e.timeout)},\"undefined\"!=typeof n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var r={statusCode:n.status};if(n.status>=200&&n.status<300){var o;o=e.binary?se([n.response||\"\"],{type:n.getResponseHeader(\"Content-Type\")}):n.responseText,t(null,r,o)}else{var i={};try{i=JSON.parse(n.response)}catch(a){}t(i,r)}}},e.body&&e.body instanceof Blob?ue(e.body,function(e){n.send(e)}):n.send(e.body),{abort:o}}function de(){try{return new XMLHttpRequest,!0}catch(e){return!1}}function he(e,t){return Wr||e.xhr?le(e,t):fe(e,t)}function pe(){return\"\"}function ve(e,t){function n(t,n,r){if(!e.binary&&e.json&&\"string\"==typeof t)try{t=JSON.parse(t)}catch(o){return r(o)}Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?T(e):e})),e.binary&&Jr(t,n),r(null,t,n)}function r(e,t){var n,r;if(e.code&&e.status){var o=new Error(e.message||e.code);return o.status=e.status,t(o)}try{n=JSON.parse(e.responseText),r=T(n)}catch(i){r=T(e)}t(r)}e=c(e);var o={method:\"GET\",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};return e=$n.extend(o,e),e.json&&(e.binary||(e.headers.Accept=\"application/json\"),e.headers[\"Content-Type\"]=e.headers[\"Content-Type\"]||\"application/json\"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),he(e,function(o,i,a){if(o)return o.status=i?i.statusCode:400,r(o,t);var s,u=i.headers&&i.headers[\"content-type\"],c=a||pe();if(!e.binary&&(e.json||!e.processData)&&\"object\"!=typeof c&&(/json/.test(u)||/^[\\s]*\\{/.test(c)&&/\\}[\\s]*$/.test(c)))try{c=JSON.parse(c.toString())}catch(f){}i.statusCode>=200&&i.statusCode<300?n(c,i,t):(s=T(c),s.status=i.statusCode,t(s))})}function ye(e,t){var n=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():\"\",r=-1!==n.indexOf(\"safari\")&&-1===n.indexOf(\"chrome\"),o=-1!==n.indexOf(\"msie\"),i=-1!==n.indexOf(\"edge\"),a=r&&\"POST\"===e.method||(o||i)&&\"GET\"===e.method,s=\"cache\"in e?e.cache:!0;if(a||!s){var u=-1!==e.url.indexOf(\"?\");e.url+=(u?\"&\":\"?\")+\"_nonce=\"+Date.now()}return ve(e,t)}function _e(e){for(var t=zr.exec(e),n={},r=14;r--;){var o=Vr[r],i=t[r]||\"\",a=-1!==[\"user\",\"password\"].indexOf(o);n[o]=a?decodeURIComponent(i):i}return n[Gr]={},n[Vr[12]].replace(Xr,function(e,t,r){t&&(n[Gr][t]=r)}),n}function me(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;t>o;o++)r[o]=e.charCodeAt(o);return n}function ge(e,t){return se([me(e)],{type:t})}function be(e,t,n){try{return!e(t,n)}catch(r){var o=\"Filter function threw: \"+r.toString();return A(qr,o)}}function we(e){var t={},n=e.filter&&\"function\"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var o=n&&be(e.filter,r.doc,t);if(\"object\"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}}function Ee(e,t){\"console\"in r&&\"info\"in console&&console.info(\"The above \"+e+\" is totally normal. \"+t)}function Se(e,t,n,r,o){return e.get(t)[\"catch\"](function(n){if(404===n.status)return\"http\"===e.type()&&Ee(404,\"PouchDB is just checking if a remote checkpoint exists.\"),{session_id:r,_id:t,history:[],replicator:no,version:to};throw n}).then(function(i){return o.cancelled?void 0:(i.history=(i.history||[]).filter(function(e){return e.session_id!==r}),i.history.unshift({last_seq:n,session_id:r}),i.history=i.history.slice(0,ro),i.version=to,i.replicator=no,i.session_id=r,i.last_seq=n,e.put(i)[\"catch\"](function(i){if(409===i.status)return Se(e,t,n,r,o);throw i}))})}function ke(e,t,n,r){this.src=e,this.target=t,this.id=n,this.returnValue=r}function qe(e,t){if(e.session_id===t.session_id)return{last_seq:e.last_seq,history:e.history||[]};var n=e.history||[],r=t.history||[];return xe(n,r)}function xe(e,t){var n=e[0],r=e.slice(1),o=t[0],i=t.slice(1);if(!n||0===t.length)return{last_seq:oo,history:[]};var a=n.session_id;if(Ae(a,t))return{last_seq:n.last_seq,history:e};var s=o.session_id;return Ae(s,r)?{last_seq:o.last_seq,history:i}:xe(r,i)}function Ae(e,t){var n=t[0],r=t.slice(1);return e&&0!==t.length?e===n.session_id?!0:Ae(e,r):!1}function Te(e){return\"number\"==typeof e.status&&4===Math.floor(e.status/100)}function Oe(e,t){e=parseInt(e,10)||0,t=parseInt(t,10),t!==t||e>=t?t=(e||1)<<1:t+=1;var n=Math.random(),r=t-e;return~~(r*n+e)}function je(e){var t=0;return e||(t=2e3),Oe(e,t)}function Ce(e,t,n,r){return e.retry===!1?(t.emit(\"error\",n),void t.removeAllListeners()):(\"function\"!=typeof e.back_off_function&&(e.back_off_function=je),t.emit(\"requestError\",n),\"active\"!==t.state&&\"pending\"!==t.state||(t.emit(\"paused\",n),t.state=\"stopped\",t.once(\"active\",function(){e.current_back_off=ao})),e.current_back_off=e.current_back_off||ao,e.current_back_off=e.back_off_function(e.current_back_off),void setTimeout(r,e.current_back_off))}function Ie(e){return $r(e)}function Le(e,t,n,r){(n>0||r<t.byteLength)&&(t=new Uint8Array(t,n,Math.min(r,t.byteLength)-n)),e.append(t)}function Re(e,t,n,r){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t)}function De(e){return Object.keys(e).sort(ar.collate).reduce(function(t,n){return t[n]=e[n],t},{})}function Ne(e,t,n){var r=n.doc_ids?n.doc_ids.sort(ar.collate):\"\",o=n.filter?n.filter.toString():\"\",i=\"\",a=\"\";return n.filter&&n.query_params&&(i=JSON.stringify(De(n.query_params))),n.filter&&\"_view\"===n.filter&&(a=n.view.toString()),fr.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+o+a+i+r;return co(t)}).then(function(e){return e=e.replace(/\\//g,\".\").replace(/\\+/g,\"_\"),\"_local/\"+e})}function Be(e){return/^1-/.test(e)}function Fe(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n].missing;r.forEach(function(e){t.push({id:n,rev:e})})}),{docs:t,revs:!0,attachments:!0,binary:!0}}function Me(e,t,n){function r(){var r=Fe(t);if(r.docs.length)return e.bulkGet(r).then(function(e){if(n.cancelled)throw new Error(\"cancelled\");e.results.forEach(function(e){e.docs.forEach(function(e){e.ok&&u.push(e.ok)})})})}function o(e){return e._attachments&&Object.keys(e._attachments).length>0}function i(r){return e.allDocs({keys:r,include_docs:!0}).then(function(e){if(n.cancelled)throw new Error(\"cancelled\");e.rows.forEach(function(e){!e.deleted&&e.doc&&Be(e.value.rev)&&!o(e.doc)&&(u.push(e.doc),delete t[e.id])})})}function a(){var e=Object.keys(t).filter(function(e){var n=t[e].missing;return 1===n.length&&Be(n[0])});return e.length>0?i(e):void 0}function s(){return u}t=c(t);var u=[];return fr.resolve().then(a).then(r).then(s)}function Ue(e,t,n,r,o){function i(){return S?fr.resolve():Ne(e,t,n).then(function(n){E=n,S=new ke(e,t,E,r)})}function a(){if(B=[],0!==w.docs.length){var e=w.docs;return t.bulkDocs({docs:e,new_edits:!1}).then(function(t){if(r.cancelled)throw p(),new Error(\"cancelled\");var n=[],i={};t.forEach(function(e){e.error&&(o.doc_write_failures++,n.push(e),i[e.id]=e)}),N=N.concat(n),o.docs_written+=w.docs.length-n.length;var a=n.filter(function(e){return\"unauthorized\"!==e.name&&\"forbidden\"!==e.name});if(e.forEach(function(e){var t=i[e._id];t?r.emit(\"denied\",c(t)):B.push(e)}),a.length>0){var s=new Error(\"bulkDocs error\");throw s.other_errors=n,h(\"target.bulkDocs failed to write docs\",s),new Error(\"bulkWrite partial failure\")}},function(t){throw o.doc_write_failures+=e.length,t})}}function s(){o.last_seq=O=w.seq;var e=c(o);return B.length&&(e.docs=B,r.emit(\"change\",e)),x=!0,S.writeCheckpoint(w.seq,F).then(function(){if(x=!1,r.cancelled)throw p(),new Error(\"cancelled\");w=void 0,m()})[\"catch\"](function(e){throw x=!1,h(\"writeCheckpoint completed with error\",e),e})}function u(){var e={};return w.changes.forEach(function(t){\"_user/\"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(r.cancelled)throw p(),new Error(\"cancelled\");w.diffs=e})}function f(){return Me(e,w.diffs,r).then(function(e){e.forEach(function(e){delete w.diffs[e._id],o.docs_read++,w.docs.push(e)})})}function l(){if(!r.cancelled&&!w){if(0===k.length)return void d(!0);w=k.shift(),u().then(f).then(a).then(s).then(l)[\"catch\"](function(e){h(\"batch processing terminated with error\",e)})}}function d(e){return 0===q.changes.length?void(0!==k.length||w||((j&&M.live||A)&&(r.state=\"pending\",r.emit(\"paused\")),A&&p())):void((e||A||q.changes.length>=C)&&(k.push(q),q={seq:0,changes:[],docs:[]},\"pending\"!==r.state&&\"stopped\"!==r.state||(r.state=\"active\",r.emit(\"active\")),l()))}function h(e,t){T||(t.message||(t.message=e),o.ok=!1,o.status=\"aborting\",o.errors.push(t),N=N.concat(t),k=[],q={seq:0,changes:[],docs:[]},p())}function p(){if(!(T||r.cancelled&&(o.status=\"cancelled\",x))){o.status=o.status||\"complete\",o.end_time=new Date,o.last_seq=O,T=!0;var i=N.filter(function(e){return\"unauthorized\"!==e.name&&\"forbidden\"!==e.name});if(i.length>0){var a=N.pop();N.length>0&&(a.other_errors=N),a.result=o,Ce(n,r,a,function(){Ue(e,t,n,r)})}else o.errors=N,r.emit(\"complete\",o),r.removeAllListeners()}}function v(e){if(r.cancelled)return p();var t=we(n)(e);t&&(q.seq=e.seq,q.changes.push(e),d(M.live))}function y(e){return L=!1,r.cancelled?p():(e.results.length>0?(M.since=e.last_seq,m()):j?(M.live=!0,m()):A=!0,void d(!0))}function _(e){return L=!1,r.cancelled?p():void h(\"changes rejected\",e)}function m(){function t(){i.cancel()}function o(){r.removeListener(\"cancel\",t)}if(!L&&!A&&k.length<I){L=!0,r._changes&&(r.removeListener(\"cancel\",r._abortChanges),r._changes.cancel()),r.once(\"cancel\",t);var i=e.changes(M).on(\"change\",v);i.then(o,o),i.then(y)[\"catch\"](_),n.retry&&(r._changes=i,r._abortChanges=t)}}function g(){i().then(function(){return r.cancelled?void p():S.getCheckpoint().then(function(e){O=e,M={since:O,limit:C,batch_size:C,style:\"all_docs\",doc_ids:R,return_docs:!0},n.filter&&(\"string\"!=typeof n.filter?M.include_docs=!0:M.filter=n.filter),\"heartbeat\"in n&&(M.heartbeat=n.heartbeat),\"timeout\"in n&&(M.timeout=n.timeout),n.query_params&&(M.query_params=n.query_params),n.view&&(M.view=n.view),m()})})[\"catch\"](function(e){h(\"getCheckpoint rejected with \",e)})}function b(e){throw x=!1,h(\"writeCheckpoint completed with error\",e),e}var w,E,S,k=[],q={seq:0,changes:[],docs:[]},x=!1,A=!1,T=!1,O=0,j=n.continuous||n.live||!1,C=n.batch_size||100,I=n.batches_limit||10,L=!1,R=n.doc_ids,N=[],B=[],F=D();o=o||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var M={};return r.ready(e,t),r.cancelled?void p():(r._addedListeners||(r.once(\"cancel\",p),\"function\"==typeof n.complete&&(r.once(\"error\",n.complete),r.once(\"complete\",function(e){n.complete(null,e)})),r._addedListeners=!0),void(\"undefined\"==typeof n.since?g():i().then(function(){return x=!0,S.writeCheckpoint(n.since,F)}).then(function(){return x=!1,r.cancelled?void p():(O=n.since,void g())})[\"catch\"](b)))}function Pe(){or.EventEmitter.call(this),this.cancelled=!1,this.state=\"pending\";var e=this,t=new fr(function(t,n){e.once(\"complete\",t),e.once(\"error\",n)});e.then=function(e,n){return t.then(e,n)},e[\"catch\"]=function(e){return t[\"catch\"](e)},e[\"catch\"](function(){})}function He(e,t){var n=t.PouchConstructor;return\"string\"==typeof e?new n(e,t):e}function Ke(e,t,n,r){if(\"function\"==typeof n&&(r=n,n={}),\"undefined\"==typeof n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw A(qr,\"`doc_ids` filter parameter is not a list.\");n.complete=r,n=c(n),n.continuous=n.continuous||n.live,n.retry=\"retry\"in n?n.retry:!1,n.PouchConstructor=n.PouchConstructor||this;var o=new Pe(n),i=He(e,n),a=He(t,n);return Ue(i,a,n,o),o}function We(e,t,n,r){return\"function\"==typeof n&&(r=n,n={}),\"undefined\"==typeof n&&(n={}),n=c(n),n.PouchConstructor=n.PouchConstructor||this,e=fo.toPouch(e,n),t=fo.toPouch(t,n),new Je(e,t,n,r)}function Je(e,t,n,r){function o(e){h.emit(\"change\",{direction:\"pull\",change:e})}function i(e){h.emit(\"change\",{direction:\"push\",change:e})}function a(e){h.emit(\"denied\",{direction:\"push\",doc:e})}function s(e){h.emit(\"denied\",{direction:\"pull\",doc:e})}function u(){h.pushPaused=!0,h.pullPaused&&h.emit(\"paused\")}function c(){h.pullPaused=!0,h.pushPaused&&h.emit(\"paused\")}function f(){h.pushPaused=!1,h.pullPaused&&h.emit(\"active\",{direction:\"push\"})}function l(){h.pullPaused=!1,h.pushPaused&&h.emit(\"active\",{direction:\"pull\"})}function d(e){return function(t,n){var r=\"change\"===t&&(n===o||n===i),d=\"denied\"===t&&(n===s||n===a),p=\"paused\"===t&&(n===c||n===u),v=\"active\"===t&&(n===l||n===f);(r||d||p||v)&&(t in y||(y[t]={}),y[t][e]=!0,2===Object.keys(y[t]).length&&h.removeAllListeners(t))}}var h=this;this.canceled=!1;var p=n.push?$n.extend({},n,n.push):n,v=n.pull?$n.extend({},n,n.pull):n;this.push=lo(e,t,p),this.pull=lo(t,e,v),this.pushPaused=!0,this.pullPaused=!0;var y={};n.live&&(this.push.on(\"complete\",h.pull.cancel.bind(h.pull)),this.pull.on(\"complete\",h.push.cancel.bind(h.push))),this.on(\"newListener\",function(e){\"change\"===e?(h.pull.on(\"change\",o),h.push.on(\"change\",i)):\"denied\"===e?(h.pull.on(\"denied\",s),h.push.on(\"denied\",a)):\"active\"===e?(h.pull.on(\"active\",l),h.push.on(\"active\",f)):\"paused\"===e&&(h.pull.on(\"paused\",c),h.push.on(\"paused\",u))}),this.on(\"removeListener\",function(e){\"change\"===e?(h.pull.removeListener(\"change\",o),h.push.removeListener(\"change\",i)):\"denied\"===e?(h.pull.removeListener(\"denied\",s),h.push.removeListener(\"denied\",a)):\"active\"===e?(h.pull.removeListener(\"active\",l),h.push.removeListener(\"active\",f)):\"paused\"===e&&(h.pull.removeListener(\"paused\",c),h.push.removeListener(\"paused\",u))}),this.pull.on(\"removeListener\",d(\"pull\")),this.push.on(\"removeListener\",d(\"push\"));var _=fr.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return h.emit(\"complete\",t),r&&r(null,t),h.removeAllListeners(),t},function(e){if(h.cancel(),r?r(e):h.emit(\"error\",e),h.removeAllListeners(),r)throw e});this.then=function(e,t){return _.then(e,t)},this[\"catch\"]=function(e){return _[\"catch\"](e)}}function Ve(e,t){return ge(Qr(e),t)}function Ge(e){for(var t=\"\",n=new Uint8Array(e),r=n.byteLength,o=0;r>o;o++)t+=String.fromCharCode(n[o]);return t}function Xe(e,t){if(\"undefined\"==typeof FileReader)return t(Ge((new FileReaderSync).readAsArrayBuffer(e)));var n=new FileReader,r=\"function\"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||\"\";return r?t(n):void t(Ge(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function ze(e){return new fr(function(t){Xe(e,function(e){t($r(e))})})}function Qe(e){for(var t=[],n=0,r=e.length;r>n;n++)t=t.concat(e[n]);return t}function $e(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];n.data=Ve(n.data,n.content_type)})}function Ye(e){return/^_design/.test(e)?\"_design/\"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?\"_local/\"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function Ze(e){return e._attachments&&Object.keys(e._attachments)?fr.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];return n.data&&\"string\"!=typeof n.data?ze(n.data).then(function(e){n.data=e}):void 0})):fr.resolve()}function et(e){var t=_e(e);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var n=t.path.replace(/(^\\/|\\/$)/g,\"\").split(\"/\");return t.db=n.pop(),-1===t.db.indexOf(\"%\")&&(t.db=encodeURIComponent(t.db)),t.path=n.join(\"/\"),t}function tt(e,t){return nt(e,e.db+\"/\"+t)}function nt(e,t){var n=e.path?\"/\":\"\";return e.protocol+\"://\"+e.host+(e.port?\":\"+e.port:\"\")+\"/\"+e.path+n+t}function rt(e){return\"?\"+Object.keys(e).map(function(t){return t+\"=\"+encodeURIComponent(e[t])}).join(\"&\")}function ot(e,t){function n(e,t,n){var r=e.ajax||{},o=$n.extend(c(p),r,t);return _o(o.method+\" \"+o.url),Zr.ajax(o,n)}function r(e,t){return new fr(function(r,o){n(e,t,function(e,t){return e?o(e):void r(t)})})}function o(e,t){return d(e,rr(function(e){a().then(function(){return t.apply(this,e)})[\"catch\"](function(t){var n=e.pop();n(t)})}))}function a(){if(e.skipSetup||e.skip_setup)return fr.resolve();if(m)return m;var t={method:\"GET\",url:h};return m=r({},t)[\"catch\"](function(e){return e&&e.status&&404===e.status?(Ee(404,\"PouchDB is just detecting if the remote exists.\"),r({},{method:\"PUT\",url:h})):fr.reject(e)})[\"catch\"](function(e){return e&&e.status&&412===e.status?!0:fr.reject(e)}),m[\"catch\"](function(){m=null}),m}function s(e){return e.split(\"/\").map(encodeURIComponent).join(\"/\")}var u=this,f=et;e.getHost&&(f=e.getHost);var l=f(e.name,e),h=tt(l,\"\");e=c(e);var p=e.ajax||{};if(u.getUrl=function(){return h},u.getHeaders=function(){return p.headers||{}},e.auth||l.auth){var v=e.auth||l.auth,y=v.username+\":\"+v.password,_=$r(unescape(encodeURIComponent(y)));p.headers=p.headers||{},p.headers.Authorization=\"Basic \"+_}var m;setTimeout(function(){t(null,u)}),u.type=function(){return\"http\"},u.id=o(\"id\",function(e){n({},{method:\"GET\",url:nt(l,\"\")},function(t,n){var r=n&&n.uuid?n.uuid+l.db:tt(l,\"\");e(null,r)})}),u.request=o(\"request\",function(e,t){e.url=tt(l,e.url),n({},e,t)}),u.compact=o(\"compact\",function(e,t){\"function\"==typeof e&&(t=e,e={}),e=c(e),n(e,{url:tt(l,\"_compact\"),method:\"POST\"},function(){function n(){u.info(function(r,o){o&&!o.compact_running?t(null,{ok:!0}):setTimeout(n,e.interval||200)})}n()})}),u.bulkGet=d(\"bulkGet\",function(e,t){function r(t){var r={};e.revs&&(r.revs=!0),e.attachments&&(r.attachments=!0),n({},{url:tt(l,\"_bulk_get\"+rt(r)),method:\"POST\",body:{docs:e.docs}},t)}function o(){function n(e){return function(n,r){u[e]=r.results,++s===o&&t(null,{results:Qe(u)})}}for(var r=po,o=Math.ceil(e.docs.length/r),s=0,u=new Array(o),c=0;o>c;c++){var f=i(e,[\"revs\",\"attachments\"]);f.docs=e.docs.slice(c*r,Math.min(e.docs.length,(c+1)*r)),C(a,f,n(c))}}var a=this,s=nt(l,\"\"),u=vo[s];\"boolean\"!=typeof u?r(function(e,n){if(e){var r=Math.floor(e.status/100);4===r||5===r?(vo[s]=!1,Ee(e.status,\"PouchDB is just detecting if the remote supports the _bulk_get API.\"),o()):t(e)}else vo[s]=!0,t(null,n)}):u?r(t):o()}),u._info=function(e){a().then(function(){n({},{method:\"GET\",url:tt(l,\"\")},function(t,n){return t?e(t):(n.host=tt(l,\"\"),void e(null,n))})})[\"catch\"](e)},u.get=o(\"get\",function(e,t,n){function o(e){var n=e._attachments,o=n&&Object.keys(n);return n&&o.length?fr.all(o.map(function(o){var i=n[o],a=Ye(e._id)+\"/\"+s(o)+\"?rev=\"+e._rev;return r(t,{method:\"GET\",url:tt(l,a),binary:!0}).then(function(e){return t.binary?e:ze(e)}).then(function(e){delete i.stub,delete i.length,i.data=e})})):void 0}function i(e){return Array.isArray(e)?fr.all(e.map(function(e){return e.ok?o(e.ok):void 0})):o(e)}\"function\"==typeof t&&(n=t,t={}),t=c(t);var a={};t.revs&&(a.revs=!0),t.revs_info&&(a.revs_info=!0),t.open_revs&&(\"all\"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),a.open_revs=t.open_revs),t.rev&&(a.rev=t.rev),t.conflicts&&(a.conflicts=t.conflicts),e=Ye(e);var u={method:\"GET\",url:tt(l,e+rt(a))};r(t,u).then(function(e){return fr.resolve().then(function(){return t.attachments?i(e):void 0}).then(function(){n(null,e)})})[\"catch\"](n)}),u.remove=o(\"remove\",function(e,t,r,o){var i;\"string\"==typeof t?(i={_id:e,_rev:t},\"function\"==typeof r&&(o=r,r={})):(i=e,\"function\"==typeof t?(o=t,r={}):(o=r,r=t));var a=i._rev||r.rev;n(r,{method:\"DELETE\",url:tt(l,Ye(i._id))+\"?rev=\"+a},o)}),u.getAttachment=o(\"getAttachment\",function(e,t,r,o){\"function\"==typeof r&&(o=r,r={});var i=r.rev?\"?rev=\"+r.rev:\"\",a=tt(l,Ye(e))+\"/\"+s(t)+i;n(r,{method:\"GET\",url:a,binary:!0},o)}),u.removeAttachment=o(\"removeAttachment\",function(e,t,r,o){var i=tt(l,Ye(e)+\"/\"+s(t))+\"?rev=\"+r;n({},{method:\"DELETE\",url:i},o)}),u.putAttachment=o(\"putAttachment\",function(e,t,r,o,i,a){\"function\"==typeof i&&(a=i,i=o,o=r,r=null);var u=Ye(e)+\"/\"+s(t),c=tt(l,u);if(r&&(c+=\"?rev=\"+r),\"string\"==typeof o){var f;try{f=Qr(o)}catch(d){return a(A(wr,\"Attachment is not a valid base64 string\"))}o=f?ge(f,i):\"\"}var h={headers:{\"Content-Type\":i},method:\"PUT\",url:c,processData:!1,body:o,timeout:p.timeout||6e4};n({},h,a)}),u._bulkDocs=function(e,t,r){e.new_edits=t.new_edits,a().then(function(){return fr.all(e.docs.map(Ze))}).then(function(){n(t,{method:\"POST\",url:tt(l,\"_bulk_docs\"),body:e},function(e,t){return e?r(e):(t.forEach(function(e){e.ok=!0}),void r(null,t))})})[\"catch\"](r)},u.allDocs=o(\"allDocs\",function(e,t){\"function\"==typeof e&&(t=e,e={}),e=c(e);var n,o={},i=\"GET\";e.conflicts&&(o.conflicts=!0),e.descending&&(o.descending=!0),e.include_docs&&(o.include_docs=!0),e.attachments&&(o.attachments=!0),e.key&&(o.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(o.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(o.endkey=JSON.stringify(e.endkey)),\"undefined\"!=typeof e.inclusive_end&&(o.inclusive_end=!!e.inclusive_end),\"undefined\"!=typeof e.limit&&(o.limit=e.limit),\"undefined\"!=typeof e.skip&&(o.skip=e.skip);var a=rt(o);if(\"undefined\"!=typeof e.keys){var s=\"keys=\"+encodeURIComponent(JSON.stringify(e.keys));s.length+a.length+1<=yo?a+=\"&\"+s:(i=\"POST\",n={keys:e.keys})}r(e,{method:i,url:tt(l,\"_all_docs\"+a),body:n\n}).then(function(n){e.include_docs&&e.attachments&&e.binary&&n.rows.forEach($e),t(null,n)})[\"catch\"](t)}),u._changes=function(e){var t=\"batch_size\"in e?e.batch_size:ho;e=c(e),e.timeout=\"timeout\"in e?e.timeout:\"timeout\"in p?p.timeout:3e4;var r,o=e.timeout?{timeout:e.timeout-5e3}:{},i=\"undefined\"!=typeof e.limit?e.limit:!1;r=\"return_docs\"in e?e.return_docs:\"returnDocs\"in e?e.returnDocs:!0;var s=i;if(e.style&&(o.style=e.style),(e.include_docs||e.filter&&\"function\"==typeof e.filter)&&(o.include_docs=!0),e.attachments&&(o.attachments=!0),e.continuous&&(o.feed=\"longpoll\"),e.conflicts&&(o.conflicts=!0),e.descending&&(o.descending=!0),\"heartbeat\"in e?e.heartbeat&&(o.heartbeat=e.heartbeat):o.heartbeat=1e4,e.filter&&\"string\"==typeof e.filter&&(o.filter=e.filter,\"_view\"===e.filter&&e.view&&\"string\"==typeof e.view&&(o.view=e.view)),e.query_params&&\"object\"==typeof e.query_params)for(var u in e.query_params)e.query_params.hasOwnProperty(u)&&(o[u]=e.query_params[u]);var f,d=\"GET\";if(e.doc_ids){o.filter=\"_doc_ids\";var h=JSON.stringify(e.doc_ids);h.length<yo?o.doc_ids=h:(d=\"POST\",f={doc_ids:e.doc_ids})}var v,y,_=function(r,u){if(!e.aborted){o.since=r,\"object\"==typeof o.since&&(o.since=JSON.stringify(o.since)),e.descending?i&&(o.limit=s):o.limit=!i||s>t?t:s;var c={method:d,url:tt(l,\"_changes\"+rt(o)),timeout:e.timeout,body:f};y=r,e.aborted||a().then(function(){v=n(e,c,u)})[\"catch\"](u)}},m={results:[]},g=function(n,o){if(!e.aborted){var a=0;if(o&&o.results){a=o.results.length,m.last_seq=o.last_seq;var u={};u.query=e.query_params,o.results=o.results.filter(function(t){s--;var n=we(e)(t);return n&&(e.include_docs&&e.attachments&&e.binary&&$e(t),r&&m.results.push(t),e.onChange(t)),n})}else if(n)return e.aborted=!0,void e.complete(n);o&&o.last_seq&&(y=o.last_seq);var c=i&&0>=s||o&&t>a||e.descending;(!e.continuous||i&&0>=s)&&c?e.complete(null,m):setTimeout(function(){_(y,g)},0)}};return _(e.since||0,g),{cancel:function(){e.aborted=!0,v&&v.abort()}}},u.revsDiff=o(\"revsDiff\",function(e,t,r){\"function\"==typeof t&&(r=t,t={}),n(t,{method:\"POST\",url:tt(l,\"_revs_diff\"),body:e},r)}),u._close=function(e){e()},u._destroy=function(t,r){n(t,{url:tt(l,\"\"),method:\"DELETE\"},function(t,n){return t&&t.status&&404!==t.status?r(t):(u.emit(\"destroyed\"),u.constructor.emit(\"destroyed\",e.name),void r(null,n))})}}function it(){this.promise=new fr(function(e){e()})}function at(e){return ur.hash(e)}function st(e){var t=e.db,n=e.viewName,r=e.map,o=e.reduce,i=e.temporary,a=r.toString()+(o&&o.toString())+\"undefined\";if(!i&&t._cachedViews){var s=t._cachedViews[a];if(s)return fr.resolve(s)}return t.info().then(function(e){function s(e){e.views=e.views||{};var t=n;-1===t.indexOf(\"/\")&&(t=n+\"/\"+n);var r=e.views[t]=e.views[t]||{};if(!r[u])return r[u]=!0,e}var u=e.db_name+\"-mrview-\"+(i?\"temp\":at(a));return h(t,\"_local/mrviews\",s).then(function(){return t.registerDependentDatabase(u).then(function(e){var n=e.db;n.auto_compaction=!0;var s={name:u,db:n,sourceDB:t,adapter:t.adapter,mapFun:r,reduceFun:o};return s.db.get(\"_local/lastSeq\")[\"catch\"](function(e){if(404!==e.status)throw e}).then(function(e){return s.seq=e?e.seq:0,i||(t._cachedViews=t._cachedViews||{},t._cachedViews[a]=s,s.db.once(\"destroyed\",function(){delete t._cachedViews[a]})),s})})})})}function ut(e,t,n,r,o,i){return ir(\"return (\"+e.replace(/;\\s*$/,\"\")+\");\",{emit:t,sum:n,log:r,isArray:o,toJSON:i})}function ct(e){return-1===e.indexOf(\"/\")?[e,e]:e.split(\"/\")}function ft(e){return 1===e.length&&/^1-/.test(e[0].rev)}function lt(e,t){try{e.emit(\"error\",t)}catch(n){console.error(\"The user's map/reduce function threw an uncaught error.\\nYou can debug this error by doing:\\nmyDatabase.on('error', function (err) { debugger; });\\nPlease double-check your map/reduce function.\"),console.error(t)}}function dt(e,t,n){try{return{output:t.apply(null,n)}}catch(r){return lt(e,r),{error:r}}}function ht(e,t){var n=qo(e.key,t.key);return 0!==n?n:qo(e.value,t.value)}function pt(e,t,n){return n=n||0,\"number\"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function vt(e){var t=e.value,n=t&&\"object\"==typeof t&&t._id||e.id;return n}function yt(e){e.rows.forEach(function(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];t[e].data=Ve(n.data,n.content_type)})})}function _t(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&yt(t),t}}function mt(e){var t=\"builtin \"+e+\" function requires map values to be numbers or number arrays\";return new Pt(t)}function gt(e){for(var t=0,n=0,r=e.length;r>n;n++){var o=e[n];if(\"number\"!=typeof o){if(!Array.isArray(o))throw mt(\"_sum\");t=\"number\"==typeof t?[t]:t;for(var i=0,a=o.length;a>i;i++){var s=o[i];if(\"number\"!=typeof s)throw mt(\"_sum\");\"undefined\"==typeof t[i]?t.push(s):t[i]+=s}}else\"number\"==typeof t?t+=o:t[0]+=o}return t}function bt(e,t,n,r){var o=t[e];\"undefined\"!=typeof o&&(r&&(o=encodeURIComponent(JSON.stringify(o))),n.push(e+\"=\"+o))}function wt(e){if(\"undefined\"!=typeof e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function Et(e){return e.group_level=wt(e.group_level),e.limit=wt(e.limit),e.skip=wt(e.skip),e}function St(e){if(e){if(\"number\"!=typeof e)return new Ut('Invalid value for integer: \"'+e+'\"');if(0>e)return new Ut('Invalid value for positive integer: \"'+e+'\"')}}function kt(e,t){var n=e.descending?\"endkey\":\"startkey\",r=e.descending?\"startkey\":\"endkey\";if(\"undefined\"!=typeof e[n]&&\"undefined\"!=typeof e[r]&&qo(e[n],e[r])>0)throw new Ut(\"No rows can match your key range, reverse your start_key and end_key or set {descending : true}\");if(t.reduce&&e.reduce!==!1){if(e.include_docs)throw new Ut(\"{include_docs:true} is invalid for reduce\");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new Ut(\"Multi-key fetches for reduce views must use {group: true}\")}[\"group_level\",\"limit\",\"skip\"].forEach(function(t){var n=St(e[t]);if(n)throw n})}function qt(e,t,n){var r,o=[],i=\"GET\";if(bt(\"reduce\",n,o),bt(\"include_docs\",n,o),bt(\"attachments\",n,o),bt(\"limit\",n,o),bt(\"descending\",n,o),bt(\"group\",n,o),bt(\"group_level\",n,o),bt(\"skip\",n,o),bt(\"stale\",n,o),bt(\"conflicts\",n,o),bt(\"startkey\",n,o,!0),bt(\"start_key\",n,o,!0),bt(\"endkey\",n,o,!0),bt(\"end_key\",n,o,!0),bt(\"inclusive_end\",n,o),bt(\"key\",n,o,!0),o=o.join(\"&\"),o=\"\"===o?\"\":\"?\"+o,\"undefined\"!=typeof n.keys){var a=2e3,s=\"keys=\"+encodeURIComponent(JSON.stringify(n.keys));s.length+o.length+1<=a?o+=(\"?\"===o[0]?\"&\":\"?\")+s:(i=\"POST\",\"string\"==typeof t?r={keys:n.keys}:t.keys=n.keys)}if(\"string\"==typeof t){var u=ct(t);return e.request({method:i,url:\"_design/\"+u[0]+\"/_view/\"+u[1]+o,body:r}).then(_t(n))}return r=r||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?r[e]=t[e]:r[e]=t[e].toString()}),e.request({method:\"POST\",url:\"_temp_view\"+o,body:r}).then(_t(n))}function xt(e,t,n){return new fr(function(r,o){e._query(t,n,function(e,t){return e?o(e):void r(t)})})}function At(e){return new fr(function(t,n){e._viewCleanup(function(e,r){return e?n(e):void t(r)})})}function Tt(e){return function(t){if(404===t.status)return e;throw t}}function Ot(e,t,n){function r(){return ft(f)?fr.resolve(s):t.db.get(a)[\"catch\"](Tt(s))}function o(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):fr.resolve({rows:[]})}function i(e,t){for(var n=[],r={},o=0,i=t.rows.length;i>o;o++){var a=t.rows[o],s=a.doc;if(s&&(n.push(s),r[s._id]=!0,s._deleted=!c[s._id],!s._deleted)){var u=c[s._id];\"value\"in u&&(s.value=u.value)}}var f=Object.keys(c);return f.forEach(function(e){if(!r[e]){var t={_id:e},o=c[e];\"value\"in o&&(t.value=o.value),n.push(t)}}),e.keys=Co(f.concat(e.keys)),n.push(e),n}var a=\"_local/doc_\"+e,s={_id:a,keys:[]},u=n[e],c=u.indexableKeysToKeyValues,f=u.changes;return r().then(function(e){return o(e).then(function(t){return i(e,t)})})}function jt(e,t,n){var r=\"_local/lastSeq\";return e.db.get(r)[\"catch\"](Tt({_id:r,seq:0})).then(function(r){var o=Object.keys(t);return fr.all(o.map(function(n){return Ot(n,e,t)})).then(function(t){var o=Qe(t);return r.seq=n,o.push(r),e.db.bulkDocs({docs:o})})})}function Ct(e){var t=\"string\"==typeof e?e:e.name,n=Ro[t];return n||(n=Ro[t]=new it),n}function It(e){return jo(Ct(e),function(){return Lt(e)})()}function Lt(e){function t(e,t){var n={id:o._id,key:Ao(e)};\"undefined\"!=typeof t&&null!==t&&(n.value=Ao(t)),r.push(n)}function n(t,n){return function(){return jt(e,t,n)}}var r,o,i;if(\"function\"==typeof e.mapFun&&2===e.mapFun.length){var a=e.mapFun;i=function(e){return a(e,t)}}else i=ut(e.mapFun.toString(),t,gt,mo,Array.isArray,JSON.parse);var s=e.seq||0,u=new it;return new fr(function(t,a){function c(){u.finish().then(function(){e.seq=s,t()})}function f(){function t(e){a(e)}e.sourceDB.changes({conflicts:!0,include_docs:!0,style:\"all_docs\",since:s,limit:No}).on(\"complete\",function(t){var a=t.results;if(!a.length)return c();for(var l={},d=0,h=a.length;h>d;d++){var p=a[d];if(\"_\"!==p.doc._id[0]){r=[],o=p.doc,o._deleted||dt(e.sourceDB,i,[o]),r.sort(ht);for(var v,y={},_=0,m=r.length;m>_;_++){var g=r[_],b=[g.key,g.id];0===qo(g.key,v)&&b.push(_);var w=xo(b);y[w]=g,v=g.key}l[p.doc._id]={indexableKeysToKeyValues:y,changes:p.changes}}s=p.seq}return u.add(n(l,s)),a.length<No?c():f()}).on(\"error\",t)}f()})}function Rt(e,t,n){0===n.group_level&&delete n.group_level;var r,o=n.group||n.group_level;r=Bo[e.reduceFun]?Bo[e.reduceFun]:ut(e.reduceFun.toString(),null,gt,mo,Array.isArray,JSON.parse);var i=[],a=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;t.forEach(function(e){var t=i[i.length-1],n=o?e.key:null;return o&&Array.isArray(n)&&(n=n.slice(0,a)),t&&0===qo(t.groupKey,n)?(t.keys.push([e.key,e.id]),void t.values.push(e.value)):void i.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[];for(var s=0,u=i.length;u>s;s++){var c=i[s],f=dt(e.sourceDB,r,[c.keys,c.values,!1]);if(f.error&&f.error instanceof Pt)throw f.error;t.push({value:f.error?null:f.output,key:c.groupKey})}return{rows:pt(t,n.limit,n.skip)}}function Dt(e,t){return jo(Ct(e),function(){return Nt(e,t)})()}function Nt(e,t){function n(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return o=e.total_rows,e.rows.map(function(e){if(\"value\"in e.doc&&\"object\"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=[\"id\",\"key\",\"value\"];if(!(n>t||t>n))return e.doc.value}var r=To(e.doc._id);return{key:r[0],id:r[1],value:\"value\"in e.doc?e.doc.value:null}})})}function r(n){var r;if(r=i?Rt(e,n,t):{total_rows:o,offset:a,rows:n},t.include_docs){var s=Co(n.map(vt));return e.sourceDB.allDocs({keys:s,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t={};return e.rows.forEach(function(e){e.doc&&(t[\"$\"+e.id]=e.doc)}),n.forEach(function(e){var n=vt(e),r=t[\"$\"+n];r&&(e.doc=r)}),r})}return r}var o,i=e.reduceFun&&t.reduce!==!1,a=t.skip||0;if(\"undefined\"==typeof t.keys||t.keys.length||(t.limit=0,delete t.keys),\"undefined\"!=typeof t.keys){var s=t.keys,u=s.map(function(e){var t={startkey:xo([e]),endkey:xo([e,{}])};return n(t)});return fr.all(u).then(Qe).then(r)}var c={descending:t.descending};if(t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),\"undefined\"!=typeof t.startkey&&(c.startkey=xo(t.descending?[t.startkey,{}]:[t.startkey])),\"undefined\"!=typeof t.endkey){var f=t.inclusive_end!==!1;t.descending&&(f=!f),c.endkey=xo(f?[t.endkey,{}]:[t.endkey])}if(\"undefined\"!=typeof t.key){var l=xo([t.key]),d=xo([t.key,{}]);c.descending?(c.endkey=l,c.startkey=d):(c.startkey=l,c.endkey=d)}return i||(\"number\"==typeof t.limit&&(c.limit=t.limit),c.skip=a),n(c).then(r)}function Bt(e){return e.request({method:\"POST\",url:\"_view_cleanup\"})}function Ft(e){return e.get(\"_local/mrviews\").then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=ct(e),r=\"_design/\"+t[0],o=t[1];n[r]=n[r]||{},n[r][o]=!0});var r={keys:Object.keys(n),include_docs:!0};return e.allDocs(r).then(function(r){var o={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var i=r+\"/\"+n;t.views[i]||(i=n);var a=Object.keys(t.views[i]),s=e.doc&&e.doc.views&&e.doc.views[n];a.forEach(function(e){o[e]=o[e]||s})})});var i=Object.keys(o).filter(function(e){return!o[e]}),a=i.map(function(t){return jo(Ct(t),function(){return new e.constructor(t,e.__opts).destroy()})()});return fr.all(a).then(function(){return{ok:!0}})})},Tt({ok:!0}))}function Mt(e,t,r){if(\"http\"===e.type())return qt(e,t,r);if(\"function\"==typeof e._query)return xt(e,t,r);if(\"string\"!=typeof t){kt(r,t);var o={db:e,viewName:\"temp_view/temp_view\",map:t.map,reduce:t.reduce,temporary:!0};return Do.add(function(){return st(o).then(function(e){function t(){return e.db.destroy()}return Io(It(e).then(function(){return Dt(e,r)}),t)})}),Do.finish()}var i=t,a=ct(i),s=a[0],u=a[1];return e.getView(s,u).then(function(t){kt(r,t);var o={db:e,viewName:i,map:t.map,reduce:t.reduce};return st(o).then(function(e){return\"ok\"===r.stale||\"update_after\"===r.stale?(\"update_after\"===r.stale&&n.nextTick(function(){It(e)}),Dt(e,r)):It(e).then(function(){return Dt(e,r)})})})}function Ut(e){this.status=400,this.name=\"query_parse_error\",this.message=e,this.error=!0;try{Error.captureStackTrace(this,Ut)}catch(t){}}function Pt(e){this.status=500,this.name=\"invalid_value\",this.message=e,this.error=!0;try{Error.captureStackTrace(this,Pt)}catch(t){}}function Ht(e){return $r(Ge(e))}function Kt(e,t,n){function r(e){try{return Qr(e)}catch(t){var n=A(wr,\"Attachment is not a valid base64 string\");return{error:n}}}function o(e,n){if(e.stub)return n();if(\"string\"==typeof e.data){var o=r(e.data);if(o.error)return n(o.error);e.length=o.length,\"blob\"===t?e.data=ge(o,e.content_type):\"base64\"===t?e.data=$r(o):e.data=o,co(o).then(function(t){e.digest=\"md5-\"+t,n()})}else ue(e.data,function(r){\"binary\"===t?e.data=Ge(r):\"base64\"===t&&(e.data=Ht(r)),co(r).then(function(t){e.digest=\"md5-\"+t,e.length=r.byteLength,n()})})}function i(){s++,e.length===s&&(a?n(a):n())}if(!e.length)return n();var a,s=0;e.forEach(function(e){function t(e){a=e,r++,r===n.length&&i()}var n=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],r=0;if(!n.length)return i();for(var s in e.data._attachments)e.data._attachments.hasOwnProperty(s)&&o(e.data._attachments[s],t)})}function Wt(e,t){return e.pos-t.pos}function Jt(e,t,n){for(var r,o=0,i=e.length;i>o;)r=o+i>>>1,n(e[r],t)<0?o=r+1:i=r;return o}function Vt(e,t,n){var r=Jt(e,t,n);e.splice(r,0,t)}function Gt(e,t){for(var n,r,o=t,i=e.length;i>o;o++){var a=e[o],s=[a.id,a.opts,[]];r?(r[2].push(s),r=s):n=r=s}return n}function Xt(e,t){return e[0]<t[0]?-1:1}function zt(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var o=n.pop(),i=o.tree1,a=o.tree2;(i[1].status||a[1].status)&&(i[1].status=\"available\"===i[1].status||\"available\"===a[1].status?\"available\":\"missing\");for(var s=0;s<a[2].length;s++)if(i[2][0]){for(var u=!1,c=0;c<i[2].length;c++)i[2][c][0]===a[2][s][0]&&(n.push({tree1:i[2][c],tree2:a[2][s]}),u=!0);u||(r=\"new_branch\",Vt(i[2],a[2][s],Xt))}else r=\"new_leaf\",i[2][0]=a[2][s]}return{conflicts:r,tree:e}}function Qt(e,t,n){var r,o=[],i=!1,a=!1;if(!e.length)return{tree:[t],conflicts:\"new_leaf\"};for(var s=0,u=e.length;u>s;s++){var c=e[s];if(c.pos===t.pos&&c.ids[0]===t.ids[0])r=zt(c.ids,t.ids),o.push({pos:c.pos,ids:r.tree}),i=i||r.conflicts,a=!0;else if(n!==!0){var f=c.pos<t.pos?c:t,l=c.pos<t.pos?t:c,d=l.pos-f.pos,h=[],p=[];for(p.push({ids:f.ids,diff:d,parent:null,parentIdx:null});p.length>0;){var v=p.pop();if(0!==v.diff)for(var y=v.ids[2],_=0,m=y.length;m>_;_++)p.push({ids:y[_],diff:v.diff-1,parent:v.ids,parentIdx:_});else v.ids[0]===l.ids[0]&&h.push(v)}var g=h[0];g?(r=zt(g.ids,l.ids),g.parent[2][g.parentIdx]=r.tree,o.push({pos:f.pos,ids:f.ids}),i=i||r.conflicts,a=!0):o.push(c)}else o.push(c)}return a||o.push(t),o.sort(Wt),{tree:o,conflicts:i||\"internal_node\"}}function $t(e,t){for(var n,r=L(e),o={},i=0,a=r.length;a>i;i++){for(var s=r[i],u=s.ids,c=Math.max(0,u.length-t),f={pos:s.pos+c,ids:Gt(u,c)},l=0;c>l;l++){var d=s.pos+l+\"-\"+u[l].id;o[d]=!0}n=n?Qt(n,f,!0).tree:[f]}return E(n,function(e,t,n){delete o[t+\"-\"+n]}),{tree:n,revs:Object.keys(o)}}function Yt(e,t,n){var r=Qt(e,t),o=$t(r.tree,n);return{tree:o.tree,stemmedRevs:o.revs,conflicts:r.conflicts}}function Zt(e,t){for(var n,r=e.slice(),o=t.split(\"-\"),i=parseInt(o[0],10),a=o[1];n=r.pop();){if(n.pos===i&&n.ids[0]===a)return!0;for(var s=n.ids[2],u=0,c=s.length;c>u;u++)r.push({pos:n.pos+1,ids:s[u]})}return!1}function en(e,t,n,r,o,i,a,s){if(Zt(t.rev_tree,n.metadata.rev))return r[o]=n,i();var u=t.winningRev||v(t),c=\"deleted\"in t?t.deleted:_(t,u),f=\"deleted\"in n.metadata?n.metadata.deleted:_(n.metadata),l=/^1-/.test(n.metadata.rev);if(c&&!f&&s&&l){var d=n.data;d._rev=u,d._id=n.metadata.id,n=U(d,s)}var h=Yt(t.rev_tree,n.metadata.rev_tree[0],e),p=s&&(c&&f||!c&&\"new_leaf\"!==h.conflicts||c&&!f&&\"new_branch\"===h.conflicts);if(p){var y=A(vr);return r[o]=y,i()}var m=n.metadata.rev;n.metadata.rev_tree=h.tree,n.stemmedRevs=h.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var g,b=v(n.metadata),w=_(n.metadata,b),E=c===w?0:w>c?-1:1;g=m===b?w:_(n.metadata,m),a(n,b,w,g,!0,E,o,i)}function tn(e){return\"missing\"===e.metadata.rev_tree[0].ids[1].status}function nn(e,t,n,r,o,i,a,s,u){function c(e,t,n){var r=v(e.metadata),o=_(e.metadata,r);if(\"was_delete\"in s&&o)return i[t]=A(pr,\"deleted\"),n();var u=l&&tn(e);if(u){var c=A(vr);return i[t]=c,n()}var f=o?0:1;a(e,r,o,o,!1,f,t,n)}function f(){++h===p&&u&&u()}e=e||1e3;var l=s.new_edits,d=new nr.Map,h=0,p=t.length;t.forEach(function(e,t){if(e._id&&I(e._id)){var r=e._deleted?\"_removeLocal\":\"_putLocal\";return void n[r](e,{ctx:o},function(e,n){i[t]=e||n,f()})}var a=e.metadata.id;d.has(a)?(p--,d.get(a).push([e,t])):d.set(a,[[e,t]])}),d.forEach(function(t,n){function o(){++u<t.length?s():f()}function s(){var s=t[u],f=s[0],d=s[1];if(r.has(n))en(e,r.get(n),f,i,d,o,a,l);else{var h=Yt([],f.metadata.rev_tree[0],e);f.metadata.rev_tree=h.tree,f.stemmedRevs=h.stemmedRevs||[],c(f,d,o)}}var u=0;s()})}function rn(e){var t=[];return E(e.rev_tree,function(e,n,r,o,i){\"available\"!==i.status||e||(t.push(n+\"-\"+r),i.status=\"missing\")}),t}function on(e){try{return JSON.parse(e)}catch(t){return cr.parse(e)}}function an(e){return e.length<5e4?JSON.parse(e):on(e)}function sn(e){try{return JSON.stringify(e)}catch(t){return cr.stringify(e)}}function un(e,t,n,r){try{e.apply(t,n)}catch(o){r.emit(\"error\",o)}}function cn(e){if(!zo.running&&zo.queue.length){zo.running=!0;var t=zo.queue.shift();t.action(function(r,o){un(t.callback,this,[r,o],e),zo.running=!1,n.nextTick(function(){cn(e)})})}}function fn(e){return function(t){var n=\"unknown_error\";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(A(Tr,n,t.type))}}function ln(e,t,n){return{data:sn(e),winningRev:t,deletedOrLocal:n?\"1\":\"0\",seq:e.seq,id:e.id}}function dn(e){if(!e)return null;var t=an(e.data);return t.winningRev=e.winningRev,t.deleted=\"1\"===e.deletedOrLocal,t.seq=e.seq,t}function hn(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(\":\");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function pn(e,t,n,r){n?r(e?\"string\"!=typeof e?e:Ve(e,t):se([\"\"],{type:t})):e?\"string\"!=typeof e?Xe(e,function(e){r($r(e))}):r(e):r(\"\")}function vn(e,t,n,r){function o(){++s===a.length&&r&&r()}function i(e,t){var r=e._attachments[t],i=r.digest,a=n.objectStore(Wo).get(i);a.onsuccess=function(e){r.body=e.target.result.body,o()}}var a=Object.keys(e._attachments||{});if(!a.length)return r&&r();var s=0;a.forEach(function(n){t.attachments&&t.include_docs?i(e,n):(e._attachments[n].stub=!0,o())})}function yn(e,t){return fr.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return fr.all(n.map(function(n){var r=e.doc._attachments[n];if(\"body\"in r){var o=r.body,a=r.content_type;return new fr(function(s){pn(o,a,t,function(t){e.doc._attachments[n]=$n.extend(i(r,[\"digest\",\"content_type\"]),{data:t}),s()})})}}))}}))}function _n(e,t,n){function r(){c--,c||o()}function o(){i.length&&i.forEach(function(e){var t=u.index(\"digestSeq\").count(IDBKeyRange.bound(e+\"::\",e+\"::￿\",!1,!1));t.onsuccess=function(t){var n=t.target.result;n||s[\"delete\"](e)}})}var i=[],a=n.objectStore(Ko),s=n.objectStore(Wo),u=n.objectStore(Jo),c=e.length;e.forEach(function(e){var n=a.index(\"_doc_id_rev\"),o=t+\"::\"+e;n.getKey(o).onsuccess=function(e){var t=e.target.result;if(\"number\"!=typeof t)return r();a[\"delete\"](t);var n=u.index(\"seq\").openCursor(IDBKeyRange.only(t));n.onsuccess=function(e){var t=e.target.result;if(t){var n=t.value.digestSeq.split(\"::\")[0];i.push(n),u[\"delete\"](t.primaryKey),t[\"continue\"]()}else r()}}})}function mn(e,t,n){try{return{txn:e.transaction(t,n)}}catch(r){return{error:r}}}function gn(e,t,n,r,o,i,a){function s(){var e=[Ho,Ko,Wo,Go,Jo],t=mn(o,e,\"readwrite\");return t.error?a(t.error):(g=t.txn,g.onabort=fn(a),g.ontimeout=fn(a),g.oncomplete=f,b=g.objectStore(Ho),w=g.objectStore(Ko),E=g.objectStore(Wo),S=g.objectStore(Jo),void d(function(e){return e?(R=!0,a(e)):void c()}))}function u(){nn(e.revs_limit,q,r,L,g,C,h,n)}function c(){function e(){++n===q.length&&u()}function t(t){var n=dn(t.target.result);n&&L.set(n.id,n),e()}if(q.length)for(var n=0,r=0,o=q.length;o>r;r++){var i=q[r];if(i._id&&I(i._id))e();else{var a=b.get(i.metadata.id);a.onsuccess=t}}}function f(){R||(i.notify(r._meta.name),r._meta.docCount+=x,a(null,C))}function l(e,t){var n=E.get(e);n.onsuccess=function(n){if(n.target.result)t();else{var r=A(Rr,\"unknown stub attachment with digest \"+e);r.status=412,t(r)}}}function d(e){function t(){++o===n.length&&e(r)}var n=[];if(q.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var r=e.data._attachments[t];r.stub&&n.push(r.digest)})}),!n.length)return e();var r,o=0;n.forEach(function(e){l(e,function(e){e&&!r&&(r=e),t()})})}function h(e,t,n,r,o,i,a,s){x+=i,e.metadata.winningRev=t,e.metadata.deleted=n;var u=e.data;u._id=e.metadata.id,u._rev=e.metadata.rev,r&&(u._deleted=!0);var c=u._attachments&&Object.keys(u._attachments).length;return c?y(e,t,n,o,a,s):void v(e,t,n,o,a,s)}function p(e){var t=rn(e.metadata);_n(t,e.metadata.id,g)}function v(e,t,n,o,i,a){function s(i){o&&r.auto_compaction?p(e):e.stemmedRevs.length&&_n(e.stemmedRevs,e.metadata.id,g),l.seq=i.target.result,delete l.rev;var a=ln(l,t,n),s=b.put(a);s.onsuccess=c}function u(e){e.preventDefault(),e.stopPropagation();var t=w.index(\"_doc_id_rev\"),n=t.getKey(f._doc_id_rev);n.onsuccess=function(e){var t=w.put(f,e.target.result);t.onsuccess=s}}function c(){C[i]={ok:!0,id:l.id,rev:t},L.set(e.metadata.id,e.metadata),_(e,l.seq,a)}var f=e.data,l=e.metadata;f._doc_id_rev=l.id+\"::\"+l.rev,delete f._id,delete f._rev;var d=w.put(f);d.onsuccess=s,d.onerror=u}function y(e,t,n,r,o,i){function a(){c===f.length&&v(e,t,n,r,o,i)}function s(){c++,a()}var u=e.data,c=0,f=Object.keys(u._attachments);f.forEach(function(t){var n=e.data._attachments[t];if(n.stub)c++,a();else{var r=n.data;delete n.data;var o=n.digest;m(o,r,s)}})}function _(e,t,n){function r(){++i===a.length&&n()}function o(n){var o=e.data._attachments[n].digest,i=S.put({seq:t,digestSeq:o+\"::\"+t});i.onsuccess=r,i.onerror=function(e){e.preventDefault(),e.stopPropagation(),r()}}var i=0,a=Object.keys(e.data._attachments||{});if(!a.length)return n();for(var s=0;s<a.length;s++)o(a[s])}function m(e,t,n){var r=E.count(e);r.onsuccess=function(r){var o=r.target.result;if(o)return n();var i={digest:e,body:t},a=E.put(i);a.onsuccess=n}}for(var g,b,w,E,S,k,q=t.docs,x=0,T=0,O=q.length;O>T;T++){var j=q[T];j._id&&I(j._id)||(j=q[T]=U(j,n.new_edits),j.error&&!k&&(k=j))}if(k)return a(k);var C=new Array(q.length),L=new nr.Map,R=!1,D=r._meta.blobSupport?\"blob\":\"base64\";Kt(q,D,function(e){return e?a(e):void s()})}function bn(e,t,n,r,o){try{if(e&&t)return o?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return o?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return o?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(i){return{error:i}}return null}function wn(e,t,n,r){return\"DataError\"===n.name&&0===n.code?r(null,{total_rows:e._meta.docCount,offset:t.skip,rows:[]}):void r(A(Tr,n.name,n.message))}function En(e,t,n,r){function o(e,r){function o(t,n,r){var o=t.id+\"::\"+r;S.get(o).onsuccess=function(r){n.doc=hn(r.target.result),e.conflicts&&(n.doc._conflicts=q(t)),vn(n.doc,e,g)}}function i(t,n,r){var i={id:r.id,key:r.id,value:{rev:n}},a=r.deleted;if(\"ok\"===e.deleted)k.push(i),a?(i.value.deleted=!0,i.doc=null):e.include_docs&&o(r,i,n);else if(!a&&d--<=0&&(k.push(i),e.include_docs&&o(r,i,n),0===--h))return;t[\"continue\"]()}function a(e){x=t._meta.docCount;var n=e.target.result;if(n){var r=dn(n.value),o=r.winningRev;i(n,o,r)}}function s(){r(null,{total_rows:x,offset:e.skip,rows:k})}function u(){e.attachments?yn(k,e.binary).then(s):s()}var c=\"startkey\"in e?e.startkey:!1,f=\"endkey\"in e?e.endkey:!1,l=\"key\"in e?e.key:!1,d=e.skip||0,h=\"number\"==typeof e.limit?e.limit:-1,p=e.inclusive_end!==!1,v=\"descending\"in e&&e.descending?\"prev\":null,y=bn(c,f,p,l,v);if(y&&y.error)return wn(t,e,y.error,r);var _=[Ho,Ko];e.attachments&&_.push(Wo);var m=mn(n,_,\"readonly\");if(m.error)return r(m.error);var g=m.txn,b=g.objectStore(Ho),w=g.objectStore(Ko),E=v?b.openCursor(y,v):b.openCursor(y),S=w.index(\"_doc_id_rev\"),k=[],x=0;g.oncomplete=u,E.onsuccess=a}function i(e,n){return 0===e.limit?n(null,{total_rows:t._meta.docCount,offset:e.skip,rows:[]}):void o(e,n)}i(e,r)}function Sn(e){return new fr(function(t){var n=se([\"\"]);e.objectStore(Xo).put(n,\"key\"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\\/(\\d+)/),n=navigator.userAgent.match(/Edge\\//);t(n||!e||parseInt(e[1],10)>=43)}})[\"catch\"](function(){return!1})}function kn(e){oe()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):ie()&&(\"undefined\"!=typeof addEventListener?addEventListener(\"storage\",function(t){e.emit(t.key)}):window.attachEvent(\"storage\",function(t){e.emit(t.key)}))}function qn(){or.EventEmitter.call(this),this._listeners={},kn(this)}function xn(e,t){var n=this;zo.queue.push({action:function(t){An(n,e,t)},callback:t}),cn(n.constructor)}function An(e,t,r){function o(e){var t=e.createObjectStore(Ho,{keyPath:\"id\"});e.createObjectStore(Ko,{autoIncrement:!0}).createIndex(\"_doc_id_rev\",\"_doc_id_rev\",{unique:!0}),e.createObjectStore(Wo,{keyPath:\"digest\"}),e.createObjectStore(Vo,{keyPath:\"id\",autoIncrement:!1}),e.createObjectStore(Xo),t.createIndex(\"deletedOrLocal\",\"deletedOrLocal\",{unique:!1}),e.createObjectStore(Go,{keyPath:\"_id\"});var n=e.createObjectStore(Jo,{autoIncrement:!0});n.createIndex(\"seq\",\"seq\"),n.createIndex(\"digestSeq\",\"digestSeq\",{unique:!0})}function i(e,t){var n=e.objectStore(Ho);n.createIndex(\"deletedOrLocal\",\"deletedOrLocal\",{unique:!1}),n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var o=r.value,i=_(o);o.deletedOrLocal=i?\"1\":\"0\",n.put(o),r[\"continue\"]()}else t()}}function a(e){e.createObjectStore(Go,{keyPath:\"_id\"}).createIndex(\"_doc_id_rev\",\"_doc_id_rev\",{unique:!0})}function s(e,t){var n=e.objectStore(Go),r=e.objectStore(Ho),o=e.objectStore(Ko),i=r.openCursor();i.onsuccess=function(e){var i=e.target.result;if(i){var a=i.value,s=a.id,u=I(s),c=v(a);if(u){var f=s+\"::\"+c,l=s+\"::\",d=s+\"::~\",h=o.index(\"_doc_id_rev\"),p=IDBKeyRange.bound(l,d,!1,!1),y=h.openCursor(p);y.onsuccess=function(e){if(y=e.target.result){var t=y.value;t._doc_id_rev===f&&n.put(t),o[\"delete\"](y.primaryKey),y[\"continue\"]()}else r[\"delete\"](i.primaryKey),i[\"continue\"]()}}else i[\"continue\"]()}else t&&t()}}function u(e){var t=e.createObjectStore(Jo,{autoIncrement:!0});t.createIndex(\"seq\",\"seq\"),t.createIndex(\"digestSeq\",\"digestSeq\",{unique:!0})}function f(e,t){var n=e.objectStore(Ko),r=e.objectStore(Wo),o=e.objectStore(Jo),i=r.count();i.onsuccess=function(e){var r=e.target.result;return r?void(n.openCursor().onsuccess=function(e){var n=e.target.result;if(!n)return t();for(var r=n.value,i=n.primaryKey,a=Object.keys(r._attachments||{}),s={},u=0;u<a.length;u++){var c=r._attachments[a[u]];s[c.digest]=!0}var f=Object.keys(s);for(u=0;u<f.length;u++){var l=f[u];o.put({seq:i,digestSeq:l+\"::\"+i})}n[\"continue\"]()}):t()}}function d(e){function t(e){return e.data?dn(e):(e.deleted=\"1\"===e.deletedOrLocal,e)}var n=e.objectStore(Ko),r=e.objectStore(Ho),o=r.openCursor();o.onsuccess=function(e){function o(){var e=s.id+\"::\",t=s.id+\"::￿\",r=n.index(\"_doc_id_rev\").openCursor(IDBKeyRange.bound(e,t)),o=0;r.onsuccess=function(e){var t=e.target.result;if(!t)return s.seq=o,i();var n=t.primaryKey;n>o&&(o=n),t[\"continue\"]()}}function i(){var e=ln(s,s.winningRev,s.deleted),t=r.put(e);t.onsuccess=function(){a[\"continue\"]()}}var a=e.target.result;if(a){var s=t(a.value);return s.winningRev=s.winningRev||v(s),s.seq?i():void o()}}}var h=t.name,p=null;e._meta=null,e.type=function(){return\"idb\"},e._id=l(function(t){t(null,e._meta.instanceId)}),e._bulkDocs=function(n,r,o){gn(t,n,r,e,p,Yo,o)},e._get=function(e,t,n){function r(){n(a,{doc:o,metadata:i,ctx:s})}var o,i,a,s=t.ctx;if(!s){var u=mn(p,[Ho,Ko,Wo],\"readonly\");if(u.error)return n(u.error);s=u.txn}s.objectStore(Ho).get(e).onsuccess=function(e){if(i=dn(e.target.result),!i)return a=A(pr,\"missing\"),r();if(_(i)&&!t.rev)return a=A(pr,\"deleted\"),r();var n=s.objectStore(Ko),u=t.rev||i.winningRev,c=i.id+\"::\"+u;n.index(\"_doc_id_rev\").get(c).onsuccess=function(e){return o=e.target.result,o&&(o=hn(o)),o?void r():(a=A(pr,\"missing\"),r())}}},e._getAttachment=function(e,t,n){var r;if(t.ctx)r=t.ctx;else{var o=mn(p,[Ho,Ko,Wo],\"readonly\");if(o.error)return n(o.error);r=o.txn}var i=e.digest,a=e.content_type;r.objectStore(Wo).get(i).onsuccess=function(e){var r=e.target.result.body;pn(r,a,t.binary,function(e){n(null,e)})}},e._info=function(t){if(null===p||!$o.has(h)){var n=new Error(\"db isn't open\");return n.id=\"idbNull\",t(n)}var r,o,i=mn(p,[Ko],\"readonly\");if(i.error)return t(i.error);var a=i.txn,s=a.objectStore(Ko).openCursor(null,\"prev\");s.onsuccess=function(t){var n=t.target.result;r=n?n.key:0,o=e._meta.docCount},a.oncomplete=function(){t(null,{doc_count:o,update_seq:r,idb_attachment_format:e._meta.blobSupport?\"binary\":\"base64\"})}},e._allDocs=function(t,n){En(t,e,p,n)},e._changes=function(t){function n(e){function n(){return c.seq!==a?e[\"continue\"]():(u=a,c.winningRev===i._rev?o(i):void r())}function r(){var e=i._id+\"::\"+c.winningRev,t=_.get(e);t.onsuccess=function(e){o(hn(e.target.result))}}function o(n){var r=t.processChange(n,c,t);r.seq=c.seq;var o=b(r);return\"object\"==typeof o?t.complete(o):(o&&(g++,l&&m.push(r),t.attachments&&t.include_docs?vn(n,t,d,function(){yn([r],t.binary).then(function(){t.onChange(r)})}):t.onChange(r)),void(g!==f&&e[\"continue\"]()))}var i=hn(e.value),a=e.key;if(s&&!s.has(i._id))return e[\"continue\"]();var c;return(c=w.get(i._id))?n():void(y.get(i._id).onsuccess=function(e){c=dn(e.target.result),w.set(i._id,c),n()})}function r(e){var t=e.target.result;t&&n(t)}function o(){var e=[Ho,Ko];t.attachments&&e.push(Wo);var n=mn(p,e,\"readonly\");if(n.error)return t.complete(n.error);d=n.txn,d.onabort=fn(t.complete),d.oncomplete=i,v=d.objectStore(Ko),y=d.objectStore(Ho),_=v.index(\"_doc_id_rev\");var o;o=t.descending?v.openCursor(null,\"prev\"):v.openCursor(IDBKeyRange.lowerBound(t.since,!0)),o.onsuccess=r}function i(){function e(){t.complete(null,{results:m,last_seq:u})}!t.continuous&&t.attachments?yn(m).then(e):e()}if(t=c(t),t.continuous){var a=h+\":\"+D();return Yo.addListener(h,a,e,t),Yo.notify(h),{cancel:function(){Yo.removeListener(h,a)}}}var s=t.doc_ids&&new nr.Set(t.doc_ids);t.since=t.since||0;var u=t.since,f=\"limit\"in t?t.limit:-1;0===f&&(f=1);var l;l=\"return_docs\"in t?t.return_docs:\"returnDocs\"in t?t.returnDocs:!0;var d,v,y,_,m=[],g=0,b=we(t),w=new nr.Map;o()},e._close=function(e){return null===p?e(A(gr)):(p.close(),$o[\"delete\"](h),p=null,void e())},e._getRevisionTree=function(e,t){var n=mn(p,[Ho],\"readonly\");if(n.error)return t(n.error);var r=n.txn,o=r.objectStore(Ho).get(e);o.onsuccess=function(e){var n=dn(e.target.result);n?t(null,n.rev_tree):t(A(pr))}},e._doCompaction=function(e,t,n){var r=[Ho,Ko,Wo,Jo],o=mn(p,r,\"readwrite\");if(o.error)return n(o.error);\nvar i=o.txn,a=i.objectStore(Ho);a.get(e).onsuccess=function(n){var r=dn(n.target.result);E(r.rev_tree,function(e,n,r,o,i){var a=n+\"-\"+r;-1!==t.indexOf(a)&&(i.status=\"missing\")}),_n(t,e,i);var o=r.winningRev,a=r.deleted;i.objectStore(Ho).put(ln(r,o,a))},i.onabort=fn(n),i.oncomplete=function(){n()}},e._getLocal=function(e,t){var n=mn(p,[Go],\"readonly\");if(n.error)return t(n.error);var r=n.txn,o=r.objectStore(Go).get(e);o.onerror=fn(t),o.onsuccess=function(e){var n=e.target.result;n?(delete n._doc_id_rev,t(null,n)):t(A(pr))}},e._putLocal=function(e,t,n){\"function\"==typeof t&&(n=t,t={}),delete e._revisions;var r=e._rev,o=e._id;r?e._rev=\"0-\"+(parseInt(r.split(\"-\")[1],10)+1):e._rev=\"0-1\";var i,a=t.ctx;if(!a){var s=mn(p,[Go],\"readwrite\");if(s.error)return n(s.error);a=s.txn,a.onerror=fn(n),a.oncomplete=function(){i&&n(null,i)}}var u,c=a.objectStore(Go);r?(u=c.get(o),u.onsuccess=function(o){var a=o.target.result;if(a&&a._rev===r){var s=c.put(e);s.onsuccess=function(){i={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,i)}}else n(A(vr))}):(u=c.add(e),u.onerror=function(e){n(A(vr)),e.preventDefault(),e.stopPropagation()},u.onsuccess=function(){i={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,i)})},e._removeLocal=function(e,t,n){\"function\"==typeof t&&(n=t,t={});var r=t.ctx;if(!r){var o=mn(p,[Go],\"readwrite\");if(o.error)return n(o.error);r=o.txn,r.oncomplete=function(){i&&n(null,i)}}var i,a=e._id,s=r.objectStore(Go),u=s.get(a);u.onerror=fn(n),u.onsuccess=function(r){var o=r.target.result;o&&o._rev===e._rev?(s[\"delete\"](a),i={ok:!0,id:a,rev:\"0-0\"},t.ctx&&n(null,i)):n(A(pr))}},e._destroy=function(e,t){Yo.removeAllListeners(h);var n=Zo.get(h);n&&n.result&&(n.result.close(),$o[\"delete\"](h));var r=indexedDB.deleteDatabase(h);r.onsuccess=function(){Zo[\"delete\"](h),ie()&&h in localStorage&&delete localStorage[h],t(null,{ok:!0})},r.onerror=fn(t)};var y=$o.get(h);if(y)return p=y.idb,e._meta=y.global,void n.nextTick(function(){r(null,e)});var m;m=t.storage?Tn(h,t.storage):indexedDB.open(h,Po),Zo.set(h,m),m.onupgradeneeded=function(e){function t(){var e=c[l-1];l++,e&&e(r,t)}var n=e.target.result;if(e.oldVersion<1)return o(n);var r=e.currentTarget.transaction;e.oldVersion<3&&a(n),e.oldVersion<4&&u(n);var c=[i,s,f,d],l=e.oldVersion;t()},m.onsuccess=function(t){p=t.target.result,p.onversionchange=function(){p.close(),$o[\"delete\"](h)},p.onabort=function(e){console.error(\"Database has a global failure\",e.target.error),p.close(),$o[\"delete\"](h)};var n=p.transaction([Vo,Xo,Ho],\"readwrite\"),o=n.objectStore(Vo).get(Vo),i=null,a=null,s=null;o.onsuccess=function(t){var o=function(){null!==i&&null!==a&&null!==s&&(e._meta={name:h,instanceId:s,blobSupport:i,docCount:a},$o.set(h,{idb:p,global:e._meta}),r(null,e))},u=t.target.result||{id:Vo};h+\"_id\"in u?(s=u[h+\"_id\"],o()):(s=D(),u[h+\"_id\"]=s,n.objectStore(Vo).put(u).onsuccess=function(){o()}),Qo||(Qo=Sn(n)),Qo.then(function(e){i=e,o()});var c=n.objectStore(Ho).index(\"deletedOrLocal\");c.count(IDBKeyRange.only(\"0\")).onsuccess=function(e){a=e.target.result,o()}}},m.onerror=function(){var e=\"Failed to open indexedDB, are you in private browsing mode?\";console.error(e),r(A(Tr,e))}}function Tn(e,t){try{return indexedDB.open(e,{version:Po,storage:t})}catch(n){return indexedDB.open(e,Po)}}function On(e){return decodeURIComponent(window.escape(e))}function jn(e){return 65>e?e-48:e-55}function Cn(e,t,n){for(var r=\"\";n>t;)r+=String.fromCharCode(jn(e.charCodeAt(t++))<<4|jn(e.charCodeAt(t++)));return r}function In(e,t,n){for(var r=\"\";n>t;)r+=String.fromCharCode(jn(e.charCodeAt(t+2))<<12|jn(e.charCodeAt(t+3))<<8|jn(e.charCodeAt(t))<<4|jn(e.charCodeAt(t+1))),t+=4;return r}function Ln(e,t){return\"UTF-8\"===t?On(Cn(e,0,e.length)):In(e,0,e.length)}function Rn(e){return\"'\"+e+\"'\"}function Dn(){return\"undefined\"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):\"undefined\"!=typeof openDatabase?function(e){return openDatabase(e.name,e.version,e.description,e.size)}:void 0}function Nn(){return\"undefined\"!=typeof openDatabase||\"undefined\"!=typeof SQLitePlugin}function Bn(e){return e.replace(/\\u0002/g,\"\u0002\u0002\").replace(/\\u0001/g,\"\u0001\u0002\").replace(/\\u0000/g,\"\u0001\u0001\")}function Fn(e){return e.replace(/\\u0001\\u0001/g,\"\\x00\").replace(/\\u0001\\u0002/g,\"\u0001\").replace(/\\u0002\\u0002/g,\"\u0002\")}function Mn(e){return delete e._id,delete e._rev,JSON.stringify(e)}function Un(e,t,n){return e=JSON.parse(e),e._id=t,e._rev=n,e}function Pn(e){for(var t=\"(\";e--;)t+=\"?\",e&&(t+=\",\");return t+\")\"}function Hn(e,t,n,r,o){return\"SELECT \"+e+\" FROM \"+(\"string\"==typeof t?t:t.join(\" JOIN \"))+(n?\" ON \"+n:\"\")+(r?\" WHERE \"+(\"string\"==typeof r?r:r.join(\" AND \")):\"\")+(o?\" ORDER BY \"+o:\"\")}function Kn(e,t,n){function r(){++i===e.length&&o()}function o(){if(a.length){var e=\"SELECT DISTINCT digest AS digest FROM \"+ai+\" WHERE seq IN \"+Pn(a.length);n.executeSql(e,a,function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).digest);if(n.length){var o=\"DELETE FROM \"+ai+\" WHERE seq IN (\"+a.map(function(){return\"?\"}).join(\",\")+\")\";e.executeSql(o,a,function(e){var t=\"SELECT digest FROM \"+ai+\" WHERE digest IN (\"+n.map(function(){return\"?\"}).join(\",\")+\")\";e.executeSql(t,n,function(e,t){for(var r=new nr.Set,o=0;o<t.rows.length;o++)r.add(t.rows.item(o).digest);n.forEach(function(t){r.has(t)||(e.executeSql(\"DELETE FROM \"+ai+\" WHERE digest=?\",[t]),e.executeSql(\"DELETE FROM \"+ri+\" WHERE digest=?\",[t]))})})})}})}}if(e.length){var i=0,a=[];e.forEach(function(e){var o=\"SELECT seq FROM \"+ni+\" WHERE doc_id=? AND rev=?\";n.executeSql(o,[t,e],function(e,t){if(!t.rows.length)return r();var n=t.rows.item(0).seq;a.push(n),e.executeSql(\"DELETE FROM \"+ni+\" WHERE seq=?\",[n],r)})})}}function Wn(e){return function(t){console.error(\"WebSQL threw an error\",t);var n=t&&t.constructor.toString().match(/function ([^\\(]+)/),r=n&&n[1]||t.type,o=t.target||t.message;e(A(Or,o,r))}}function Jn(e){if(\"size\"in e)return 1e6*e.size;var t=\"undefined\"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5e6:1}function Vn(e,t){try{return{db:e(t)}}catch(n){return{error:n}}}function Gn(e){var t=si.get(e.name);if(!t){var n=Dn();t=Vn(n,e),si.set(e.name,t),t.db&&(t.db._sqlitePlugin=\"undefined\"!=typeof sqlitePlugin)}return t}function Xn(e,t,n,r,o,i,a){function s(){return g?a(g):(i.notify(r._name),r._docCount=-1,void a(null,b))}function u(e,t){var n=\"SELECT count(*) as cnt FROM \"+ri+\" WHERE digest=?\";m.executeSql(n,[e],function(n,r){if(0===r.rows.item(0).cnt){var o=A(Rr,\"unknown stub attachment with digest \"+e);t(o)}else t()})}function c(e){function t(){++o===n.length&&e(r)}var n=[];if(y.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var r=e.data._attachments[t];r.stub&&n.push(r.digest)})}),!n.length)return e();var r,o=0;n.forEach(function(e){u(e,function(e){e&&!r&&(r=e),t()})})}function f(e,t,n,o,i,a,s,u){function c(){function t(e,t){function r(){return++i===a.length&&t(),!1}function o(t){var o=\"INSERT INTO \"+ai+\" (digest, seq) VALUES (?,?)\",i=[n._attachments[t].digest,e];m.executeSql(o,i,r,r)}var i=0,a=Object.keys(n._attachments||{});if(!a.length)return t();for(var s=0;s<a.length;s++)o(a[s])}var n=e.data,r=o?1:0,i=n._id,a=n._rev,s=Mn(n),u=\"INSERT INTO \"+ni+\" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);\",c=[i,a,s,r];m.executeSql(u,c,function(e,n){var r=n.insertId;t(r,function(){d(e,r)})},function(){var e=Hn(\"seq\",ni,null,\"doc_id=? AND rev=?\");return m.executeSql(e,[i,a],function(e,n){var o=n.rows.item(0).seq,u=\"UPDATE \"+ni+\" SET json=?, deleted=? WHERE doc_id=? AND rev=?;\",c=[s,r,i,a];e.executeSql(u,c,function(e){t(o,function(){d(e,o)})})}),!1})}function f(e){p||(e?(p=e,u(p)):v===y.length&&c())}function l(e){v++,f(e)}function d(n,o){var a=e.metadata.id;i&&r.auto_compaction?Kn(rn(e.metadata),a,n):e.stemmedRevs.length&&Kn(e.stemmedRevs,a,n),e.metadata.seq=o,delete e.metadata.rev;var c=i?\"UPDATE \"+ti+\" SET json=?, max_seq=?, winningseq=(SELECT seq FROM \"+ni+\" WHERE doc_id=\"+ti+\".id AND rev=?) WHERE id=?\":\"INSERT INTO \"+ti+\" (id, winningseq, max_seq, json) VALUES (?,?,?,?);\",f=sn(e.metadata),l=i?[f,o,t,a]:[a,o,o,f];n.executeSql(c,l,function(){b[s]={ok:!0,id:e.metadata.id,rev:t},w.set(a,e.metadata),u()})}var p=null,v=0;e.data._id=e.metadata.id,e.data._rev=e.metadata.rev;var y=Object.keys(e.data._attachments||{});o&&(e.data._deleted=!0),y.forEach(function(t){var n=e.data._attachments[t];if(n.stub)v++,f();else{var r=n.data;delete n.data;var o=n.digest;h(o,r,l)}}),y.length||c()}function l(){nn(e.revs_limit,y,r,w,m,b,f,n)}function d(e){function t(){++n===y.length&&e()}if(!y.length)return e();var n=0;y.forEach(function(e){if(e._id&&I(e._id))return t();var n=e.metadata.id;m.executeSql(\"SELECT json FROM \"+ti+\" WHERE id = ?\",[n],function(e,r){if(r.rows.length){var o=an(r.rows.item(0).json);w.set(n,o)}t()})})}function h(e,t,n){var r=\"SELECT digest FROM \"+ri+\" WHERE digest=?\";m.executeSql(r,[e],function(o,i){return i.rows.length?n():(r=\"INSERT INTO \"+ri+\" (digest, body, escaped) VALUES (?,?,1)\",void o.executeSql(r,[e,Bn(t)],function(){n()},function(){return n(),!1}))})}var p=n.new_edits,v=t.docs,y=v.map(function(e){if(e._id&&I(e._id))return e;var t=U(e,p);return t}),_=y.filter(function(e){return e.error});if(_.length)return a(_[0]);var m,g,b=new Array(y.length),w=new nr.Map;Kt(y,\"binary\",function(e){return e?a(e):void o.transaction(function(e){m=e,c(function(e){e?g=e:d(l)})},Wn(a),s)})}function zn(e,t,n,r,o){function a(){++c===u.length&&o&&o()}function s(e,o){var s=e._attachments[o],u={binary:t.binary,ctx:r};n._getAttachment(s,u,function(t,n){e._attachments[o]=$n.extend(i(s,[\"digest\",\"content_type\"]),{data:n}),a()})}var u=Object.keys(e._attachments||{});if(!u.length)return o&&o();var c=0;u.forEach(function(n){t.attachments&&t.include_docs?s(e,n):(e._attachments[n].stub=!0,a())})}function Qn(e,t){function n(){ie()&&(window.localStorage[\"_pouch__websqldb_\"+g._name]=!0),t(null,g)}function r(e,t){e.executeSql(di),e.executeSql(\"ALTER TABLE \"+ni+\" ADD COLUMN deleted TINYINT(1) DEFAULT 0\",[],function(){e.executeSql(fi),e.executeSql(\"ALTER TABLE \"+ti+\" ADD COLUMN local TINYINT(1) DEFAULT 0\",[],function(){e.executeSql(\"CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON \"+ti+\" (local, id)\");var n=\"SELECT \"+ti+\".winningseq AS seq, \"+ti+\".json AS metadata FROM \"+ni+\" JOIN \"+ti+\" ON \"+ni+\".seq = \"+ti+\".winningseq\";e.executeSql(n,[],function(e,n){for(var r=[],o=[],i=0;i<n.rows.length;i++){var a=n.rows.item(i),s=a.seq,u=JSON.parse(a.metadata);_(u)&&r.push(s),I(u.id)&&o.push(u.id)}e.executeSql(\"UPDATE \"+ti+\"SET local = 1 WHERE id IN \"+Pn(o.length),o,function(){e.executeSql(\"UPDATE \"+ni+\" SET deleted = 1 WHERE seq IN \"+Pn(r.length),r,t)})})})})}function o(e,t){var n=\"CREATE TABLE IF NOT EXISTS \"+oi+\" (id UNIQUE, rev, json)\";e.executeSql(n,[],function(){var n=\"SELECT \"+ti+\".id AS id, \"+ni+\".json AS data FROM \"+ni+\" JOIN \"+ti+\" ON \"+ni+\".seq = \"+ti+\".winningseq WHERE local = 1\";e.executeSql(n,[],function(e,n){function r(){if(!o.length)return t(e);var n=o.shift(),i=JSON.parse(n.data)._rev;e.executeSql(\"INSERT INTO \"+oi+\" (id, rev, json) VALUES (?,?,?)\",[n.id,i,n.data],function(e){e.executeSql(\"DELETE FROM \"+ti+\" WHERE id=?\",[n.id],function(e){e.executeSql(\"DELETE FROM \"+ni+\" WHERE seq=?\",[n.seq],function(){r()})})})}for(var o=[],i=0;i<n.rows.length;i++)o.push(n.rows.item(i));r()})})}function i(e,t){function n(n){function r(){if(!n.length)return t(e);var o=n.shift(),i=Ln(o.hex,m),a=i.lastIndexOf(\"::\"),s=i.substring(0,a),u=i.substring(a+2),c=\"UPDATE \"+ni+\" SET doc_id=?, rev=? WHERE doc_id_rev=?\";e.executeSql(c,[s,u,i],function(){r()})}r()}var r=\"ALTER TABLE \"+ni+\" ADD COLUMN doc_id\";e.executeSql(r,[],function(e){var t=\"ALTER TABLE \"+ni+\" ADD COLUMN rev\";e.executeSql(t,[],function(e){e.executeSql(li,[],function(e){var t=\"SELECT hex(doc_id_rev) as hex FROM \"+ni;e.executeSql(t,[],function(e,t){for(var r=[],o=0;o<t.rows.length;o++)r.push(t.rows.item(o));n(r)})})})})}function a(e,t){function n(e){var n=\"SELECT COUNT(*) AS cnt FROM \"+ri;e.executeSql(n,[],function(e,n){function r(){var n=Hn(yi+\", \"+ti+\".id AS id\",[ti,ni],vi,null,ti+\".id \");n+=\" LIMIT \"+a+\" OFFSET \"+i,i+=a,e.executeSql(n,[],function(e,n){function o(e,t){var n=i[e]=i[e]||[];-1===n.indexOf(t)&&n.push(t)}if(!n.rows.length)return t(e);for(var i={},a=0;a<n.rows.length;a++)for(var s=n.rows.item(a),u=Un(s.data,s.id,s.rev),c=Object.keys(u._attachments||{}),f=0;f<c.length;f++){var l=u._attachments[c[f]];o(l.digest,s.seq)}var d=[];if(Object.keys(i).forEach(function(e){var t=i[e];t.forEach(function(t){d.push([e,t])})}),!d.length)return r();var h=0;d.forEach(function(t){var n=\"INSERT INTO \"+ai+\" (digest, seq) VALUES (?,?)\";e.executeSql(n,t,function(){++h===d.length&&r()})})})}var o=n.rows.item(0).cnt;if(!o)return t(e);var i=0,a=10;r()})}var r=\"CREATE TABLE IF NOT EXISTS \"+ai+\" (digest, seq INTEGER)\";e.executeSql(r,[],function(e){e.executeSql(pi,[],function(e){e.executeSql(hi,[],n)})})}function s(e,t){var n=\"ALTER TABLE \"+ri+\" ADD COLUMN escaped TINYINT(1) DEFAULT 0\";e.executeSql(n,[],t)}function u(e,t){var n=\"ALTER TABLE \"+ti+\" ADD COLUMN max_seq INTEGER\";e.executeSql(n,[],function(e){var n=\"UPDATE \"+ti+\" SET max_seq=(SELECT MAX(seq) FROM \"+ni+\" WHERE doc_id=id)\";e.executeSql(n,[],function(e){var n=\"CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON \"+ti+\" (max_seq)\";e.executeSql(n,[],t)})})}function f(e,t){e.executeSql('SELECT HEX(\"a\") AS hex',[],function(e,n){var r=n.rows.item(0).hex;m=2===r.length?\"UTF-8\":\"UTF-16\",t()})}function d(){for(;S.length>0;){var e=S.pop();e(null,b)}}function h(e,t){if(0===t){var n=\"CREATE TABLE IF NOT EXISTS \"+ii+\" (dbid, db_version INTEGER)\",c=\"CREATE TABLE IF NOT EXISTS \"+ri+\" (digest UNIQUE, escaped TINYINT(1), body BLOB)\",f=\"CREATE TABLE IF NOT EXISTS \"+ai+\" (digest, seq INTEGER)\",l=\"CREATE TABLE IF NOT EXISTS \"+ti+\" (id unique, json, winningseq, max_seq INTEGER UNIQUE)\",h=\"CREATE TABLE IF NOT EXISTS \"+ni+\" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)\",p=\"CREATE TABLE IF NOT EXISTS \"+oi+\" (id UNIQUE, rev, json)\";e.executeSql(c),e.executeSql(p),e.executeSql(f,[],function(){e.executeSql(hi),e.executeSql(pi)}),e.executeSql(l,[],function(){e.executeSql(di),e.executeSql(h,[],function(){e.executeSql(fi),e.executeSql(li),e.executeSql(n,[],function(){var t=\"INSERT INTO \"+ii+\" (db_version, dbid) VALUES (?,?)\";b=D();var n=[ei,b];e.executeSql(t,n,function(){d()})})})})}else{var v=function(){var n=ei>t;n&&e.executeSql(\"UPDATE \"+ii+\" SET db_version = \"+ei);var r=\"SELECT dbid FROM \"+ii;e.executeSql(r,[],function(e,t){b=t.rows.item(0).dbid,d()})},y=[r,o,i,a,s,u,v],_=t,m=function(e){y[_-1](e,m),_++};m(e)}}function p(){x.transaction(function(e){f(e,function(){v(e)})},Wn(t),n)}function v(e){var t=\"SELECT sql FROM sqlite_master WHERE tbl_name = \"+ii;e.executeSql(t,[],function(e,t){t.rows.length?/db_version/.test(t.rows.item(0).sql)?e.executeSql(\"SELECT db_version FROM \"+ii,[],function(e,t){var n=t.rows.item(0).db_version;h(e,n)}):e.executeSql(\"ALTER TABLE \"+ii+\" ADD COLUMN db_version INTEGER\",[],function(){h(e,1)}):h(e,0)})}function y(e,t){if(-1!==g._docCount)return t(g._docCount);var n=Hn(\"COUNT(\"+ti+\".id) AS 'num'\",[ti,ni],vi,ni+\".deleted=0\");e.executeSql(n,[],function(e,n){g._docCount=n.rows.item(0).num,t(g._docCount)})}var m,g=this,b=null,w=Jn(e),S=[];g._docCount=-1,g._name=e.name;var k=Gn({name:g._name,version:ci,description:g._name,size:w,location:e.location,createFromLocation:e.createFromLocation,androidDatabaseImplementation:e.androidDatabaseImplementation});if(k.error)return Wn(t)(k.error);var x=k.db;\"function\"!=typeof x.readTransaction&&(x.readTransaction=x.transaction),p(),g.type=function(){return\"websql\"},g._id=l(function(e){e(null,b)}),g._info=function(e){x.readTransaction(function(t){y(t,function(n){var r=\"SELECT MAX(seq) AS seq FROM \"+ni;t.executeSql(r,[],function(t,r){var o=r.rows.item(0).seq||0;e(null,{doc_count:n,update_seq:o,sqlite_plugin:x._sqlitePlugin,websql_encoding:m})})})},Wn(e))},g._bulkDocs=function(t,n,r){Xn(e,t,n,g,x,ui,r)},g._get=function(e,t,n){function r(){n(a,{doc:o,metadata:i,ctx:s})}var o,i,a,s=t.ctx;if(!s)return x.readTransaction(function(r){g._get(e,$n.extend({ctx:r},t),n)});var u,c;t.rev?(u=Hn(yi,[ti,ni],ti+\".id=\"+ni+\".doc_id\",[ni+\".doc_id=?\",ni+\".rev=?\"]),c=[e,t.rev]):(u=Hn(yi,[ti,ni],vi,ti+\".id=?\"),c=[e]),s.executeSql(u,c,function(e,n){if(!n.rows.length)return a=A(pr,\"missing\"),r();var s=n.rows.item(0);return i=an(s.metadata),s.deleted&&!t.rev?(a=A(pr,\"deleted\"),r()):(o=Un(s.data,i.id,s.rev),void r())})},g._allDocs=function(e,t){var n,r=[],o=\"startkey\"in e?e.startkey:!1,i=\"endkey\"in e?e.endkey:!1,a=\"key\"in e?e.key:!1,s=\"descending\"in e?e.descending:!1,u=\"limit\"in e?e.limit:-1,c=\"skip\"in e?e.skip:0,f=e.inclusive_end!==!1,l=[],d=[];if(a!==!1)d.push(ti+\".id = ?\"),l.push(a);else if(o!==!1||i!==!1){if(o!==!1&&(d.push(ti+\".id \"+(s?\"<=\":\">=\")+\" ?\"),l.push(o)),i!==!1){var h=s?\">\":\"<\";f&&(h+=\"=\"),d.push(ti+\".id \"+h+\" ?\"),l.push(i)}a!==!1&&(d.push(ti+\".id = ?\"),l.push(a))}\"ok\"!==e.deleted&&d.push(ni+\".deleted = 0\"),x.readTransaction(function(t){y(t,function(o){if(n=o,0!==u){var i=Hn(yi,[ti,ni],vi,d,ti+\".id \"+(s?\"DESC\":\"ASC\"));i+=\" LIMIT \"+u+\" OFFSET \"+c,t.executeSql(i,l,function(t,n){for(var o=0,i=n.rows.length;i>o;o++){var a=n.rows.item(o),s=an(a.metadata),u=s.id,c=Un(a.data,u,a.rev),f=c._rev,l={id:u,key:u,value:{rev:f}};if(e.include_docs&&(l.doc=c,l.doc._rev=f,e.conflicts&&(l.doc._conflicts=q(s)),zn(l.doc,e,g,t)),a.deleted){if(\"ok\"!==e.deleted)continue;l.value.deleted=!0,l.doc=null}r.push(l)}})}})},Wn(t),function(){t(null,{total_rows:n,offset:e.skip,rows:r})})},g._changes=function(e){function t(){var t=ti+\".json AS metadata, \"+ti+\".max_seq AS maxSeq, \"+ni+\".json AS winningDoc, \"+ni+\".rev AS winningRev \",n=ti+\" JOIN \"+ni,u=ti+\".id=\"+ni+\".doc_id AND \"+ti+\".winningseq=\"+ni+\".seq\",c=[\"maxSeq > ?\"],f=[e.since];e.doc_ids&&(c.push(ti+\".id IN \"+Pn(e.doc_ids.length)),f=f.concat(e.doc_ids));var l=\"maxSeq \"+(r?\"DESC\":\"ASC\"),d=Hn(t,n,u,c,l),h=we(e);e.view||e.filter||(d+=\" LIMIT \"+o);var p=e.since||0;x.readTransaction(function(t){t.executeSql(d,f,function(t,n){function r(t){return function(){e.onChange(t)}}for(var u=0,c=n.rows.length;c>u;u++){var f=n.rows.item(u),l=an(f.metadata);p=f.maxSeq;var d=Un(f.winningDoc,l.id,f.winningRev),v=e.processChange(d,l,e);v.seq=f.maxSeq;var y=h(v);if(\"object\"==typeof y)return e.complete(y);if(y&&(s++,i&&a.push(v),e.attachments&&e.include_docs?zn(d,e,g,t,r(v)):r(v)()),s===o)break}})},Wn(e.complete),function(){e.continuous||e.complete(null,{results:a,last_seq:p})})}if(e=c(e),e.continuous){var n=g._name+\":\"+D();return ui.addListener(g._name,n,g,e),ui.notify(g._name),{cancel:function(){ui.removeListener(g._name,n)}}}var r=e.descending;e.since=e.since&&!r?e.since:0;var o=\"limit\"in e?e.limit:-1;0===o&&(o=1);var i;i=\"return_docs\"in e?e.return_docs:\"returnDocs\"in e?e.returnDocs:!0;var a=[],s=0;t()},g._close=function(e){e()},g._getAttachment=function(e,t,n){var r,o=t.ctx,i=e.digest,a=e.content_type,s=\"SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM \"+ri+\" WHERE digest=?\";o.executeSql(s,[i],function(e,o){var i=o.rows.item(0),s=i.escaped?Fn(i.body):Ln(i.body,m);r=t.binary?ge(s,a):$r(s),n(null,r)})},g._getRevisionTree=function(e,t){x.readTransaction(function(n){var r=\"SELECT json AS metadata FROM \"+ti+\" WHERE id = ?\";n.executeSql(r,[e],function(e,n){if(n.rows.length){var r=an(n.rows.item(0).metadata);t(null,r.rev_tree)}else t(A(pr))})})},g._doCompaction=function(e,t,n){return t.length?void x.transaction(function(n){var r=\"SELECT json AS metadata FROM \"+ti+\" WHERE id = ?\";n.executeSql(r,[e],function(n,r){var o=an(r.rows.item(0).metadata);E(o.rev_tree,function(e,n,r,o,i){var a=n+\"-\"+r;-1!==t.indexOf(a)&&(i.status=\"missing\")});var i=\"UPDATE \"+ti+\" SET json = ? WHERE id = ?\";n.executeSql(i,[sn(o),e])}),Kn(t,e,n)},Wn(n),function(){n()}):n()},g._getLocal=function(e,t){x.readTransaction(function(n){var r=\"SELECT json, rev FROM \"+oi+\" WHERE id=?\";n.executeSql(r,[e],function(n,r){if(r.rows.length){var o=r.rows.item(0),i=Un(o.json,e,o.rev);t(null,i)}else t(A(pr))})})},g._putLocal=function(e,t,n){function r(e){var r,c;i?(r=\"UPDATE \"+oi+\" SET rev=?, json=? WHERE id=? AND rev=?\",c=[o,u,a,i]):(r=\"INSERT INTO \"+oi+\" (id, rev, json) VALUES (?,?,?)\",c=[a,o,u]),e.executeSql(r,c,function(e,r){r.rowsAffected?(s={ok:!0,id:a,rev:o},t.ctx&&n(null,s)):n(A(vr))},function(){return n(A(vr)),!1})}\"function\"==typeof t&&(n=t,t={}),delete e._revisions;var o,i=e._rev,a=e._id;o=i?e._rev=\"0-\"+(parseInt(i.split(\"-\")[1],10)+1):e._rev=\"0-1\";var s,u=Mn(e);t.ctx?r(t.ctx):x.transaction(r,Wn(n),function(){s&&n(null,s)})},g._removeLocal=function(e,t,n){function r(r){var i=\"DELETE FROM \"+oi+\" WHERE id=? AND rev=?\",a=[e._id,e._rev];r.executeSql(i,a,function(r,i){return i.rowsAffected?(o={ok:!0,id:e._id,rev:\"0-0\"},void(t.ctx&&n(null,o))):n(A(pr))})}\"function\"==typeof t&&(n=t,t={});var o;t.ctx?r(t.ctx):x.transaction(r,Wn(n),function(){o&&n(null,o)})},g._destroy=function(e,t){ui.removeAllListeners(g._name),x.transaction(function(e){var t=[ti,ni,ri,ii,oi,ai];t.forEach(function(t){e.executeSql(\"DROP TABLE IF EXISTS \"+t,[])})},Wn(t),function(){ie()&&(delete window.localStorage[\"_pouch__websqldb_\"+g._name],delete window.localStorage[g._name]),t(null,{ok:!0})})}}var $n=e(7),Yn=o($n),Zn=o(e(2)),er=o(e(6)),tr=o(e(8)),nr=e(12),rr=o(e(1)),or=e(4),ir=o(e(14)),ar=e(10),sr=o(ar),ur=o(e(15)),cr=o(e(16)),fr=\"function\"==typeof Promise?Promise:tr,lr=Zn(\"pouchdb:api\");er(x,Error),x.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var dr=new x({status:401,error:\"unauthorized\",reason:\"Name or password is incorrect.\"}),hr=new x({status:400,error:\"bad_request\",reason:\"Missing JSON list of 'docs'\"}),pr=new x({status:404,error:\"not_found\",reason:\"missing\"}),vr=new x({status:409,error:\"conflict\",reason:\"Document update conflict\"}),yr=new x({status:400,error:\"invalid_id\",reason:\"_id field must contain a string\"}),_r=new x({status:412,error:\"missing_id\",reason:\"_id is required for puts\"}),mr=new x({status:400,error:\"bad_request\",reason:\"Only reserved document ids may start with underscore.\"}),gr=new x({status:412,error:\"precondition_failed\",reason:\"Database not open\"}),br=new x({status:500,error:\"unknown_error\",reason:\"Database encountered an unknown error\"}),wr=new x({status:500,error:\"badarg\",reason:\"Some query argument is invalid\"}),Er=new x({status:400,error:\"invalid_request\",reason:\"Request was invalid\"}),Sr=new x({status:400,error:\"query_parse_error\",reason:\"Some query parameter is invalid\"}),kr=new x({status:500,error:\"doc_validation\",reason:\"Bad special document member\"}),qr=new x({status:400,error:\"bad_request\",reason:\"Something wrong with the request\"}),xr=new x({status:400,error:\"bad_request\",reason:\"Document must be a JSON object\"}),Ar=new x({status:404,error:\"not_found\",reason:\"Database not found\"}),Tr=new x({status:500,error:\"indexed_db_went_bad\",reason:\"unknown\"}),Or=new x({status:500,error:\"web_sql_went_bad\",reason:\"unknown\"}),jr=new x({status:500,error:\"levelDB_went_went_bad\",reason:\"unknown\"}),Cr=new x({status:403,error:\"forbidden\",reason:\"Forbidden by design doc validate_doc_update function\"}),Ir=new x({status:400,error:\"bad_request\",reason:\"Invalid rev format\"}),Lr=new x({status:412,error:\"file_exists\",reason:\"The database could not be created, the file already exists.\"}),Rr=new x({status:412,error:\"missing_stub\"}),Dr=new x({status:413,error:\"invalid_url\",reason:\"Provided URL is invalid\"}),Nr={UNAUTHORIZED:dr,MISSING_BULK_DOCS:hr,MISSING_DOC:pr,REV_CONFLICT:vr,INVALID_ID:yr,MISSING_ID:_r,RESERVED_ID:mr,NOT_OPEN:gr,UNKNOWN_ERROR:br,BAD_ARG:wr,INVALID_REQUEST:Er,QUERY_PARSE_ERROR:Sr,DOC_VALIDATION:kr,BAD_REQUEST:qr,NOT_AN_OBJECT:xr,DB_MISSING:Ar,WSQ_ERROR:Or,LDB_ERROR:jr,FORBIDDEN:Cr,INVALID_REV:Ir,FILE_EXISTS:Lr,MISSING_STUB:Rr,IDB_ERROR:Tr,INVALID_URL:Dr},Br=function(e,t,n){var r=Object.keys(Nr).filter(function(n){var r=Nr[n];return\"function\"!=typeof r&&r[e]===t}),o=n&&r.filter(function(e){var t=Nr[e];return t.message===n})[0]||r[0];return o?Nr[o]:null};er(O,or.EventEmitter),O.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit(\"cancel\")},O.prototype.doChanges=function(e){var t=this,n=e.complete;if(e=c(e),\"live\"in e&&!(\"continuous\"in e)&&(e.continuous=e.live),e.processChange=j,\"latest\"===e.since&&(e.since=\"now\"),e.since||(e.since=0),\"now\"===e.since)return void this.db.info().then(function(r){return t.isCancelled?void n(null,{status:\"cancelled\"}):(e.since=r.update_seq,void t.doChanges(e))},n);if(e.continuous&&\"now\"!==e.since&&this.db.info().then(function(e){t.startSeq=e.update_seq},function(e){if(\"idbNull\"!==e.id)throw e}),e.filter&&\"string\"==typeof e.filter&&(\"_view\"===e.filter?e.view=w(e.view):e.filter=w(e.filter),\"http\"!==this.db.type()&&!e.doc_ids))return this.filterChanges(e);\"descending\"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=n;var r=this.db._changes(e);if(r&&\"function\"==typeof r.cancel){var o=t.cancel;t.cancel=rr(function(e){r.cancel(),o.apply(this,e)})}},O.prototype.filterChanges=function(e){var t=this,n=e.complete;if(\"_view\"===e.filter){if(!e.view||\"string\"!=typeof e.view){var r=A(qr,\"`view` filter parameter not found or invalid.\");return n(r)}var o=b(e.view);this.db.getView(o[0],o[1],function(r,o){return t.isCancelled?n(null,{status:\"cancelled\"}):r?n(T(r)):o.map?(e.filter=g(o.map),void t.doChanges(e)):n(A(pr))})}else{var i=b(e.filter);if(!i)return t.doChanges(e);this.db.getFilter(i[0],i[1],function(r,o){return t.isCancelled?n(null,{status:\"cancelled\"}):r?n(T(r)):(e.filter=m(o),void t.doChanges(e))})}};var Fr=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\".split(\"\"),Mr=N([\"_id\",\"_rev\",\"_attachments\",\"_deleted\",\"_revisions\",\"_revs_info\",\"_conflicts\",\"_deleted_conflicts\",\"_local_seq\",\"_rev_tree\",\"_replication_id\",\"_replication_state\",\"_replication_state_time\",\"_replication_state_reason\",\"_replication_stats\",\"_removed\"]),Ur=N([\"_attachments\",\"_replication_id\",\"_replication_state\",\"_replication_state_time\",\"_replication_state_reason\",\"_replication_stats\"]);er(Z,or.EventEmitter),Z.prototype.post=d(\"post\",function(e,t,n){return\"function\"==typeof t&&(n=t,t={}),\"object\"!=typeof e||Array.isArray(e)?n(A(xr)):void this.bulkDocs({docs:[e]},t,K(n))}),Z.prototype.put=d(\"put\",rr(function(e){var t,n,r,o,i=e.shift(),a=\"_id\"in i;if(\"object\"!=typeof i||Array.isArray(i))return(o=e.pop())(A(xr));for(;;)if(t=e.shift(),n=typeof t,\"string\"!==n||a?\"string\"!==n||!a||\"_rev\"in i?\"object\"===n?r=t:\"function\"===n&&(o=t):i._rev=t:(i._id=t,a=!0),!e.length)break;return r=r||{},B(i._id),I(i._id)&&\"function\"==typeof this._putLocal?i._deleted?this._removeLocal(i,o):this._putLocal(i,o):void this.bulkDocs({docs:[i]},r,K(o))})),Z.prototype.putAttachment=d(\"putAttachment\",function(e,t,n,r,o){function i(e){return e._attachments=e._attachments||{},e._attachments[t]={content_type:o,data:r},a.put(e)}var a=this;return\"function\"==typeof o&&(o=r,r=n,n=null),\"undefined\"==typeof o&&(o=r,r=n,n=null),a.get(e).then(function(e){if(e._rev!==n)throw A(vr);return i(e)},function(t){if(t.reason===pr.message)return i({_id:e});throw t})}),Z.prototype.removeAttachment=d(\"removeAttachment\",function(e,t,n,r){var o=this;o.get(e,function(e,i){return e?void r(e):i._rev!==n?void r(A(vr)):i._attachments?(delete i._attachments[t],0===Object.keys(i._attachments).length&&delete i._attachments,void o.put(i,r)):r()})}),Z.prototype.remove=d(\"remove\",function(e,t,n,r){var o;\"string\"==typeof t?(o={_id:e,_rev:t},\"function\"==typeof n&&(r=n,n={})):(o=e,\"function\"==typeof t?(r=t,n={}):(r=n,n=t)),n=n||{},n.was_delete=!0;var i={_id:o._id,_rev:o._rev||n.rev};return i._deleted=!0,I(i._id)&&\"function\"==typeof this._removeLocal?this._removeLocal(o,r):void this.bulkDocs({docs:[i]},n,K(r))}),Z.prototype.revsDiff=d(\"revsDiff\",function(e,t,n){function r(e,t){s.has(e)||s.set(e,{missing:[]}),s.get(e).missing.push(t)}function o(t,n){var o=e[t].slice(0);E(n,function(e,n,i,a,s){var u=n+\"-\"+i,c=o.indexOf(u);-1!==c&&(o.splice(c,1),\"available\"!==s.status&&r(t,u))}),o.forEach(function(e){r(t,e)})}\"function\"==typeof t&&(n=t,t={});var i=Object.keys(e);if(!i.length)return n(null,{});var a=0,s=new nr.Map;i.map(function(t){this._getRevisionTree(t,function(r,u){if(r&&404===r.status&&\"missing\"===r.message)s.set(t,{missing:e[t]});else{if(r)return n(r);o(t,u)}if(++a===i.length){var c={};return s.forEach(function(e,t){c[t]=e}),n(null,c)}})},this)}),Z.prototype.bulkGet=d(\"bulkGet\",function(e,t){C(this,e,t)}),Z.prototype.compactDocument=d(\"compactDocument\",function(e,t,n){var r=this;this._getRevisionTree(e,function(o,i){if(o)return n(o);var a=V(i),s=[],u=[];Object.keys(a).forEach(function(e){a[e]>t&&s.push(e)}),E(i,function(e,t,n,r,o){var i=t+\"-\"+n;\"available\"===o.status&&-1!==s.indexOf(i)&&u.push(i)}),r._doCompaction(e,u,n)})}),Z.prototype.compact=d(\"compact\",function(e,t){\"function\"==typeof e&&(t=e,e={});var n=this;e=e||{},n._compactionQueue=n._compactionQueue||[],n._compactionQueue.push({opts:e,callback:t}),1===n._compactionQueue.length&&X(n)}),Z.prototype._compact=function(e,t){function n(e){a.push(o.compactDocument(e.id,0))}function r(e){var n=e.last_seq;fr.all(a).then(function(){return h(o,\"_local/compaction\",function(e){return!e.last_seq||e.last_seq<n?(e.last_seq=n,e):!1})}).then(function(){t(null,{ok:!0})})[\"catch\"](t)}var o=this,i={return_docs:!1,last_seq:e.last_seq||0},a=[];o.changes(i).on(\"change\",n).on(\"complete\",r).on(\"error\",t)},Z.prototype.get=d(\"get\",function(e,t,n){function r(){var r=[],a=o.length;return a?void o.forEach(function(o){i.get(e,{rev:o,revs:t.revs,attachments:t.attachments},function(e,t){e?r.push({missing:o}):r.push({ok:t}),a--,a||n(null,r)})}):n(null,r)}if(\"function\"==typeof t&&(n=t,t={}),\"string\"!=typeof e)return n(A(yr));if(I(e)&&\"function\"==typeof this._getLocal)return this._getLocal(e,n);var o=[],i=this;if(!t.open_revs)return this._get(e,t,function(e,r){if(e)return n(e);var o=r.doc,a=r.metadata,s=r.ctx;if(t.conflicts){var u=q(a);u.length&&(o._conflicts=u)}if(_(a,o._rev)&&(o._deleted=!0),t.revs||t.revs_info){var c=L(a.rev_tree),f=H(c,function(e){return-1!==e.ids.map(function(e){return e.id}).indexOf(o._rev.split(\"-\")[1])}),l=f.ids.map(function(e){return e.id}).indexOf(o._rev.split(\"-\")[1])+1,d=f.ids.length-l;if(f.ids.splice(l,d),f.ids.reverse(),t.revs&&(o._revisions={start:f.pos+f.ids.length-1,ids:f.ids.map(function(e){return e.id})}),t.revs_info){var h=f.pos+f.ids.length;o._revs_info=f.ids.map(function(e){return h--,{rev:h+\"-\"+e.id,status:e.opts.status}})}}if(t.attachments&&o._attachments){var p=o._attachments,v=Object.keys(p).length;if(0===v)return n(null,o);Object.keys(p).forEach(function(e){this._getAttachment(p[e],{binary:t.binary,ctx:s},function(t,r){var i=o._attachments[e];i.data=r,delete i.stub,delete i.length,--v||n(null,o)})},i)}else{if(o._attachments)for(var y in o._attachments)o._attachments.hasOwnProperty(y)&&(o._attachments[y].stub=!0);n(null,o)}});if(\"all\"===t.open_revs)this._getRevisionTree(e,function(e,t){return e?n(e):(o=k(t).map(function(e){return e.rev}),void r())});else{if(!Array.isArray(t.open_revs))return n(A(br,\"function_clause\"));o=t.open_revs;for(var a=0;a<o.length;a++){var s=o[a];if(\"string\"!=typeof s||!/^\\d+-/.test(s))return n(A(Ir))}r()}}),Z.prototype.getView=d(\"getView\",function(e,t,n){Y(this,e,\"views\",t,n)}),Z.prototype.getFilter=d(\"getFilter\",function(e,t,n){Y(this,e,\"filters\",t,n)}),Z.prototype.getAttachment=d(\"getAttachment\",function(e,t,n,r){var o=this;n instanceof Function&&(r=n,n={}),this._get(e,n,function(e,i){return e?r(e):i.doc._attachments&&i.doc._attachments[t]?(n.ctx=i.ctx,n.binary=!0,o._getAttachment(i.doc._attachments[t],n,r),void 0):r(A(pr))})}),Z.prototype.allDocs=d(\"allDocs\",function(e,t){if(\"function\"==typeof e&&(t=e,e={}),e.skip=\"undefined\"!=typeof e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),\"keys\"in e){if(!Array.isArray(e.keys))return t(new TypeError(\"options.keys must be an array\"));var n=[\"startkey\",\"endkey\",\"key\"].filter(function(t){return t in e})[0];if(n)return void t(A(Sr,\"Query parameter `\"+n+\"` is not compatible with multi-get\"));if(\"http\"!==this.type())return G(this,e,t);\n}return this._allDocs(e,t)}),Z.prototype.changes=function(e,t){return\"function\"==typeof e&&(t=e,e={}),new O(this,e,t)},Z.prototype.close=d(\"close\",function(e){return this._closed=!0,this._close(e)}),Z.prototype.info=d(\"info\",function(e){var t=this;this._info(function(n,r){return n?e(n):(r.db_name=r.db_name||t._db_name,r.auto_compaction=!(!t.auto_compaction||\"http\"===t.type()),r.adapter=t.type(),void e(null,r))})}),Z.prototype.id=d(\"id\",function(e){return this._id(e)}),Z.prototype.type=function(){return\"function\"==typeof this._type?this._type():this.adapter},Z.prototype.bulkDocs=d(\"bulkDocs\",function(e,t,n){if(\"function\"==typeof t&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(A(hr));for(var r=0;r<e.docs.length;++r)if(\"object\"!=typeof e.docs[r]||Array.isArray(e.docs[r]))return n(A(xr));var o;return e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(e){o=o||z(e)})}),o?n(A(qr,o)):(\"new_edits\"in t||(\"new_edits\"in e?t.new_edits=e.new_edits:t.new_edits=!0),t.new_edits||\"http\"===this.type()||e.docs.sort(J),W(e.docs),this._bulkDocs(e,t,function(e,r){return e?n(e):(t.new_edits||(r=r.filter(function(e){return e.error})),void n(null,r))}))}),Z.prototype.registerDependentDatabase=d(\"registerDependentDatabase\",function(e,t){function n(t){return t.dependentDbs=t.dependentDbs||{},t.dependentDbs[e]?!1:(t.dependentDbs[e]=!0,t)}var r=new this.constructor(e,this.__opts);h(this,\"_local/_pouch_dependentDbs\",n).then(function(){t(null,{db:r})})[\"catch\"](t)}),Z.prototype.destroy=d(\"destroy\",function(e,t){function n(){r._destroy(e,function(e,n){return e?t(e):(r._destroyed=!0,r.emit(\"destroyed\"),void t(null,n||{ok:!0}))})}\"function\"==typeof e&&(t=e,e={});var r=this,o=\"use_prefix\"in r?r.use_prefix:!0;return\"http\"===r.type()?n():void r.get(\"_local/_pouch_dependentDbs\",function(e,i){if(e)return 404!==e.status?t(e):n();var a=i.dependentDbs,s=r.constructor,u=Object.keys(a).map(function(e){var t=o?e.replace(new RegExp(\"^\"+s.prefix),\"\"):e;return new s(t,r.__opts).destroy()});fr.all(u).then(n,t)})}),ee.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},ee.prototype.fail=function(e){this.failed=e,this.execute()},ee.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},ee.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},er(re,Z),re.debug=Zn;var Pr;if(oe())Pr=!1;else try{localStorage.setItem(\"_pouch_check_localstorage\",1),Pr=!!localStorage.getItem(\"_pouch_check_localstorage\")}catch(Hr){Pr=!1}re.adapters={},re.preferredAdapters=[],re.prefix=\"_pouch_\";var Kr=new or.EventEmitter;ae(re),re.parseAdapter=function(e,t){var n,r,o=e.match(/([a-z\\-]*):\\/\\/(.*)/);if(o){if(e=/http(s?)/.test(o[1])?o[1]+\"://\"+o[2]:o[2],n=o[1],!re.adapters[n].valid())throw\"Invalid adapter\";return{name:e,adapter:o[1]}}var i=\"idb\"in re.adapters&&\"websql\"in re.adapters&&ie()&&localStorage[\"_pouch__websqldb_\"+re.prefix+e];if(t.adapter)r=t.adapter;else if(\"undefined\"!=typeof t&&t.db)r=\"leveldb\";else for(var a=0;a<re.preferredAdapters.length;++a)if(r=re.preferredAdapters[a],r in re.adapters){if(i&&\"idb\"===r){console.log('PouchDB is downgrading \"'+e+'\" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}n=re.adapters[r];var s=n&&\"use_prefix\"in n?n.use_prefix:!0;return{name:s?re.prefix+e:e,adapter:r}},re.adapter=function(e,t,n){t.valid()&&(re.adapters[e]=t,n&&re.preferredAdapters.push(e))},re.plugin=function(e){return Object.keys(e).forEach(function(t){re.prototype[t]=e[t]}),re},re.defaults=function(e){function t(n,r,o){return this instanceof t?(\"function\"!=typeof r&&\"undefined\"!=typeof r||(o=r,r={}),n&&\"object\"==typeof n&&(r=n,n=void 0),r=$n.extend({},e,r),void re.call(this,n,r,o)):new t(n,r,o)}return er(t,re),ae(t),t.preferredAdapters=re.preferredAdapters.slice(),Object.keys(re).forEach(function(e){e in t||(t[e]=re[e])}),t};var Wr=de(),Jr=function(){},Vr=[\"source\",\"protocol\",\"authority\",\"userInfo\",\"user\",\"password\",\"host\",\"port\",\"relative\",\"path\",\"directory\",\"file\",\"query\",\"anchor\"],Gr=\"queryKey\",Xr=/(?:^|&)([^&=]*)=?([^&]*)/g,zr=/^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/,Qr=function(e){return atob(e)},$r=function(e){return btoa(e)},Yr=Yn.extend,Zr={ajax:ye,parseUri:_e,uuid:D,Promise:fr,atob:Qr,btoa:$r,binaryStringToBlobOrBuffer:ge,clone:c,extend:Yr,createError:A},eo=sr.collate,to=1,no=\"pouchdb\",ro=5,oo=0;ke.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},ke.prototype.updateTarget=function(e,t){return Se(this.target,this.id,e,t,this.returnValue)},ke.prototype.updateSource=function(e,t){var n=this;return this.readOnlySource?fr.resolve(!0):Se(this.src,this.id,e,t,this.returnValue)[\"catch\"](function(e){if(Te(e))return n.readOnlySource=!0,!0;throw e})};var io={undefined:function(e,t){return 0===eo(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return qe(t,e).last_seq}};ke.prototype.getCheckpoint=function(){var e=this;return e.target.get(e.id).then(function(t){return e.readOnlySource?fr.resolve(t.last_seq):e.src.get(e.id).then(function(e){if(t.version!==e.version)return oo;var n;return n=t.version?t.version.toString():\"undefined\",n in io?io[n](t,e):oo},function(n){if(404===n.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:oo}).then(function(){return oo},function(n){return Te(n)?(e.readOnlySource=!0,t.last_seq):oo});throw n})})[\"catch\"](function(e){if(404!==e.status)throw e;return oo})};var ao=0,so=r.setImmediate||r.setTimeout,uo=32768,co=l(function(e,t){function n(){var r=s*i,o=r+i;if(s++,a>s)c(u,e,r,o),so(n);else{c(u,e,r,o);var f=u.end(!0),l=Ie(f);t(null,l),u.destroy()}}var r=\"string\"==typeof e,o=r?e.length:e.byteLength,i=Math.min(uo,o),a=Math.ceil(o/i),s=0,u=r?new ur:new ur.ArrayBuffer,c=r?Re:Le;n()});er(Pe,or.EventEmitter),Pe.prototype.cancel=function(){this.cancelled=!0,this.state=\"cancelled\",this.emit(\"cancel\")},Pe.prototype.ready=function(e,t){function n(){o.cancel()}function r(){e.removeListener(\"destroyed\",n),t.removeListener(\"destroyed\",n)}var o=this;o._readyCalled||(o._readyCalled=!0,e.once(\"destroyed\",n),t.once(\"destroyed\",n),o.once(\"complete\",r))};var fo={replicate:Ke,toPouch:He},lo=fo.replicate;er(Je,or.EventEmitter),Je.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var ho=25,po=50,vo={},yo=1800,_o=Zn(\"pouchdb:http\");ot.valid=function(){return!0},it.prototype.add=function(e){return this.promise=this.promise[\"catch\"](function(){}).then(function(){return e()}),this.promise},it.prototype.finish=function(){return this.promise};var mo,go=function(e,t){return t&&e.then(function(e){n.nextTick(function(){t(null,e)})},function(e){n.nextTick(function(){t(e)})}),e},bo=function(e){return rr(function(t){var n=t.pop(),r=e.apply(this,t);return\"function\"==typeof n&&go(r,n),r})},wo=function(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})},Eo=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}},So=function(e){for(var t={},n=0,r=e.length;r>n;n++)t[\"$\"+e[n]]=!0;var o=Object.keys(t),i=new Array(o.length);for(n=0,r=o.length;r>n;n++)i[n]=o[n].substring(1);return i},ko={uniq:So,sequentialize:Eo,fin:wo,callbackify:bo,promisedCallback:go},qo=sr.collate,xo=sr.toIndexableString,Ao=sr.normalizeKey,To=sr.parseIndexableString;mo=\"undefined\"!=typeof console&&\"function\"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var Oo=ko.callbackify,jo=ko.sequentialize,Co=ko.uniq,Io=ko.fin,Lo=ko.promisedCallback,Ro={},Do=new it,No=50,Bo={_sum:function(e,t){return gt(t)},_count:function(e,t){return t.length},_stats:function(e,t){function n(e){for(var t=0,n=0,r=e.length;r>n;n++){var o=e[n];t+=o*o}return t}return{sum:gt(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:n(t)}}},Fo=Oo(function(){var e=this;return e._ddocCache&&delete e._ddocCache,\"http\"===e.type()?Bt(e):\"function\"==typeof e._viewCleanup?At(e):Ft(e)}),Mo=function(e,t,n){\"function\"==typeof t&&(n=t,t={}),t=t?Et(t):{},\"function\"==typeof e&&(e={map:e});var r=this,o=fr.resolve().then(function(){return Mt(r,e,t)});return Lo(o,n),o};er(Ut,Error),er(Pt,Error);var Uo={query:Mo,viewCleanup:Fo},Po=5,Ho=\"document-store\",Ko=\"by-sequence\",Wo=\"attach-store\",Jo=\"attach-seq-store\",Vo=\"meta-store\",Go=\"local-store\",Xo=\"detect-blob-support\",zo={running:!1,queue:[]};er(qn,or.EventEmitter),qn.prototype.addListener=function(e,t,n,r){function o(){function e(){s=!1}if(a._listeners[t]){if(s)return void(s=\"waiting\");s=!0;var u=i(r,[\"style\",\"include_docs\",\"attachments\",\"conflicts\",\"filter\",\"doc_ids\",\"view\",\"since\",\"query_params\",\"binary\"]);n.changes(u).on(\"change\",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on(\"complete\",function(){\"waiting\"===s&&setTimeout(function(){o()},0),s=!1}).on(\"error\",e)}}if(!this._listeners[t]){var a=this,s=!1;this._listeners[t]=o,this.on(e,o)}},qn.prototype.removeListener=function(e,t){t in this._listeners&&or.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},qn.prototype.notifyLocalWindows=function(e){oe()?chrome.storage.local.set({dbName:e}):ie()&&(localStorage[e]=\"a\"===localStorage[e]?\"b\":\"a\")},qn.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var Qo,$o=new nr.Map,Yo=new qn,Zo=new nr.Map;xn.valid=function(){var e=\"undefined\"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return!e&&\"undefined\"!=typeof indexedDB&&\"undefined\"!=typeof IDBKeyRange};var ei=7,ti=Rn(\"document-store\"),ni=Rn(\"by-sequence\"),ri=Rn(\"attach-store\"),oi=Rn(\"local-store\"),ii=Rn(\"metadata-store\"),ai=Rn(\"attach-seq-store\"),si=new nr.Map,ui=new qn,ci=1,fi=\"CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON \"+ni+\" (seq, deleted)\",li=\"CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON \"+ni+\" (doc_id, rev)\",di=\"CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON \"+ti+\" (winningseq)\",hi=\"CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON \"+ai+\" (seq)\",pi=\"CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON \"+ai+\" (digest, seq)\",vi=ni+\".seq = \"+ti+\".winningseq\",yi=ni+\".seq AS seq, \"+ni+\".deleted AS deleted, \"+ni+\".json AS data, \"+ni+\".rev AS rev, \"+ti+\".json AS metadata\";Qn.valid=Nn;var _i={idb:xn,websql:Qn};re.ajax=ye,re.utils=Zr,re.Errors=Nr,re.replicate=fo.replicate,re.sync=We,re.version=\"5.3.0\",re.adapter(\"http\",ot),re.adapter(\"https\",ot),re.plugin(Uo),Object.keys(_i).forEach(function(e){re.adapter(e,_i[e],!0)}),t.exports=re}).call(this,e(13),\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/pouchdb/dist/pouchdb.min.js\n ** module id = 115\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./bower_components/pouchdb/dist/pouchdb.min.js?");

/***/ },
/* 116 */
/*!****************************************************************!*\
  !*** ./bower_components/pouchdb-find/dist/pouchdb.find.min.js ***!
  \****************************************************************/
/***/ function(module, exports) {

	eval("!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var t;t=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,t.pouchdbFind=e()}}(function(){var e;return function t(e,n,r){function o(u,s){if(!n[u]){if(!e[u]){var c=\"function\"==typeof require&&require;if(!s&&c)return c(u,!0);if(i)return i(u,!0);var a=new Error(\"Cannot find module '\"+u+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var f=n[u]={exports:{}};e[u][0].call(f.exports,function(t){var n=e[u][1][t];return o(n?n:t)},f,f.exports,t,e,n,r)}return n[u].exports}for(var i=\"function\"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){\"use strict\";function r(e){if(!e)return\"undefined\";switch(typeof e){case\"function\":return e.toString();case\"string\":return e.toString();default:return JSON.stringify(e)}}var o=e(4),i=e(5),u=i.Promise;t.exports=function(e){var t=e.db,n=e.viewName,s=e.map,c=e.reduce,a=e.temporary,f=e.pluginName,l=r(s)+r(c)+\"undefined\";if(!a&&t._cachedViews){var d=t._cachedViews[l];if(d)return u.resolve(d)}return t.info().then(function(e){function r(e){e.views=e.views||{};var t=n;-1===t.indexOf(\"/\")&&(t=n+\"/\"+n);var r=e.views[t]=e.views[t]||{};if(!r[u])return r[u]=!0,e}var u=e.db_name+\"-mrview-\"+(a?\"temp\":i.MD5(l));return o(t,\"_local/\"+f,r).then(function(){return t.registerDependentDatabase(u).then(function(e){var n=e.db;n.auto_compaction=!0;var r={name:u,db:n,sourceDB:t,adapter:t.adapter,mapFun:s,reduceFun:c};return r.db.get(\"_local/lastSeq\")[\"catch\"](function(e){if(404!==e.status)throw e}).then(function(e){return r.seq=e?e.seq:0,a||(t._cachedViews=t._cachedViews||{},t._cachedViews[l]=r,r.db.on(\"destroyed\",function(){delete t._cachedViews[l]})),r})})})})}},{4:4,5:5}],2:[function(e,t,n){(function(n){\"use strict\";function r(e){this.status=400,this.name=\"query_parse_error\",this.message=e,this.error=!0;try{Error.captureStackTrace(this,r)}catch(t){}}function o(e){this.status=404,this.name=\"not_found\",this.message=e,this.error=!0;try{Error.captureStackTrace(this,o)}catch(t){}}function i(e){return-1===e.indexOf(\"/\")?[e,e]:e.split(\"/\")}function u(e){return 1===e.length&&/^1-/.test(e[0].rev)}function s(e,t){var n=m(e.key,t.key);return 0!==n?n:m(e.value,t.value)}function c(e,t,n){return n=n||0,\"number\"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function a(e){var t=e.value,n=t&&\"object\"==typeof t&&t._id||e.id;return n}function f(e,t){try{e.emit(\"error\",t)}catch(n){console.error(\"The user's map/reduce function threw an uncaught error.\\nYou can debug this error by doing:\\nmyDatabase.on('error', function (err) { debugger; });\\nPlease double-check your map/reduce function.\"),console.error(t)}}function l(e,t,n){try{return{output:t.apply(null,n)}}catch(r){return f(e,r),{error:r}}}function d(e,t){var n=e.descending?\"endkey\":\"startkey\",o=e.descending?\"startkey\":\"endkey\";if(\"undefined\"!=typeof e[n]&&\"undefined\"!=typeof e[o]&&m(e[n],e[o])>0)throw new r(\"No rows can match your key range, reverse your start_key and end_key or set {descending : true}\");if(t.reduce&&e.reduce!==!1){if(e.include_docs)throw new r(\"{include_docs:true} is invalid for reduce\");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new r(\"Multi-key fetches for reduce views must use {group: true}\")}if(e.group_level){if(\"number\"!=typeof e.group_level)throw new r('Invalid value for integer: \"'+e.group_level+'\"');if(e.group_level<0)throw new r('Invalid value for positive integer: \"'+e.group_level+'\"')}}function h(e){return function(t){if(404===t.status)return e;throw t}}function p(e){function t(e,t,n){function r(){return u(l)?_.resolve(c):t.db.get(s)[\"catch\"](h(c))}function o(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):_.resolve({rows:[]})}function i(e,t){for(var n=[],r={},o=0,i=t.rows.length;i>o;o++){var u=t.rows[o],s=u.doc;if(s&&(n.push(s),r[s._id]=!0,s._deleted=!f[s._id],!s._deleted)){var c=f[s._id];\"value\"in c&&(s.value=c.value)}}var a=Object.keys(f);return a.forEach(function(e){if(!r[e]){var t={_id:e},o=f[e];\"value\"in o&&(t.value=o.value),n.push(t)}}),e.keys=x.uniq(a.concat(e.keys)),n.push(e),n}var s=\"_local/doc_\"+e,c={_id:s,keys:[]},a=n[e],f=a.indexableKeysToKeyValues,l=a.changes;return r().then(function(e){return o(e).then(function(t){return i(e,t)})})}function r(e,n,r){var o=\"_local/lastSeq\";return e.db.get(o)[\"catch\"](h({_id:o,seq:0})).then(function(o){var i=Object.keys(n);return _.all(i.map(function(r){return t(r,e,n)})).then(function(t){var n=x.flatten(t);return o.seq=r,n.push(o),e.db.bulkDocs({docs:n})})})}function f(e){var t=\"string\"==typeof e?e:e.name,n=$[t];return n||(n=$[t]=new g),n}function p(e){return x.sequentialize(f(e),function(){return v(e)})()}function v(e){function t(e,t){var n={id:i._id,key:w(e)};\"undefined\"!=typeof t&&null!==t&&(n.value=w(t)),o.push(n)}function n(t,n){return function(){return r(e,t,n)}}var o,i,u=S(e.mapFun,t),c=e.seq||0,a=new g;return new _(function(t,r){function f(){a.finish().then(function(){e.seq=c,t()})}function d(){function t(e){r(e)}e.sourceDB.changes({conflicts:!0,include_docs:!0,style:\"all_docs\",since:c,limit:E}).on(\"complete\",function(t){var r=t.results;if(!r.length)return f();for(var h={},p=0,v=r.length;v>p;p++){var y=r[p];if(\"_\"!==y.doc._id[0]){o=[],i=y.doc,i._deleted||l(e.sourceDB,u,[i]),o.sort(s);for(var g,w={},k=0,x=o.length;x>k;k++){var _=o[k],$=[_.key,_.id];0===m(_.key,g)&&$.push(k);var j=b($);w[j]=_,g=_.key}h[y.doc._id]={indexableKeysToKeyValues:w,changes:y.changes}}c=y.seq}return a.add(n(h,c)),r.length<E?f():d()}).on(\"error\",t)}d()})}function O(e,t,n){0===n.group_level&&delete n.group_level;var r=n.group||n.group_level,o=C(e.reduceFun),i=[],u=n.group_level;t.forEach(function(e){var t=i[i.length-1],n=r?e.key:null;return r&&Array.isArray(n)&&\"number\"==typeof u&&(n=n.length>u?n.slice(0,u):n),t&&0===m(t.key[0][0],n)?(t.key.push([n,e.id]),void t.value.push(e.value)):void i.push({key:[[n,e.id]],value:[e.value]})});for(var s=0,a=i.length;a>s;s++){var f=i[s],d=l(e.sourceDB,o,[f.key,f.value,!1]);if(d.error&&/BuiltInError/.test(d.error.constructor))throw d.error;f.value=d.error?null:d.output,f.key=f.key[0][0]}return{rows:c(i,n.limit,n.skip)}}function A(e,t){return x.sequentialize(f(e),function(){return q(e,t)})()}function q(e,t){function n(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return o=e.total_rows,e.rows.map(function(e){if(\"value\"in e.doc&&\"object\"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=[\"id\",\"key\",\"value\"];if(!(n>t||t>n))return e.doc.value}var r=y.parseIndexableString(e.doc._id);return{key:r[0],id:r[1],value:\"value\"in e.doc?e.doc.value:null}})})}function r(n){var r;if(r=i?O(e,n,t):{total_rows:o,offset:u,rows:n},t.include_docs){var s=x.uniq(n.map(a));return e.sourceDB.allDocs({keys:s,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t={};return e.rows.forEach(function(e){e.doc&&(t[\"$\"+e.id]=e.doc)}),n.forEach(function(e){var n=a(e),r=t[\"$\"+n];r&&(e.doc=r)}),r})}return r}var o,i=e.reduceFun&&t.reduce!==!1,u=t.skip||0;\"undefined\"==typeof t.keys||t.keys.length||(t.limit=0,delete t.keys);var s=function(e){return e.reduce(function(e,t){return e.concat(t)})};if(\"undefined\"!=typeof t.keys){var c=t.keys,f=c.map(function(e){var t={startkey:b([e]),endkey:b([e,{}])};return n(t)});return _.all(f).then(s).then(r)}var l={descending:t.descending};if(\"undefined\"!=typeof t.startkey&&(l.startkey=b(t.descending?[t.startkey,{}]:[t.startkey])),\"undefined\"!=typeof t.endkey){var d=t.inclusive_end!==!1;t.descending&&(d=!d),l.endkey=b(d?[t.endkey,{}]:[t.endkey])}if(\"undefined\"!=typeof t.key){var h=b([t.key]),p=b([t.key,{}]);l.descending?(l.endkey=h,l.startkey=p):(l.startkey=h,l.endkey=p)}return i||(\"number\"==typeof t.limit&&(l.limit=t.limit),l.skip=u),n(l).then(r)}function I(e){return e.get(\"_local/\"+D).then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=i(e),r=\"_design/\"+t[0],o=t[1];n[r]=n[r]||{},n[r][o]=!0});var r={keys:Object.keys(n),include_docs:!0};return e.allDocs(r).then(function(r){var o={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var i=r+\"/\"+n;t.views[i]||(i=n);var u=Object.keys(t.views[i]),s=e.doc&&e.doc.views&&e.doc.views[n];u.forEach(function(e){o[e]=o[e]||s})})});var i=Object.keys(o).filter(function(e){return!o[e]}),u=i.map(function(t){return x.sequentialize(f(t),function(){return new e.constructor(t,e.__opts).destroy()})()});return _.all(u).then(function(){return{ok:!0}})})},h({ok:!0}))}function F(e,t,r){if(\"string\"!=typeof t){d(r,t);var u={db:e,viewName:\"temp_view/temp_view\",map:t.map,reduce:t.reduce,temporary:!0,pluginName:D};return j.add(function(){return k(u).then(function(e){function t(){return e.db.destroy()}return x.fin(p(e).then(function(){return A(e,r)}),t)})}),j.finish()}var s=t,c=i(s),a=c[0],f=c[1];return e.get(\"_design/\"+a).then(function(t){var i=t.views&&t.views[f];if(!i)throw new o(\"ddoc \"+t._id+\" has no view named \"+f);M(t,f),d(r,i);var u={db:e,viewName:s,map:i.map,reduce:i.reduce,pluginName:D};return k(u).then(function(e){return\"ok\"===r.stale||\"update_after\"===r.stale?(\"update_after\"===r.stale&&n.nextTick(function(){p(e)}),A(e,r)):p(e).then(function(){return A(e,r)})})})}var D=e.name,S=e.mapper,C=e.reducer,M=e.ddocValidator,T=function(e,t,n){var r=this;\"function\"==typeof t&&(n=t,t={}),t=x.extend(!0,{},t),\"function\"==typeof e&&(e={map:e});var o=_.resolve().then(function(){return F(r,e,t)});return x.promisedCallback(o,n),o},L=x.callbackify(function(){var e=this;return I(e)});return{query:T,viewCleanup:L}}var v,y=e(38),g=e(3),m=y.collate,b=y.toIndexableString,w=y.normalizeKey,k=e(1);v=\"undefined\"!=typeof console&&\"function\"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var x=e(5),_=x.Promise,$={},j=new g,E=50;x.inherits(r,Error),x.inherits(o,Error),t.exports=p}).call(this,e(45))},{1:1,3:3,38:38,45:45,5:5}],3:[function(e,t,n){\"use strict\";function r(){this.promise=new o(function(e){e()})}var o=e(5).Promise;r.prototype.add=function(e){return this.promise=this.promise[\"catch\"](function(){}).then(function(){return e()}),this.promise},r.prototype.finish=function(){return this.promise},t.exports=r},{5:5}],4:[function(e,t,n){\"use strict\";var r=e(41).upsert;t.exports=function(e,t,n){return r.apply(e,[t,n])}},{41:41}],5:[function(e,t,n){(function(t){\"use strict\";n.Promise=e(42),n.inherits=e(23),n.extend=e(40);var r=e(18);n.promisedCallback=function(e,n){return n&&e.then(function(e){t.nextTick(function(){n(null,e)})},function(e){t.nextTick(function(){n(e)})}),e},n.callbackify=function(e){return r(function(t){var r=t.pop(),o=e.apply(this,t);return\"function\"==typeof r&&n.promisedCallback(o,r),o})},n.fin=function(e,t){return e.then(function(e){var n=t();return\"function\"==typeof n.then?n.then(function(){return e}):e},function(e){var n=t();if(\"function\"==typeof n.then)return n.then(function(){throw e});throw e})},n.sequentialize=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}},n.flatten=function(e){for(var t=[],n=0,r=e.length;r>n;n++)t=t.concat(e[n]);return t},n.uniq=function(e){for(var t={},n=0,r=e.length;r>n;n++)t[\"$\"+e[n]]=!0;var o=Object.keys(t),i=new Array(o.length);for(n=0,r=o.length;r>n;n++)i[n]=o[n].substring(1);return i};var o=e(19),i=e(46);n.MD5=function(e){return t.browser?i.hash(e):o.createHash(\"md5\").update(e).digest(\"hex\")}}).call(this,e(45))},{18:18,19:19,23:23,40:40,42:42,45:45,46:46}],6:[function(e,t,n){\"use strict\";function r(e,t,n){t=s(t),e.request({method:\"POST\",url:\"_index\",body:t},n)}function o(e,t,n){e.request({method:\"POST\",url:\"_find\",body:t},n)}function i(e,t){e.request({method:\"GET\",url:\"_index\"},t)}function u(e,t,n){var r=t.ddoc,o=t.type||\"json\",i=t.name;if(!r)return n(new Error(\"you must provide an index's ddoc\"));if(!i)return n(new Error(\"you must provide an index's name\"));var u=\"_index/\"+[r,o,i].map(encodeURIComponent).join(\"/\");e.request({method:\"DELETE\",url:u},n)}var s=e(16);n.createIndex=r,n.find=o,n.getIndexes=i,n.deleteIndex=u},{16:16}],7:[function(e,t,n){\"use strict\";function r(e,t){return function(n){for(var r=[],o=0,i=e.length;i>o;o++){for(var u=p(e[o]),s=n,c=0,a=u.length;a>c;c++){var f=u[c];if(s=s[f],!s)break}r.push(s)}t(r)}}function o(e,t){var n=p(e);return function(e){for(var r=e,o=0,i=n.length;i>o;o++){var u=n[o];if(r=r[u],!r)return}t(r)}}function i(e,t){return function(n){t(n[e])}}function u(e,t){return function(n){for(var r=[],o=0,i=e.length;i>o;o++)r.push(n[e[o]]);t(r)}}function s(e){for(var t=0,n=e.length;n>t;t++){var r=e[t];if(-1!==r.indexOf(\".\"))return!1}return!0}function c(e,t){var n=s(e),c=1===e.length;return n?c?i(e[0],t):u(e,t):c?o(e[0],t):r(e,t)}function a(e,t){var n=Object.keys(e.fields);return c(n,t)}function f(){throw new Error(\"reduce not supported\")}function l(e,t){var n=e.views[t];if(!n.map||!n.map.fields)throw new Error(\"ddoc \"+e._id+\" with view \"+t+\" doesn't have map.fields defined. maybe it wasn't created by this plugin?\")}var d=e(15),h=e(2),p=d.parseField,v=h({name:\"indexes\",mapper:a,reducer:f,ddocValidator:l});t.exports=v},{15:15,2:2}],8:[function(e,t,n){\"use strict\";function r(e,t,n){return s.upsert.call(e,t,n)}function o(e,t){function n(e){return e._rev&&\"query\"!==e.language&&(v=!0),e.language=\"query\",e.views=e.views||{},y=!!e.views[a],e.views[a]={map:{fields:i.mergeObjects(t.index.fields)},reduce:\"_count\",options:{def:o}},e}t=d(t);var o=i.clone(t.index);t.index=l(t.index),f(t.index);var s=i.MD5(JSON.stringify(t)),a=t.name||\"idx-\"+s,h=t.ddoc||\"idx-\"+s,p=\"_design/\"+h,v=!1,y=!1;return u(\"creating index\",p),r(e,p,n).then(function(){if(v)throw new Error('invalid language for ddoc with id \"'+p+'\" (should be \"query\")')}).then(function(){var t=h+\"/\"+a;return c.query.call(e,t,{limit:0,reduce:!1}).then(function(){return{id:p,name:a,result:y?\"exists\":\"created\"}})})}var i=e(17),u=i.log,s=e(41),c=e(7),a=e(15),f=a.validateIndex,l=a.massageIndexDef,d=e(16);t.exports=o},{15:15,16:16,17:17,41:41,7:7}],9:[function(e,t,n){\"use strict\";function r(e,t){function n(e){return 1===Object.keys(e.views).length&&e.views[u]?{_id:r,_deleted:!0}:(delete e.views[u],e)}if(!t.ddoc)throw new Error(\"you must supply an index.ddoc when deleting\");if(!t.name)throw new Error(\"you must supply an index.name when deleting\");var r=t.ddoc,u=t.name;return i(e,r,n).then(function(){return o.viewCleanup.apply(e)}).then(function(){return{ok:!0}})}var o=e(7),i=e(4);t.exports=r},{4:4,7:7}],10:[function(e,t,n){\"use strict\";function r(e,t){for(var n=e,r=0,o=t.length;o>r;r++){var i=t[r];if(n=n[i],!n)break}return n}function o(e,t,n){function i(e){return a(r(e,n),t)}function u(e){var t=r(e,n);return\"undefined\"!=typeof t&&null!==t}function s(e){var t=r(e,n);return\"undefined\"!=typeof t}function c(e){var t=r(e,n);return u(e)&&t instanceof Array}function f(e){var o=r(e,n);return t.some(function(e){return o instanceof Array?o.indexOf(e)>-1:o===e})}function l(e){var o=r(e,n);return t.every(function(e){return o.indexOf(e)>-1})}function d(e){var o=r(e,n);return o.length===t}function h(e){var o=r(e,n),i=t[0],u=t[1];if(0===i)throw new Error(\"Bad divisor, cannot divide by zero\");if(parseInt(i,10)!==i)throw new Error(\"Divisor is not an integer\");if(parseInt(u,10)!==u)throw new Error(\"Modulus is not an integer\");return parseInt(o,10)!==o?!1:o%i===u}function p(e){var o=new RegExp(t),i=r(e,n);return o.test(i)}function v(e){var o=r(e,n);switch(t){case\"null\":return null===o;case\"boolean\":return\"boolean\"==typeof o;case\"number\":return\"number\"==typeof o;case\"string\":return\"string\"==typeof o;case\"array\":return o instanceof Array;case\"object\":return\"[object Object]\"==={}.toString.call(o)}return!1}switch(e){case\"$eq\":return function(e){return u(e)&&0===i(e)};case\"$lte\":return function(e){return u(e)&&i(e)<=0};case\"$gte\":return function(e){return u(e)&&i(e)>=0};case\"$lt\":return function(e){return u(e)&&i(e)<0};case\"$gt\":return function(e){return u(e)&&i(e)>0};case\"$exists\":return function(e){return t?s(e):!s(e)};case\"$ne\":return function(e){var o=r(e,n);return t.every(function(e){return 0!==a(o,e)})};case\"$in\":return function(e){return u(e)&&f(e)};case\"$nin\":return function(e){return u(e)&&!f(e)};case\"$size\":return function(e){return c(e)&&d(e)};case\"$all\":return function(e){return c(e)&&l(e)};case\"$mod\":return function(e){return u(e)&&h(e)};case\"$regex\":return function(e){return u(e)&&p(e)};case\"$elemMatch\":return function(e){var i=r(e,n);return c(e)?i.some(function(e){return Object.keys(t).every(function(n){return o(n,t[n],\"a\")({a:e})})}):!1};case\"$type\":return function(e){return v(e)}}throw new Error('unknown operator \"'+n[0]+'\" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod or $all')}function i(e,t){var n=[];return t=t instanceof Array?t:[t],t.forEach(function(e){Object.keys(e).forEach(function(t){var r=e[t],i=p(t);Object.keys(r).forEach(function(e){var t=r[e],u=o(e,t,i);n.push(u)})})}),\"$or\"===e?function(e){return n.some(function(t){return t(e)})}:\"$not\"===e?function(e){return!n[0](e)}:function(e){return!n.find(function(t){return t(e)})}}function u(e,t){var n=[];return t.forEach(function(t){var r=e.selector[t],u=p(t);if(r){if(l(t)){var s=i(t,r);return void n.push(s)}Object.keys(r).forEach(function(e){var t=r[e],i=o(e,t,u);n.push(i)})}}),function(e){for(var t=0,r=n.length;r>t;t++){var o=n[t];if(!o(e.doc))return!1}return!0}}function s(e){function t(t){return e.map(function(e){var n=d(e),o=p(n),i=r(t,o);return i})}return function(e,n){var r=t(e.doc),o=t(n.doc),i=a(r,o);return 0!==i?i:v.compare(e.doc._id,n.doc._id)}}function c(e,t,n){var r=u(t,n);if(e=e.filter(r),t.sort){var o=s(t.sort);e=e.sort(o),\"string\"!=typeof t.sort[0]&&\"desc\"===h(t.sort[0])&&(e=e.reverse())}if(\"limit\"in t||\"skip\"in t){var i=t.skip||0,c=(\"limit\"in t?t.limit:e.length)+i;e=e.slice(i,c)}return e}var a=e(38).collate,f=e(15),l=f.isCombinationalField,d=f.getKey,h=f.getValue,p=f.parseField,v=e(17);t.exports=c},{15:15,17:17,38:38}],11:[function(e,t,n){\"use strict\";function r(e){return e.ddoc.substring(8)+\"/\"+e.name}function o(e,t){var n=s(t);return n.descending?(\"endkey\"in n&&\"string\"!=typeof n.endkey&&(n.endkey=\"\"),\"startkey\"in n&&\"string\"!=typeof n.startkey&&(n.limit=0)):(\"startkey\"in n&&\"string\"!=typeof n.startkey&&(n.startkey=\"\"),\"endkey\"in n&&\"string\"!=typeof n.endkey&&(n.limit=0)),\"key\"in n&&\"string\"!=typeof n.key&&(n.limit=0),e.allDocs(n)}function i(e,t){return t.selector&&(t.selector=p(t.selector)),t.sort&&(t.sort=v(t.sort)),g(t),c(e).then(function(n){var i=l(t,n.indexes),s=i.index,c=u.extend(!0,{include_docs:!0,reduce:!1},i.queryOpts);if(\"startkey\"in c&&\"endkey\"in c&&a(c.startkey,c.endkey)>0)return{docs:[]};var d=t.sort&&\"string\"!=typeof t.sort[0]&&\"desc\"===y(t.sort[0]);return d&&(c.descending=!0,c=m(c)),i.inMemoryFields.length||(\"limit\"in t&&(c.limit=t.limit),\"skip\"in t&&(c.skip=t.skip)),w.resolve().then(function(){if(\"_all_docs\"===s.name)return o(e,c);var t=r(s);return f.query.call(e,t,c)}).then(function(e){return c.inclusive_start===!1&&(e.rows=b(e.rows,c.startkey,s)),i.inMemoryFields.length&&(e.rows=h(e.rows,t,i.inMemoryFields)),{docs:e.rows.map(function(e){var n=e.doc;return t.fields?u.pick(n,t.fields):n})}})})}var u=e(17),s=u.clone,c=e(13),a=e(38).collate,f=e(7),l=e(12),d=e(15),h=e(10),p=d.massageSelector,v=d.massageSort,y=d.getValue,g=d.validateFindRequest,m=d.reverseOptions,b=d.filterInclusiveStart,w=u.Promise;t.exports=i},{10:10,12:12,13:13,15:15,17:17,38:38,7:7}],12:[function(e,t,n){\"use strict\";function r(e,t){for(var n=e.def.fields.map(j),r=0,o=n.length;o>r;r++){var i=n[r];if(t===i)return!0}return!1}function o(e,t){var n=e[t],r=j(n);return\"$eq\"!==r}function i(e,t){var n=t.def.fields.map(j);return e.slice().sort(function(e,t){var r=n.indexOf(e),o=n.indexOf(t);return-1===r&&(r=Number.MAX_VALUE),-1===o&&(o=Number.MAX_VALUE),x.compare(r,o)})}function u(e,t,n){n=i(n,e);for(var u=!1,s=0,c=n.length;c>s;s++){var a=n[s];if(u||!r(e,a))return n.slice(s);c-1>s&&o(t,a)&&(u=!0)}return[]}function s(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Object.keys(r).forEach(function(e){\"$ne\"===e&&t.push(n)})}),t}function c(e,t,n,r){var o=x.flatten(e,u(t,n,r),s(n));return i(x.uniq(o),t)}function a(e,t,n){if(t){var r=x.oneArrayIsStrictSubArrayOfOther(t,e),o=x.oneArrayIsSubArrayOfOther(n,e);return r&&o}return x.oneSetIsSubArrayOfOther(n,e)}function f(e){return-1===I.indexOf(e)}function l(e,t){var n=e[0],r=t[n],o=Object.keys(r).some(function(e){return!f(e)});if(!o)return!1;var i=1===Object.keys(r).length&&\"$ne\"===j(r);return!i}function d(e,t,n,r){var o=e.def.fields.map(j),i=a(o,t,n);if(!i)return!1;var u=l(o,r);return u}function h(e,t,n,r){for(var o=[],i=0,u=r.length;u>i;i++){var s=r[i],c=d(s,n,t,e);c&&o.push(s)}return o}function p(e,t,n,r){function o(e){for(var t=e.def.fields.map(j),n=0,r=0,o=t.length;o>r;r++){var i=t[r];u[i]&&n++}return n}var i=h(e,t,n,r);if(0===i.length)return null;if(1===i.length)return i[0];var u=x.arrayToObject(t);return x.max(i,o)}function v(e,t){switch(e){case\"$eq\":return{key:t};case\"$lte\":return{endkey:t};case\"$gte\":return{startkey:t};case\"$lt\":return{endkey:t,inclusive_end:!1};case\"$gt\":return{startkey:t,inclusive_start:!1}}}function y(e,t){var n,r=j(t.def.fields[0]),o=e[r],i=[],u=Object.keys(o);return u.forEach(function(e){if(f(e))return void i.push(r);var t=o[e],u=v(e,t);n=n?x.mergeObjects([n,u]):u}),{queryOpts:n,inMemoryFields:i}}function g(e,t){switch(e){case\"$eq\":return{startkey:t,endkey:t};case\"$lte\":return{endkey:t};case\"$gte\":return{startkey:t};case\"$lt\":return{endkey:t,inclusive_end:!1};case\"$gt\":return{startkey:t,inclusive_start:!1}}}function m(e,t){function n(e){r!==!1&&s.push(A),o!==!1&&c.push(q),u=i.slice(e)}for(var r,o,i=t.def.fields.map(j),u=[],s=[],c=[],a=0,f=i.length;f>a;a++){var l=i[a],d=e[l];if(!d){n(a);break}if(a>0){if(\"$ne\"in d){n(a);break}var h=\"$gt\"in d||\"$gte\"in d||\"$lt\"in d||\"$lte\"in d,p=Object.keys(e[i[a-1]]),v=x.arrayEquals(p,[\"$eq\"]),y=x.arrayEquals(p,Object.keys(d)),m=h&&!v&&!y;if(m){n(a);break}}for(var b=Object.keys(d),w=null,k=0;k<b.length;k++){var _=b[k],$=d[_],E=g(_,$);w=w?x.mergeObjects([w,E]):E}s.push(\"startkey\"in w?w.startkey:A),c.push(\"endkey\"in w?w.endkey:q),\"inclusive_start\"in w&&(r=w.inclusive_start),\"inclusive_end\"in w&&(o=w.inclusive_end)}var O={startkey:s,endkey:c};return\"undefined\"!=typeof r&&(O.inclusive_start=r),\"undefined\"!=typeof o&&(O.inclusive_end=o),{queryOpts:O,inMemoryFields:u}}function b(e,t){return 1===t.def.fields.length?y(e,t):m(e,t)}function w(e,t,n){if(\"$ne\"===j(E(n)))return new Error(\"couldn't find a usable index. try using $and with $lt/$gt instead of $ne\");var r=t&&t.length>=e.length?t:e;return new Error(\"couldn't find a usable index. try creating an index on: \"+r.join(\", \")+\". Make sure that only $eq, $gt, $gte, $lt, and $lte are used for the indexed fields.\")}function k(e,t){_(\"planning query\",e);var n=e.selector,r=e.sort,o=O(n,r),i=o.fields,u=o.sortOrder,s=p(n,i,u,t);if(!s)throw w(i,u,n);var a=s.def.fields[0],f=(n[j(a)],b(n,s)),l=f.queryOpts,d=f.inMemoryFields,h=c(d,s,n,i),v={queryOpts:l,index:s,inMemoryFields:h};return _(\"query plan\",v),v}var x=e(17),_=x.log,$=e(15),j=$.getKey,E=$.getValue,O=$.getUserFields,A=null,q={\"￿\":{}},I=[\"$eq\",\"$gt\",\"$gte\",\"$lt\",\"$lte\"];t.exports=k},{15:15,17:17}],13:[function(e,t,n){\"use strict\";function r(e){return e.allDocs({startkey:\"_design/\",endkey:\"_design/￿\",include_docs:!0}).then(function(e){var t={indexes:[{ddoc:null,name:\"_all_docs\",type:\"special\",def:{fields:[{_id:\"asc\"}]}}]};return t.indexes=o.flatten(t.indexes,e.rows.filter(function(e){return\"query\"===e.doc.language}).map(function(e){var t=void 0!==e.doc.views?Object.keys(e.doc.views):[];return t.map(function(t){var n=e.doc.views[t];return{ddoc:e.id,name:t,type:\"json\",def:u(n.options.def)}})})),t.indexes.sort(function(e,t){return o.compare(e.name,t.name)}),t.total_rows=t.indexes.length,t})}var o=e(17),i=e(15),u=i.massageIndexDef;t.exports=r},{15:15,17:17}],14:[function(e,t,n){\"use strict\";var r=e(17),o=r.callbackify;n.createIndex=o(e(8)),n.find=o(e(11)),n.getIndexes=o(e(13)),n.deleteIndex=o(e(9))},{11:11,13:13,17:17,8:8,9:9}],15:[function(e,t,n){\"use strict\";function r(e){return Object.keys(e)[0]}function o(e){return e[r(e)]}function i(e){if(!Array.isArray(e))throw new Error(\"invalid sort json - should be an array\");return e.map(function(e){if(\"string\"==typeof e){var t={};return t[e]=\"asc\",t}return e})}function u(e){return _.indexOf(e)>-1}function s(e,t,n){\"undefined\"==typeof n.$eq&&(\"undefined\"!=typeof n.$gte?\"$gte\"===e?t>n.$gte&&(n.$gte=t):t>=n.$gte&&(delete n.$gte,n.$gt=t):\"undefined\"!=typeof n.$gt?\"$gte\"===e?t>n.$gt&&(delete n.$gt,n.$gte=t):t>n.$gt&&(n.$gt=t):n[e]=t)}function c(e,t,n){\"undefined\"==typeof n.$eq&&(\"undefined\"!=typeof n.$lte?\"$lte\"===e?t<n.$lte&&(n.$lte=t):t<=n.$lte&&(delete n.$lte,n.$lt=t):\"undefined\"!=typeof n.$lt?\"$lte\"===e?t<n.$lt&&(delete n.$lt,n.$lte=t):t<n.$lt&&(n.$lt=t):n[e]=t)}function a(e,t){\"$ne\"in t?t.$ne.push(e):t.$ne=[e]}function f(e,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=e}function l(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(n){var r=e[n];if(\"object\"!=typeof r&&(r={$eq:r}),u(n))r instanceof Array?t[n]=r.map(function(e){return l([e])}):t[n]=l([r]);else{var o=t[n]=t[n]||{};Object.keys(r).forEach(function(e){var t=r[e];return\"$gt\"===e||\"$gte\"===e?s(e,t,o):\"$lt\"===e||\"$lte\"===e?c(e,t,o):\"$ne\"===e?a(t,o):\"$eq\"===e?f(t,o):void(o[e]=t)})}})}),t}function d(e){var t=k.clone(e),n=!1;\"$and\"in t&&(t=l(t.$and),n=!0),\"$not\"in t&&(t.$not=l([t.$not]));for(var r=Object.keys(t),o=0;o<r.length;o++){var i=r[o],u=t[i];\"object\"!=typeof u?u={$eq:u}:\"$ne\"in u&&!n&&(u.$ne=[u.$ne]),t[i]=u}return t}function h(e){return e.fields=e.fields.map(function(e){if(\"string\"==typeof e){var t={};return t[e]=\"asc\",t}return e}),e}function p(e,t){for(var n=[],o=0;o<t.def.fields.length;o++){var i=r(t.def.fields[o]);n.push(e[i])}return n}function v(e,t,n){for(var r=n.def.fields,o=0,i=e.length;i>o;o++){var u=e[o],s=p(u.doc,n);if(1===r.length)s=s[0];else for(;s.length>t.length;)s.pop();if(Math.abs(x.collate(s,t))>0)break}return o>0?e.slice(o):e}function y(e){var t=k.clone(e);return delete t.startkey,delete t.endkey,delete t.inclusive_start,delete t.inclusive_end,\"endkey\"in e&&(t.startkey=e.endkey),\"startkey\"in e&&(t.endkey=e.startkey),\"inclusive_start\"in e&&(t.inclusive_end=e.inclusive_start),\"inclusive_end\"in e&&(t.inclusive_start=e.inclusive_end),t}function g(e){var t=e.fields.filter(function(e){return\"asc\"===o(e)});if(0!==t.length&&t.length!==e.fields.length)throw new Error(\"unsupported mixed sorting\")}function m(e){if(\"object\"!=typeof e.selector)throw new Error(\"you must provide a selector when you find()\");var t=Object.keys(e.selector),n=e.sort?i(e.sort).map(r):[];if(!k.oneSetIsSubArrayOfOther(t,n))throw new Error(\"conflicting sort and selector fields\");for(var o=e.selector.$and||[e.selector],u=0;u<o.length;u++){var s=o[u],c=Object.keys(s);if(0===c.length)throw new Error(\"invalid empty selector\")}}function b(e){for(var t=[],n=\"\",r=0,o=e.length;o>r;r++){var i=e[r];\".\"===i?r>0&&\"\\\\\"===e[r-1]?n=n.substring(0,n.length-1)+\".\":(t.push(n),n=\"\"):n+=i}return t.push(n),t}function w(e,t){var n,o=Object.keys(e),i=t?t.map(r):[];return n=o.length>i.length?o:i,0===i.length?{fields:n}:(n=n.sort(function(e,t){var n=i.indexOf(e);-1===n&&(n=Number.MAX_VALUE);var r=i.indexOf(t);return-1===r&&(r=Number.MAX_VALUE),r>n?-1:n>r?1:0}),{fields:n,sortOrder:t.map(r)})}var k=e(17),x=e(38),_=[\"$or\",\"$nor\",\"$not\"];t.exports={getKey:r,getValue:o,massageSort:i,massageSelector:d,validateIndex:g,validateFindRequest:m,reverseOptions:y,filterInclusiveStart:v,massageIndexDef:h,parseField:b,getUserFields:w,isCombinationalField:u}},{17:17,38:38}],16:[function(e,t,n){\"use strict\";var r=e(17),o=r.clone;t.exports=function(e){return e=o(e),e.index||(e.index={}),[\"type\",\"name\",\"ddoc\"].forEach(function(t){e.index[t]&&(e[t]=e.index[t],delete e.index[t])}),e.fields&&(e.index.fields=e.fields,delete e.fields),e.type||(e.type=\"json\"),e}},{17:17}],17:[function(e,t,n){(function(t){\"use strict\";var r=e(42);n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error(\"once called  more than once\");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(o){var i,u=this,s=\"function\"==typeof o[o.length-1]?o.pop():!1;s&&(i=function(e,n){t.nextTick(function(){s(e,n)})});var c=new r(function(t,r){try{var i=n.once(function(e,n){e?r(e):t(n)});o.push(i),e.apply(u,o)}catch(s){r(s)}});return i&&c.then(function(e){i(null,e)},i),c.cancel=function(){return this},c})},n.inherits=e(23),n.Promise=r,n.clone=function(e){return n.extend(!0,{},e)},n.extend=e(40),n.callbackify=function(e){return n.getArguments(function(t){var r=t.pop(),o=e.apply(this,t);return n.promisedCallback(o,r),o})},n.promisedCallback=function(e,n){return e.then(function(e){t.nextTick(function(){n(null,e)})},function(e){t.nextTick(function(){n(e)})}),e};var o=e(19),i=e(46);n.MD5=function(e){return t.browser?i.hash(e):o.createHash(\"md5\").update(e).digest(\"hex\")},n.flatten=n.getArguments(function(e){for(var t=[],r=0,o=e.length;o>r;r++){var i=e[r];Array.isArray(i)?t=t.concat(n.flatten.apply(null,i)):t.push(i)}return t}),n.mergeObjects=function(e){for(var t={},r=0,o=e.length;o>r;r++)t=n.extend(!0,t,e[r]);return t},n.pick=function(e,t){for(var n={},r=0,o=t.length;o>r;r++){var i=t[r];n[i]=e[i]}return n},n.oneArrayIsSubArrayOfOther=function(e,t){for(var n=0,r=Math.min(e.length,t.length);r>n;n++)if(e[n]!==t[n])return!1;return!0},n.oneArrayIsStrictSubArrayOfOther=function(e,t){return e.length>t.length?!1:n.oneArrayIsSubArrayOfOther(e,t)},n.oneSetIsSubArrayOfOther=function(e,t){e=e.slice();for(var n=0,r=t.length;r>n;n++){var o=t[n];if(!e.length)break;var i=e.indexOf(o);if(-1===i)return!1;e.splice(i,1)}return!0},n.compare=function(e,t){return t>e?-1:e>t?1:0},n.arrayToObject=function(e){for(var t={},n=0,r=e.length;r>n;n++)t[e[n]]=!0;return t},n.max=function(e,t){for(var n=null,r=-1,o=0,i=e.length;i>o;o++){var u=e[o],s=t(u);s>r&&(r=s,n=u)}return n},n.arrayEquals=function(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;r>n;n++)if(e[n]!==t[n])return!1;return!0},n.uniq=function(e){for(var t={},n=0;n<e.length;n++)t[\"$\"+e[n]]=!0;return Object.keys(t).map(function(e){return e.substring(1)})},n.log=e(20)(\"pouchdb:find\")}).call(this,e(45))},{19:19,20:20,23:23,40:40,42:42,45:45,46:46}],18:[function(e,t,n){\"use strict\";function r(e){return function(){var t=arguments.length;if(t){for(var n=[],r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}return e.call(this,[])}}t.exports=r},{}],19:[function(e,t,n){},{}],20:[function(e,t,n){function r(){return\"WebkitAppearance\"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var e=arguments,t=this.useColors;if(e[0]=(t?\"%c\":\"\")+this.namespace+(t?\" %c\":\" \")+e[0]+(t?\"%c \":\" \")+\"+\"+n.humanize(this.diff),!t)return e;var r=\"color: \"+this.color;e=[e[0],r,\"color: inherit\"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){\"%%\"!==e&&(o++,\"%c\"===e&&(i=o))}),e.splice(i,0,r),e}function i(){return\"object\"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function u(e){try{null==e?n.storage.removeItem(\"debug\"):n.storage.debug=e}catch(t){}}function s(){var e;try{e=n.storage.debug}catch(t){}return e}function c(){try{return window.localStorage}catch(e){}}n=t.exports=e(21),n.log=i,n.formatArgs=o,n.save=u,n.load=s,n.useColors=r,n.storage=\"undefined\"!=typeof chrome&&\"undefined\"!=typeof chrome.storage?chrome.storage.local:c(),n.colors=[\"lightseagreen\",\"forestgreen\",\"goldenrod\",\"dodgerblue\",\"darkorchid\",\"crimson\"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(s())},{21:21\n}],21:[function(e,t,n){function r(){return n.colors[f++%n.colors.length]}function o(e){function t(){}function o(){var e=o,t=+new Date,i=t-(a||t);e.diff=i,e.prev=a,e.curr=t,a=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=r());var u=Array.prototype.slice.call(arguments);u[0]=n.coerce(u[0]),\"string\"!=typeof u[0]&&(u=[\"%o\"].concat(u));var s=0;u[0]=u[0].replace(/%([a-z%])/g,function(t,r){if(\"%%\"===t)return t;s++;var o=n.formatters[r];if(\"function\"==typeof o){var i=u[s];t=o.call(e,i),u.splice(s,1),s--}return t}),\"function\"==typeof n.formatArgs&&(u=n.formatArgs.apply(e,u));var c=o.log||n.log||console.log.bind(console);c.apply(e,u)}t.enabled=!1,o.enabled=!0;var i=n.enabled(e)?o:t;return i.namespace=e,i}function i(e){n.save(e);for(var t=(e||\"\").split(/[\\s,]+/),r=t.length,o=0;r>o;o++)t[o]&&(e=t[o].replace(/\\*/g,\".*?\"),\"-\"===e[0]?n.skips.push(new RegExp(\"^\"+e.substr(1)+\"$\")):n.names.push(new RegExp(\"^\"+e+\"$\")))}function u(){n.enable(\"\")}function s(e){var t,r;for(t=0,r=n.skips.length;r>t;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;r>t;t++)if(n.names[t].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=o,n.coerce=c,n.disable=u,n.enable=i,n.enabled=s,n.humanize=e(37),n.names=[],n.skips=[],n.formatters={};var a,f=0},{37:37}],22:[function(e,t,n){(function(e){\"use strict\";function n(){f=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}f=!1}function r(e){1!==l.push(e)||f||o()}var o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var u=0,s=new i(n),c=e.document.createTextNode(\"\");s.observe(c,{characterData:!0}),o=function(){c.data=u=++u%2}}else if(e.setImmediate||\"undefined\"==typeof e.MessageChannel)o=\"document\"in e&&\"onreadystatechange\"in e.document.createElement(\"script\")?function(){var t=e.document.createElement(\"script\");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var a=new e.MessageChannel;a.port1.onmessage=n,o=function(){a.port2.postMessage(0)}}var f,l=[];t.exports=r}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],23:[function(e,t,n){\"function\"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],24:[function(e,t,n){\"use strict\";function r(){}t.exports=r},{}],25:[function(e,t,n){\"use strict\";function r(e){function t(e,t){function o(e){a[t]=e,++f===n&!r&&(r=!0,c.resolve(d,a))}u(e).then(o,function(e){r||(r=!0,c.reject(d,e))})}if(\"[object Array]\"!==Object.prototype.toString.call(e))return i(new TypeError(\"must be an array\"));var n=e.length,r=!1;if(!n)return u([]);for(var a=new Array(n),f=0,l=-1,d=new o(s);++l<n;)t(e[l],l);return d}var o=e(28),i=e(31),u=e(32),s=e(24),c=e(26);t.exports=r},{24:24,26:26,28:28,31:31,32:32}],26:[function(e,t,n){\"use strict\";function r(e){var t=e&&e.then;return e&&\"object\"==typeof e&&\"function\"==typeof t?function(){t.apply(e,arguments)}:void 0}var o=e(35),i=e(33),u=e(34);n.resolve=function(e,t){var s=o(r,t);if(\"error\"===s.status)return n.reject(e,s.value);var c=s.value;if(c)i.safely(e,c);else{e.state=u.FULFILLED,e.outcome=t;for(var a=-1,f=e.queue.length;++a<f;)e.queue[a].callFulfilled(t)}return e},n.reject=function(e,t){e.state=u.REJECTED,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e}},{33:33,34:34,35:35}],27:[function(e,t,n){t.exports=n=e(28),n.resolve=e(32),n.reject=e(31),n.all=e(25),n.race=e(30)},{25:25,28:28,30:30,31:31,32:32}],28:[function(e,t,n){\"use strict\";function r(e){if(!(this instanceof r))return new r(e);if(\"function\"!=typeof e)throw new TypeError(\"resolver must be a function\");this.state=s.PENDING,this.queue=[],this.outcome=void 0,e!==i&&u.safely(this,e)}var o=e(36),i=e(24),u=e(33),s=e(34),c=e(29);t.exports=r,r.prototype[\"catch\"]=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if(\"function\"!=typeof e&&this.state===s.FULFILLED||\"function\"!=typeof t&&this.state===s.REJECTED)return this;var n=new r(i);if(this.state!==s.PENDING){var u=this.state===s.FULFILLED?e:t;o(n,u,this.outcome)}else this.queue.push(new c(n,e,t));return n}},{24:24,29:29,33:33,34:34,36:36}],29:[function(e,t,n){\"use strict\";function r(e,t,n){this.promise=e,\"function\"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),\"function\"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var o=e(26),i=e(36);t.exports=r,r.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},r.prototype.otherCallFulfilled=function(e){i(this.promise,this.onFulfilled,e)},r.prototype.callRejected=function(e){o.reject(this.promise,e)},r.prototype.otherCallRejected=function(e){i(this.promise,this.onRejected,e)}},{26:26,36:36}],30:[function(e,t,n){\"use strict\";function r(e){function t(e){u(e).then(function(e){r||(r=!0,c.resolve(f,e))},function(e){r||(r=!0,c.reject(f,e))})}if(\"[object Array]\"!==Object.prototype.toString.call(e))return i(new TypeError(\"must be an array\"));var n=e.length,r=!1;if(!n)return u([]);for(var a=-1,f=new o(s);++a<n;)t(e[a]);return f}var o=e(28),i=e(31),u=e(32),s=e(24),c=e(26);t.exports=r},{24:24,26:26,28:28,31:31,32:32}],31:[function(e,t,n){\"use strict\";function r(e){var t=new o(i);return u.reject(t,e)}var o=e(28),i=e(24),u=e(26);t.exports=r},{24:24,26:26,28:28}],32:[function(e,t,n){\"use strict\";function r(e){if(e)return e instanceof o?e:u.resolve(new o(i),e);var t=typeof e;switch(t){case\"boolean\":return s;case\"undefined\":return a;case\"object\":return c;case\"number\":return f;case\"string\":return l}}var o=e(28),i=e(24),u=e(26);t.exports=r;var s=u.resolve(new o(i),!1),c=u.resolve(new o(i),null),a=u.resolve(new o(i),void 0),f=u.resolve(new o(i),0),l=u.resolve(new o(i),\"\")},{24:24,26:26,28:28}],33:[function(e,t,n){\"use strict\";function r(e,t){function n(t){s||(s=!0,o.reject(e,t))}function r(t){s||(s=!0,o.resolve(e,t))}function u(){t(r,n)}var s=!1,c=i(u);\"error\"===c.status&&n(c.value)}var o=e(26),i=e(35);n.safely=r},{26:26,35:35}],34:[function(e,t,n){n.REJECTED=[\"REJECTED\"],n.FULFILLED=[\"FULFILLED\"],n.PENDING=[\"PENDING\"]},{}],35:[function(e,t,n){\"use strict\";function r(e,t){var n={};try{n.value=e(t),n.status=\"success\"}catch(r){n.status=\"error\",n.value=r}return n}t.exports=r},{}],36:[function(e,t,n){\"use strict\";function r(e,t,n){o(function(){var r;try{r=t(n)}catch(o){return i.reject(e,o)}r===e?i.reject(e,new TypeError(\"Cannot resolve promise with itself\")):i.resolve(e,r)})}var o=e(22),i=e(26);t.exports=r},{22:22,26:26}],37:[function(e,t,n){function r(e){if(e=\"\"+e,!(e.length>1e4)){var t=/^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||\"ms\").toLowerCase();switch(r){case\"years\":case\"year\":case\"yrs\":case\"yr\":case\"y\":return n*l;case\"days\":case\"day\":case\"d\":return n*f;case\"hours\":case\"hour\":case\"hrs\":case\"hr\":case\"h\":return n*a;case\"minutes\":case\"minute\":case\"mins\":case\"min\":case\"m\":return n*c;case\"seconds\":case\"second\":case\"secs\":case\"sec\":case\"s\":return n*s;case\"milliseconds\":case\"millisecond\":case\"msecs\":case\"msec\":case\"ms\":return n}}}}function o(e){return e>=f?Math.round(e/f)+\"d\":e>=a?Math.round(e/a)+\"h\":e>=c?Math.round(e/c)+\"m\":e>=s?Math.round(e/s)+\"s\":e+\"ms\"}function i(e){return u(e,f,\"day\")||u(e,a,\"hour\")||u(e,c,\"minute\")||u(e,s,\"second\")||e+\" ms\"}function u(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+\" \"+n:Math.ceil(e/t)+\" \"+n+\"s\"}var s=1e3,c=60*s,a=60*c,f=24*a,l=365.25*f;t.exports=function(e,t){return t=t||{},\"string\"==typeof e?r(e):t[\"long\"]?i(e):o(e)}},{}],38:[function(e,t,n){\"use strict\";function r(e){if(null!==e)switch(typeof e){case\"boolean\":return e?1:0;case\"number\":return f(e);case\"string\":return e.replace(/\\u0002/g,\"\u0002\u0002\").replace(/\\u0001/g,\"\u0001\u0002\").replace(/\\u0000/g,\"\u0001\u0001\");case\"object\":var t=Array.isArray(e),r=t?e:Object.keys(e),o=-1,i=r.length,u=\"\";if(t)for(;++o<i;)u+=n.toIndexableString(r[o]);else for(;++o<i;){var s=r[o];u+=n.toIndexableString(s)+n.toIndexableString(e[s])}return u}return\"\"}function o(e,t){var n,r=t,o=\"1\"===e[t];if(o)n=0,t++;else{var i=\"0\"===e[t];t++;var u=\"\",s=e.substring(t,t+d),c=parseInt(s,10)+l;for(i&&(c=-c),t+=d;;){var a=e[t];if(\"\\x00\"===a)break;u+=a,t++}u=u.split(\".\"),n=1===u.length?parseInt(u,10):parseFloat(u[0]+\".\"+u[1]),i&&(n-=10),0!==c&&(n=parseFloat(n+\"e\"+c))}return{num:n,length:t-r}}function i(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var o=r.element,i=r.index;if(Array.isArray(o))o.push(n);else if(i===e.length-2){var u=e.pop();o[u]=n}else e.push(n)}}function u(e,t){for(var r=Math.min(e.length,t.length),o=0;r>o;o++){var i=n.collate(e[o],t[o]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function s(e,t){return e===t?0:e>t?1:-1}function c(e,t){for(var r=Object.keys(e),o=Object.keys(t),i=Math.min(r.length,o.length),u=0;i>u;u++){var s=n.collate(r[u],o[u]);if(0!==s)return s;if(s=n.collate(e[r[u]],t[o[u]]),0!==s)return s}return r.length===o.length?0:r.length>o.length?1:-1}function a(e){var t=[\"boolean\",\"number\",\"string\",\"object\"],n=t.indexOf(typeof e);return~n?null===e?1:Array.isArray(e)?5:3>n?n+2:n+3:Array.isArray(e)?5:void 0}function f(e){if(0===e)return\"1\";var t=e.toExponential().split(/e\\+?/),n=parseInt(t[1],10),r=0>e,o=r?\"0\":\"2\",i=(r?-n:n)-l,u=p.padLeft(i.toString(),\"0\",d);o+=h+u;var s=Math.abs(parseFloat(t[0]));r&&(s=10-s);var c=s.toFixed(20);return c=c.replace(/\\.?0+$/,\"\"),o+=h+c}var l=-324,d=3,h=\"\",p=e(39);n.collate=function(e,t){if(e===t)return 0;e=n.normalizeKey(e),t=n.normalizeKey(t);var r=a(e),o=a(t);if(r-o!==0)return r-o;if(null===e)return 0;switch(typeof e){case\"number\":return e-t;case\"boolean\":return e===t?0:t>e?-1:1;case\"string\":return s(e,t)}return Array.isArray(e)?u(e,t):c(e,t)},n.normalizeKey=function(e){switch(typeof e){case\"undefined\":return null;case\"number\":return e===1/0||e===-(1/0)||isNaN(e)?null:e;case\"object\":var t=e;if(Array.isArray(e)){var r=e.length;e=new Array(r);for(var o=0;r>o;o++)e[o]=n.normalizeKey(t[o])}else{if(e instanceof Date)return e.toJSON();if(null!==e){e={};for(var i in t)if(t.hasOwnProperty(i)){var u=t[i];\"undefined\"!=typeof u&&(e[i]=n.normalizeKey(u))}}}}return e},n.toIndexableString=function(e){var t=\"\\x00\";return e=n.normalizeKey(e),a(e)+h+r(e)+t},n.parseIndexableString=function(e){for(var t=[],n=[],r=0;;){var u=e[r++];if(\"\\x00\"!==u)switch(u){case\"1\":t.push(null);break;case\"2\":t.push(\"1\"===e[r]),r++;break;case\"3\":var s=o(e,r);t.push(s.num),r+=s.length;break;case\"4\":for(var c=\"\";;){var a=e[r];if(\"\\x00\"===a)break;c+=a,r++}c=c.replace(/\\u0001\\u0001/g,\"\\x00\").replace(/\\u0001\\u0002/g,\"\u0001\").replace(/\\u0002\\u0002/g,\"\u0002\"),t.push(c);break;case\"5\":var f={element:[],index:t.length};t.push(f.element),n.push(f);break;case\"6\":var l={element:{},index:t.length};t.push(l.element),n.push(l);break;default:throw new Error(\"bad collationIndex or unexpectedly reached end of input: \"+u)}else{if(1===t.length)return t.pop();i(t,n)}}}},{39:39}],39:[function(e,t,n){\"use strict\";function r(e,t,n){for(var r=\"\",o=n-e.length;r.length<o;)r+=t;return r}n.padLeft=function(e,t,n){var o=r(e,t,n);return o+e},n.padRight=function(e,t,n){var o=r(e,t,n);return e+o},n.stringLexCompare=function(e,t){var n,r=e.length,o=t.length;for(n=0;r>n;n++){if(n===o)return 1;var i=e.charAt(n),u=t.charAt(n);if(i!==u)return u>i?-1:1}return o>r?-1:0},n.intToDecimalForm=function(e){var t=0>e,n=\"\";do{var r=t?-Math.ceil(e%10):Math.floor(e%10);n=r+n,e=t?Math.ceil(e/10):Math.floor(e/10)}while(e);return t&&\"0\"!==n&&(n=\"-\"+n),n}},{}],40:[function(e,t,n){\"use strict\";function r(e){return null===e?String(e):\"object\"==typeof e||\"function\"==typeof e?a[h.call(e)]||\"object\":typeof e}function o(e){return null!==e&&e===e.window}function i(e){if(!e||\"object\"!==r(e)||e.nodeType||o(e))return!1;try{if(e.constructor&&!p.call(e,\"constructor\")&&!p.call(e.constructor.prototype,\"isPrototypeOf\"))return!1}catch(t){return!1}var n;for(n in e);return void 0===n||p.call(e,n)}function u(e){return\"function\"===r(e)}function s(){for(var e=[],t=-1,n=arguments.length,r=new Array(n);++t<n;)r[t]=arguments[t];var o={};e.push({args:r,result:{container:o,key:\"key\"}});for(var i;i=e.pop();)c(e,i.args,i.result);return o.key}function c(e,t,n){var r,o,s,c,a,f,l,d=t[0]||{},h=1,p=t.length,y=!1,g=/\\d+/;for(\"boolean\"==typeof d&&(y=d,d=t[1]||{},h=2),\"object\"==typeof d||u(d)||(d={}),p===h&&(d=this,--h);p>h;h++)if(null!=(r=t[h])){l=v(r);for(o in r)if(!(o in Object.prototype)){if(l&&!g.test(o))continue;if(s=d[o],c=r[o],d===c)continue;y&&c&&(i(c)||(a=v(c)))?(a?(a=!1,f=s&&v(s)?s:[]):f=s&&i(s)?s:{},e.push({args:[y,f,c],result:{container:d,key:o}})):void 0!==c&&(v(r)&&u(c)||(d[o]=c))}}n.container[n.key]=d}for(var a={},f=[\"Boolean\",\"Number\",\"String\",\"Function\",\"Array\",\"Date\",\"RegExp\",\"Object\",\"Error\"],l=0;l<f.length;l++){var d=f[l];a[\"[object \"+d+\"]\"]=d.toLowerCase()}var h=a.toString,p=a.hasOwnProperty,v=Array.isArray||function(e){return\"array\"===r(e)};t.exports=s},{}],41:[function(e,t,n){(function(t){\"use strict\";function r(e,t,n){return new i(function(r,i){return\"string\"!=typeof t?i(new Error(\"doc id is required\")):void e.get(t,function(u,s){if(u){if(404!==u.status)return i(u);s={}}var c=s._rev,a=n(s);return a?(a._id=t,a._rev=c,void r(o(e,a,n))):r({updated:!1,rev:c})})})}function o(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(o){if(409!==o.status)throw o;return r(e,t._id,n)})}var i;i=\"undefined\"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:\"function\"==typeof t.Promise?t.Promise:e(27),n.upsert=function(e,t,n){var o=this,i=r(o,e,t);return\"function\"!=typeof n?i:void i.then(function(e){n(null,e)},n)},n.putIfNotExists=function(e,t,n){var o=this;\"string\"!=typeof e&&(n=t,t=e,e=t._id);var i=function(e){return e._rev?!1:t},u=r(o,e,i);return\"function\"!=typeof n?u:void u.then(function(e){n(null,e)},n)},\"undefined\"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{27:27}],42:[function(e,t,n){\"use strict\";t.exports=e(43)},{43:43}],43:[function(e,t,n){\"use strict\";t.exports=\"function\"==typeof Promise?Promise:e(44)},{44:44}],44:[function(e,t,n){\"use strict\";function r(){}function o(e){if(\"function\"!=typeof e)throw new TypeError(\"resolver must be a function\");this.state=m,this.queue=[],this.outcome=void 0,e!==r&&c(this,e)}function i(e,t,n){this.promise=e,\"function\"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),\"function\"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){p(function(){var r;try{r=t(n)}catch(o){return v.reject(e,o)}r===e?v.reject(e,new TypeError(\"Cannot resolve promise with itself\")):v.resolve(e,r)})}function s(e){var t=e&&e.then;return e&&\"object\"==typeof e&&\"function\"==typeof t?function(){t.apply(e,arguments)}:void 0}function c(e,t){function n(t){i||(i=!0,v.reject(e,t))}function r(t){i||(i=!0,v.resolve(e,t))}function o(){t(r,n)}var i=!1,u=a(o);\"error\"===u.status&&n(u.value)}function a(e,t){var n={};try{n.value=e(t),n.status=\"success\"}catch(r){n.status=\"error\",n.value=r}return n}function f(e){return e instanceof this?e:v.resolve(new this(r),e)}function l(e){var t=new this(r);return v.reject(t,e)}function d(e){function t(e,t){function r(e){u[t]=e,++s!==o||i||(i=!0,v.resolve(a,u))}n.resolve(e).then(r,function(e){i||(i=!0,v.reject(a,e))})}var n=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var u=new Array(o),s=0,c=-1,a=new this(r);++c<o;)t(e[c],c);return a}function h(e){function t(e){n.resolve(e).then(function(e){i||(i=!0,v.resolve(s,e))},function(e){i||(i=!0,v.reject(s,e))})}var n=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var u=-1,s=new this(r);++u<o;)t(e[u]);return s}var p=e(22),v={},y=[\"REJECTED\"],g=[\"FULFILLED\"],m=[\"PENDING\"];t.exports=n=o,o.prototype[\"catch\"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if(\"function\"!=typeof e&&this.state===g||\"function\"!=typeof t&&this.state===y)return this;var n=new this.constructor(r);if(this.state!==m){var o=this.state===g?e:t;u(n,o,this.outcome)}else this.queue.push(new i(n,e,t));return n},i.prototype.callFulfilled=function(e){v.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){v.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},v.resolve=function(e,t){var n=a(s,t);if(\"error\"===n.status)return v.reject(e,n.value);var r=n.value;if(r)c(e,r);else{e.state=g,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},v.reject=function(e,t){e.state=y,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},n.resolve=f,n.reject=l,n.all=d,n.race=h},{22:22}],45:[function(e,t,n){function r(){if(!s){s=!0;for(var e,t=u.length;t;){e=u,u=[];for(var n=-1;++n<t;)e[n]();t=u.length}s=!1}}function o(){}var i=t.exports={},u=[],s=!1;i.nextTick=function(e){u.push(e),s||setTimeout(r,0)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=o,i.addListener=o,i.once=o,i.off=o,i.removeListener=o,i.removeAllListeners=o,i.emit=o,i.binding=function(e){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(e){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},{}],46:[function(t,n,r){!function(t){if(\"object\"==typeof r)n.exports=t();else if(\"function\"==typeof e&&e.amd)e(t);else{var o;try{o=window}catch(i){o=self}o.SparkMD5=t()}}(function(e){\"use strict\";var t=function(e,t){return e+t&4294967295},n=function(e,n,r,o,i,u){return n=t(t(n,e),t(o,u)),t(n<<i|n>>>32-i,r)},r=function(e,t,r,o,i,u,s){return n(t&r|~t&o,e,t,i,u,s)},o=function(e,t,r,o,i,u,s){return n(t&o|r&~o,e,t,i,u,s)},i=function(e,t,r,o,i,u,s){return n(t^r^o,e,t,i,u,s)},u=function(e,t,r,o,i,u,s){return n(r^(t|~o),e,t,i,u,s)},s=function(e,n){var s=e[0],c=e[1],a=e[2],f=e[3];s=r(s,c,a,f,n[0],7,-680876936),f=r(f,s,c,a,n[1],12,-389564586),a=r(a,f,s,c,n[2],17,606105819),c=r(c,a,f,s,n[3],22,-1044525330),s=r(s,c,a,f,n[4],7,-176418897),f=r(f,s,c,a,n[5],12,1200080426),a=r(a,f,s,c,n[6],17,-1473231341),c=r(c,a,f,s,n[7],22,-45705983),s=r(s,c,a,f,n[8],7,1770035416),f=r(f,s,c,a,n[9],12,-1958414417),a=r(a,f,s,c,n[10],17,-42063),c=r(c,a,f,s,n[11],22,-1990404162),s=r(s,c,a,f,n[12],7,1804603682),f=r(f,s,c,a,n[13],12,-40341101),a=r(a,f,s,c,n[14],17,-1502002290),c=r(c,a,f,s,n[15],22,1236535329),s=o(s,c,a,f,n[1],5,-165796510),f=o(f,s,c,a,n[6],9,-1069501632),a=o(a,f,s,c,n[11],14,643717713),c=o(c,a,f,s,n[0],20,-373897302),s=o(s,c,a,f,n[5],5,-701558691),f=o(f,s,c,a,n[10],9,38016083),a=o(a,f,s,c,n[15],14,-660478335),c=o(c,a,f,s,n[4],20,-405537848),s=o(s,c,a,f,n[9],5,568446438),f=o(f,s,c,a,n[14],9,-1019803690),a=o(a,f,s,c,n[3],14,-187363961),c=o(c,a,f,s,n[8],20,1163531501),s=o(s,c,a,f,n[13],5,-1444681467),f=o(f,s,c,a,n[2],9,-51403784),a=o(a,f,s,c,n[7],14,1735328473),c=o(c,a,f,s,n[12],20,-1926607734),s=i(s,c,a,f,n[5],4,-378558),f=i(f,s,c,a,n[8],11,-2022574463),a=i(a,f,s,c,n[11],16,1839030562),c=i(c,a,f,s,n[14],23,-35309556),s=i(s,c,a,f,n[1],4,-1530992060),f=i(f,s,c,a,n[4],11,1272893353),a=i(a,f,s,c,n[7],16,-155497632),c=i(c,a,f,s,n[10],23,-1094730640),s=i(s,c,a,f,n[13],4,681279174),f=i(f,s,c,a,n[0],11,-358537222),a=i(a,f,s,c,n[3],16,-722521979),c=i(c,a,f,s,n[6],23,76029189),s=i(s,c,a,f,n[9],4,-640364487),f=i(f,s,c,a,n[12],11,-421815835),a=i(a,f,s,c,n[15],16,530742520),c=i(c,a,f,s,n[2],23,-995338651),s=u(s,c,a,f,n[0],6,-198630844),f=u(f,s,c,a,n[7],10,1126891415),a=u(a,f,s,c,n[14],15,-1416354905),c=u(c,a,f,s,n[5],21,-57434055),s=u(s,c,a,f,n[12],6,1700485571),f=u(f,s,c,a,n[3],10,-1894986606),a=u(a,f,s,c,n[10],15,-1051523),c=u(c,a,f,s,n[1],21,-2054922799),s=u(s,c,a,f,n[8],6,1873313359),f=u(f,s,c,a,n[15],10,-30611744),a=u(a,f,s,c,n[6],15,-1560198380),c=u(c,a,f,s,n[13],21,1309151649),s=u(s,c,a,f,n[4],6,-145523070),f=u(f,s,c,a,n[11],10,-1120210379),a=u(a,f,s,c,n[2],15,718787259),c=u(c,a,f,s,n[9],21,-343485551),e[0]=t(s,e[0]),e[1]=t(c,e[1]),e[2]=t(a,e[2]),e[3]=t(f,e[3])},c=function(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n},a=function(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n},f=function(e){var t,n,r,o,i,u,a=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;a>=t;t+=64)s(f,c(e.substring(t-64,t)));for(e=e.substring(t-64),n=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;n>t;t+=1)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(s(f,r),t=0;16>t;t+=1)r[t]=0;return o=8*a,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),u=parseInt(o[1],16)||0,r[14]=i,r[15]=u,s(f,r),f},l=function(e){var t,n,r,o,i,u,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;c>=t;t+=64)s(f,a(e.subarray(t-64,t)));for(e=c>t-64?e.subarray(t-64):new Uint8Array(0),n=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;n>t;t+=1)r[t>>2]|=e[t]<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(s(f,r),t=0;16>t;t+=1)r[t]=0;return o=8*c,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),u=parseInt(o[1],16)||0,r[14]=i,r[15]=u,s(f,r),f},d=[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\"],h=function(e){var t,n=\"\";for(t=0;4>t;t+=1)n+=d[e>>8*t+4&15]+d[e>>8*t&15];return n},p=function(e){var t;for(t=0;t<e.length;t+=1)e[t]=h(e[t]);return e.join(\"\")},v=function(e){return p(f(e))},y=function(){this.reset()};return\"5d41402abc4b2a76b9719d911017c592\"!==v(\"hello\")&&(t=function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}),y.prototype.append=function(e){return/[\\u0080-\\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),this.appendBinary(e),this},y.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,n=this._buff.length;for(t=64;n>=t;t+=64)s(this._state,c(this._buff.substring(t-64,t)));return this._buff=this._buff.substr(t-64),this},y.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;o>t;t+=1)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),n=e?this._state:p(this._state),this.reset(),n},y.prototype._finish=function(e,t){var n,r,o,i=t;if(e[i>>2]|=128<<(i%4<<3),i>55)for(s(this._state,e),i=0;16>i;i+=1)e[i]=0;n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=r,e[15]=o,s(this._state,e)},y.prototype.reset=function(){return this._buff=\"\",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},y.hash=function(e,t){/[\\u0080-\\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e)));var n=f(e);return t?n:p(n)},y.hashBinary=function(e,t){var n=f(e);return t?n:p(n)},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(e){var t,n=this._concatArrayBuffer(this._buff,e),r=n.length;for(this._length+=e.byteLength,t=64;r>=t;t+=64)s(this._state,a(n.subarray(t-64,t)));return this._buff=r>t-64?n.subarray(t-64):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;o>t;t+=1)i[t>>2]|=r[t]<<(t%4<<3);return this._finish(i,o),n=e?this._state:p(this._state),this.reset(),n},y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._concatArrayBuffer=function(e,t){var n=e.length,r=new Uint8Array(n+t.byteLength);return r.set(e),r.set(new Uint8Array(t),n),r},y.ArrayBuffer.hash=function(e,t){var n=l(new Uint8Array(e));return t?n:p(n)},y})},{}],47:[function(e,t,n){\"use strict\";var r=e(17),o=e(6),i=e(14);n.createIndex=r.toPromise(function(e,t){if(\"object\"!=typeof e)return t(new Error(\"you must provide an index to create\"));var n=\"http\"===this.type()?o:i;n.createIndex(this,e,t)}),n.find=r.toPromise(function(e,t){if(\"undefined\"==typeof t&&(t=e,e=void 0),\"object\"!=typeof e)return t(new Error(\"you must provide search parameters to find()\"));var n=\"http\"===this.type()?o:i;n.find(this,e,t)}),n.getIndexes=r.toPromise(function(e){var t=\"http\"===this.type()?o:i;t.getIndexes(this,e)}),n.deleteIndex=r.toPromise(function(e,t){if(\"object\"!=typeof e)return t(new Error(\"you must provide an index to delete\"));var n=\"http\"===this.type()?o:i;n.deleteIndex(this,e,t)}),\"undefined\"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{14:14,17:17,6:6}]},{},[47])(47)});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/pouchdb-find/dist/pouchdb.find.min.js\n ** module id = 116\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./bower_components/pouchdb-find/dist/pouchdb.find.min.js?");

/***/ },
/* 117 */
/*!*************************************************************!*\
  !*** ./bower_components/angular-pouchdb/angular-pouchdb.js ***!
  \*************************************************************/
/***/ function(module, exports) {

	eval("if (typeof module !== 'undefined' && typeof exports !== 'undefined' && module.exports === exports) {\n  module.exports = 'pouchdb';\n}\n\n(function(window, angular, undefined) {\n'use strict';\n\nangular.module('pouchdb', [])\n  .constant('POUCHDB_METHODS', {\n    destroy: 'qify',\n    put: 'qify',\n    post: 'qify',\n    get: 'qify',\n    remove: 'qify',\n    bulkDocs: 'qify',\n    bulkGet: 'qify',\n    allDocs: 'qify',\n    putAttachment: 'qify',\n    getAttachment: 'qify',\n    removeAttachment: 'qify',\n    query: 'qify',\n    viewCleanup: 'qify',\n    info: 'qify',\n    compact: 'qify',\n    revsDiff: 'qify',\n    changes: 'eventEmitter',\n    sync: 'eventEmitter',\n    replicate: {\n      to: 'eventEmitter',\n      from: 'eventEmitter'\n    }\n  })\n  .service('pouchDBDecorators', [\"$q\", function($q) {\n    this.qify = function(fn) {\n      return function() {\n        return $q.when(fn.apply(this, arguments));\n      };\n    };\n\n    this.eventEmitter = function(fn) {\n      return function() {\n        var deferred = $q.defer();\n        var emitter = fn.apply(this, arguments)\n          .on('change', function(change) {\n            return deferred.notify({\n              change: change\n            });\n          })\n          .on('paused', function(paused) {\n            return deferred.notify({\n              paused: paused\n            });\n          })\n          .on('active', function(active) {\n            return deferred.notify({\n              active: active\n            });\n          })\n          .on('denied', function(denied) {\n            return deferred.notify({\n              denied: denied\n            });\n          })\n          .on('complete', function(response) {\n            return deferred.resolve(response);\n          })\n          .on('error', function(error) {\n            return deferred.reject(error);\n          });\n        emitter.$promise = deferred.promise;\n        return emitter;\n      };\n    };\n  }])\n  .provider('pouchDB', [\"POUCHDB_METHODS\", function(POUCHDB_METHODS) {\n    var self = this;\n    self.methods = POUCHDB_METHODS;\n    self.$get = [\"$window\", \"pouchDBDecorators\", function($window, pouchDBDecorators) {\n      function wrapMethods(db, methods, parent) {\n        for (var method in methods) {\n          var wrapFunction = methods[method];\n\n          if (!angular.isString(wrapFunction)) {\n            wrapMethods(db, wrapFunction, method);\n            continue;\n          }\n\n          wrapFunction = pouchDBDecorators[wrapFunction];\n\n          if (!parent) {\n            db[method] = wrapFunction(db[method]);\n            continue;\n          }\n\n          db[parent][method] = wrapFunction(db[parent][method]);\n        }\n        return db;\n      }\n\n      return function pouchDB(name, options) {\n        var db = new $window.PouchDB(name, options);\n        return wrapMethods(db, self.methods);\n      };\n    }];\n  }]);\n})(window, window.angular);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/angular-pouchdb/angular-pouchdb.js\n ** module id = 117\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./bower_components/angular-pouchdb/angular-pouchdb.js?");

/***/ },
/* 118 */
/*!*************************************!*\
  !*** ./src/app/misc/BuildConfig.js ***!
  \*************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\tangular.module('opennms.services.BuildConfig', [])\n\t\t.constant('config.build.version', 'Unknown')\n\t\t.constant('config.build.build', 'Unknown')\n\t\t.constant('config.build.debug', true)\n\t\t.constant('config.build.analyticsIdIos', undefined)\n\t\t.constant('config.build.analyticsIdAndroid', undefined)\n\t\t.constant('config.build.analyticsIdOther', undefined)\n\t\t.constant('config.build.admobIdIosBanner', undefined)\n\t\t.constant('config.build.admobIdIosInterstitial', undefined)\n\t\t.constant('config.build.admobIdAndroidBanner', undefined)\n\t\t.constant('config.build.admobIdAndroidInterstitial', undefined)\n\t\t.constant('config.build.admobIdOtherBanner', undefined)\n\t\t.constant('config.build.admobIdOtherInterstitial', undefined)\n\t\t.constant('config.build.ionicPublicKey', undefined)\n\t;\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/BuildConfig.js\n ** module id = 118\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/BuildConfig.js?");

/***/ },
/* 119 */
/*!******************************!*\
  !*** ./src/app/misc/Info.js ***!
  \******************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tVersionCompare = __webpack_require__(/*! version_compare */ 120);\n\n\t__webpack_require__(/*! ./Rest */ 121);\n\t__webpack_require__(/*! ./util */ 129);\n\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\n\tangular.module('opennms.services.Info', [\n\t\t'ionic',\n\t\t'opennms.services.Rest',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Util'\n\t])\n\t.value('info', {\n\t\tversion: '0.0.0',\n\t\tnumericVersion: 0.0,\n\t\tdisplayVersion: 'Unknown',\n\t\tpackageName: 'opennms',\n\t\tpackageDescription: 'OpenNMS'\n\t})\n\t.factory('Info', function($q, $rootScope, $http, $injector, $log, $window, $timeout, RestService, Servers, util) {\n\t\t$log.info('Info: Initializing.');\n\n\t\tvar onSuccess = function(data) {\n\t\t\t//$log.debug('info success=' + angular.toJson(data));\n\t\t\tdata.numericVersion = parseFloat(data.version.replace('^(\\\\d+\\\\.\\\\d+).*$', '$1'));\n\t\t\tvar info = $injector.get('info');\n\t\t\tangular.extend(info, data);\n\t\t\t$rootScope.$broadcast('opennms.info.updated', info);\n\t\t};\n\n\t\tvar updateInfo = function() {\n\t\t\tServers.getDefault().then(function(server) {\n\t\t\t\tif (!server) {\n\t\t\t\t\t$log.debug('Info.updateInfo: skipping update, server is not configured yet.');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$log.info('Info.updateInfo: Initializing.');\n\n\t\t\t\tRestService.get('/info', {limit:0}, {Accept: 'application/json'}).then(function(response) {\n\t\t\t\t\tif (angular.isString(response)) {\n\t\t\t\t\t\tresponse = angular.fromJson(response);\n\t\t\t\t\t}\n\t\t\t\t\tonSuccess(response);\n\t\t\t\t\treturn response;\n\t\t\t\t}, function(err) {\n\t\t\t\t\t$log.error('Info.updateInfo: failed: ' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tutil.onSettingsUpdated(updateInfo);\n\t\tutil.onServersUpdated(updateInfo);\n\t\t$timeout(updateInfo);\n\n\t\treturn {\n\t\t\tget: function() {\n\t\t\t\treturn $injector.get('info');\n\t\t\t},\n\t\t\tvalidateVersion: function(version) {\n\t\t\t\treturn VersionCompare.gte($injector.get('info').version, version);\n\t\t\t},\n\t\t\tisMeridian: function() {\n\t\t\t\treturn $injector.get('info').packageName === 'meridian';\n\t\t\t}\n\t\t};\n\t})\n\t;\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Info.js\n ** module id = 119\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Info.js?");

/***/ },
/* 120 */,
/* 121 */
/*!******************************!*\
  !*** ./src/app/misc/Rest.js ***!
  \******************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tRestError = __webpack_require__(/*! ./RestError */ 122),\n\t\tURI = __webpack_require__(/*! urijs */ 123),\n\t\tX2JS = __webpack_require__(/*! x2js/xml2json */ 127);\n\n\t__webpack_require__(/*! ./HTTP */ 128);\n\t__webpack_require__(/*! ./util */ 129);\n\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\tangular.module('opennms.services.Rest', [\n\t\t'ng',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Settings',\n\t\t'opennms.services.Util',\n\t\t'opennms.util.HTTP'\n\t])\n\n\t.factory('RestService', function($q, $rootScope, $http, $log, $window, HTTP, $injector, Servers, Settings, util) {\n\t\t$log.info('RestService: Initializing.');\n\n\t\tvar ready = $q.defer();\n\n\t\tvar x2js = new X2JS();\n\n\t\tvar clearCookies = function() {\n\t\t\tvar deferred = $q.defer();\n\t\t\tif ($window.cookies && $window.cookies.clear) {\n\t\t\t\t$window.cookies.clear(function() {\n\t\t\t\t\tdeferred.resolve(true);\n\t\t\t\t}, function() {\n\t\t\t\t\tdeferred.resolve(false);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdeferred.resolve(false);\n\t\t\t}\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar updateAuthorization = function() {\n\t\t\tvar username, password;\n\n\t\t\tvar oldReady = ready;\n\t\t\tready = $q.defer();\n\n\t\t\tvar done = function(reject) {\n\t\t\t\tif (oldReady) {\n\t\t\t\t\tif (reject) {\n\t\t\t\t\t\toldReady.reject(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\toldReady.resolve(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (reject) {\n\t\t\t\t\tready.reject(false);\n\t\t\t\t} else {\n\t\t\t\t\tready.resolve(true);\n\t\t\t\t}\n\t\t\t\treturn ready.promise;\n\t\t\t};\n\n\t\t\treturn clearCookies().then(function() {\n\t\t\t\t$log.debug('RestService.updateAuthorization: cleared cookies.');\n\t\t\t\treturn Servers.getDefault();\n\t\t\t}).then(function(server) {\n\t\t\t\t$log.debug('update authorization: default server = ' + (server && server.name? server.name:'unknown'));\n\t\t\t\t//$log.debug('username=' + server.username +', password=' + server.password);\n\t\t\t\tif (!server || angular.isUndefined(server.username) || angular.isUndefined(server.password)) {\n\t\t\t\t\t$log.info('RestService.updateAuthorization: username or password not set.');\n\t\t\t\t\tdelete $http.defaults.headers.common['Authorization'];\n\t\t\t\t\tHTTP.useBasicAuth(undefined, undefined).then(function() {\n\t\t\t\t\t\t$log.debug('RestService.updateAuthorization: unconfigured basic auth.');\n\t\t\t\t\t\treturn done();\n\t\t\t\t\t}, function(err) {\n\t\t\t\t\t\t$log.error('RestService.updateAuthorization: failed to unconfigure basic auth.');\n\t\t\t\t\t\treturn done();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t//$log.debug('RestService.updateAuthorization: setting basic auth with username \"' + server.username + '\".');\n\t\t\t\t\t$http.defaults.headers.common['Authorization'] = 'Basic ' + $window.btoa(server.username + ':' + server.password);\n\t\t\t\t\tHTTP.useBasicAuth(server.username, server.password).then(function() {\n\t\t\t\t\t\t$log.debug('RestService.updateAuthorization: configured basic auth with username \"' + server.username + '\".');\n\t\t\t\t\t\treturn done();\n\t\t\t\t\t}, function(err) {\n\t\t\t\t\t\t$log.error('RestService.updateAuthorization: failed to configure basic auth with username \"' + server.username + '\".');\n\t\t\t\t\t\treturn done();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('RestService.updateAuthorization: failed: ' + angular.toJson(err));\n\t\t\t\treturn done(true);\n\t\t\t});\n\t\t};\n\n\t\tvar getUrl = function(restFragment) {\n\t\t\t//$log.debug('RestService.getUrl: restFragment='+restFragment);\n\t\t\treturn ready.promise.then(function() {\n\t\t\t\t//$log.debug('RestService.getUrl: ready');\n\t\t\t\treturn Servers.getDefault();\n\t\t\t}).then(function(server) {\n\t\t\t\tvar restURL = server? server.restUrl() : undefined;\n\t\t\t\t//$log.debug('RestService.getUrl: restURL=' + restURL);\n\t\t\t\tif (restURL) {\n\t\t\t\t\tvar uri = URI(restURL);\n\t\t\t\t\tif (restFragment.startsWith('/')) {\n\t\t\t\t\t\trestFragment = restFragment.slice(1);\n\t\t\t\t\t}\n\t\t\t\t\turi.segment(restFragment);\n\t\t\t\t\t//$log.debug('RestService.getUrl: returning=' + uri.toString());\n\t\t\t\t\treturn uri.toString();\n\t\t\t\t} else {\n\t\t\t\t\t//$log.debug('RestService.getUrl: returning=undefined');\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar encodeData = function(data) {\n\t\t\treturn Object.keys(data).map(function(key) {\n\t\t\t\treturn [key, data[key]].map(encodeURIComponent).join('=');\n\t\t\t}).join('&');\n\t\t};\n\n\t\tvar doQuery = function(method, restFragment, params, headers) {\n\t\t\tif (!params) {\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tif (!headers) {\n\t\t\t\theaders = {};\n\t\t\t}\n\n\t\t\tvar url;\n\t\t\treturn Servers.getDefault().then(function(server) {\n\t\t\t\t//$log.debug('Rest.doQuery: ' + method + ' ' + restFragment + ': isServerConfigured=' + serverConfigured);\n\t\t\t\tif (server) {\n\t\t\t\t\treturn getUrl(restFragment);\n\t\t\t\t} else {\n\t\t\t\t\treturn $q.reject(new RestError(restFragment, undefined, 0, 'Server information is not complete.'));\n\t\t\t\t}\n\t\t\t}).then(function(u) {\n\t\t\t\t//$log.debug('Rest.doQuery: ' + method + ' ' + restFragment + ': url=' + u);\n\t\t\t\turl = u;\n\t\t\t\treturn Settings.restLimit();\n\t\t\t}).then(function(restLimit) {\n\t\t\t\tvar myparams = angular.extend({}, { limit: restLimit }, params);\n\t\t\t\tif (myparams.limit === 0) {\n\t\t\t\t\tdelete myparams.limit;\n\t\t\t\t}\n\t\t\t\treturn myparams;\n\t\t\t}).then(function(myparams) {\n\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t//$log.debug('Rest.doQuery: url=' + url + ', params=' + angular.toJson(myparams) + ', headers=' + angular.toJson(headers));\n\n\t\t\t\treturn HTTP.call({\n\t\t\t\t\tmethod: method,\n\t\t\t\t\turl: url,\n\t\t\t\t\tparams: myparams,\n\t\t\t\t\theaders: headers,\n\t\t\t\t\twithCredentials: true\n\t\t\t\t}).then(function(response) {\n\t\t\t\t\treturn response.data;\n\t\t\t\t}, function(response) {\n\t\t\t\t\tvar err = new RestError(url, response.data, response.status, response.statusText);\n\t\t\t\t\t//$log.debug('Rest.doQuery failed: ' + err.toString());\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t});\n\n\t\t\t}, function(err) {\n\t\t\t\t$log.debug('Rest.doQuery: failed: ' + angular.toJson(err));\n\t\t\t\treturn $q.reject(err);\n\t\t\t});\n\t\t};\n\n\t\tvar doGet = function(restFragment, params, headers) {\n\t\t\treturn doQuery('GET', restFragment, params, headers);\n\t\t};\n\n\t\tvar doPut = function(restFragment, params, headers) {\n\t\t\tvar h = angular.copy(headers) || {};\n\t\t\th['Content-Type'] = 'application/x-www-form-urlencoded';\n\t\t\treturn doQuery('PUT', restFragment, params, h);\n\t\t};\n\n\t\tvar doPostXml = function(restFragment, data, headers) {\n\t\t\treturn Servers.getDefault().then(function(server) {\n\t\t\t\tif (server) {\n\t\t\t\t\treturn getUrl(restFragment);\n\t\t\t\t} else {\n\t\t\t\t\treturn $q.reject(new RestError(restFragment, undefined, 0, 'Server information is not complete.'));\n\t\t\t\t}\n\t\t\t}).then(function(url) {\n\t\t\t\tif (!headers) {\n\t\t\t\t\theaders = {};\n\t\t\t\t}\n\t\t\t\tif (!headers['Content-Type']) {\n\t\t\t\t\theaders['Content-Type'] = 'application/xml';\n\t\t\t\t}\n\n\t\t\t\treturn $http.post(url, data, {\n\t\t\t\t\twithCredentials: true,\n\t\t\t\t\theaders: headers\n\t\t\t\t}).success(function(data) {\n\t\t\t\t\t//$log.debug('Rest.doQuery:',data);\n\t\t\t\t\treturn data;\n\t\t\t\t}).error(function(data, status, headers, config, statusText) {\n\t\t\t\t\treturn $q.reject(new RestError(url, data, status, statusText));\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tutil.onServersUpdated(updateAuthorization);\n\t\tupdateAuthorization();\n\n\t\treturn {\n\t\t\turl: getUrl,\n\t\t\tget: function(restFragment, params, headers) {\n\t\t\t\treturn doGet(restFragment, params, headers).then(function(data) {\n\t\t\t\t\tvar json;\n\t\t\t\t\tif (data && angular.isString(data)) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tjson = angular.fromJson(data);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t$log.error('Rest.get: failed to parse \"' + data + '\" as JSON: ' + angular.toJson(error));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (json !== undefined) {\n\t\t\t\t\t\treturn json;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetXml: function(restFragment, params, headers) {\n\t\t\t\treturn doGet(restFragment, params, headers).then(function(data) {\n\t\t\t\t\tvar json = x2js.xml_str2json(data);\n\t\t\t\t\t//$log.debug('Rest.getXml:',json);\n\t\t\t\t\treturn json;\n\t\t\t\t});\n\t\t\t},\n\t\t\tput: doPut,\n\t\t\tpostXml: doPostXml\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Rest.js\n ** module id = 121\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Rest.js?");

/***/ },
/* 122 */
/*!***********************************!*\
  !*** ./src/app/misc/RestError.js ***!
  \***********************************/
/***/ function(module, exports, __webpack_require__) {

	eval("var moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name RestError\n * @param {string} url the URL requested\n * @param {object} data the data returned by the ReST call\n * @param {number} status the status code\n * @param {string} statusText the status text\n * @param {moment} time the time of the error\n * @constructor\n */\nfunction RestError(url, data, status, statusText, time) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name RestError#url\n   * @propertyOf RestError\n   * @returns {string} The request URL.\n   */\n  self.url = url;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name RestError#data\n   * @propertyOf RestError\n   * @returns {Object} The data returned by the server.\n   */\n  self.data = data;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name RestError#status\n   * @propertyOf RestError\n   * @returns {number} The status code returned by the server.\n   */\n  self.status = parseInt(status, 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name RestError#statusText\n   * @propertyOf RestError\n   * @returns {string} The status text returned by the server (if any).\n   */\n  self.statusText = statusText;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name RestError#time\n   * @propertyOf RestError\n   * @returns {moment} The time the error occurred.\n   */\n  self.time = time || moment();\n\n}\n\nRestError.prototype.permissionDenied = function() {\n  'use strict';\n  return this.status === 401 || this.status === 403;\n};\n\nRestError.prototype.toString = function() {\n  'use strict';\n  var self = this, ret = 'Error ';\n  if (self.status && self.status > 0) {\n    ret += this.status + ' ';\n  }\n  ret += 'requesting URL ' + self.url + ': ';\n  if (self.caller) {\n    ret = self.caller + ': ' + ret;\n  }\n  if (self.statusText) {\n    ret += ' ' + self.statusText;\n  } else if (self.permissionDenied()) {\n    ret += ' Permission denied.';\n  }\n  ret += ' [' + self.time.format('lll') + ']';\n  return ret;\n};\n\nmodule.exports = RestError;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/RestError.js\n ** module id = 122\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/RestError.js?");

/***/ },
/* 123 */,
/* 124 */,
/* 125 */,
/* 126 */,
/* 127 */,
/* 128 */
/*!******************************!*\
  !*** ./src/app/misc/HTTP.js ***!
  \******************************/
/***/ function(module, exports) {

	eval("'use strict';\n\nvar module = angular.module('opennms.util.HTTP', [\n\t'ng'\n]);\n\nionic.Platform.ready(function() {\n\tif (window.cordovaHTTP) {\n\t\t/* eslint-disable no-console */\n\t\tconsole.log('window.cordovaHTTP found.');\n\t\t/* eslint-enable no-console */\n\t\tmodule.factory('cordovaHTTP', function($timeout, $q) {\n\t\t\tfunction makePromise(fn, args, async) {\n\t\t\t\tvar deferred = $q.defer();\n\n\t\t\t\tvar success = function(response) {\n\t\t\t\t\tif (async) {\n\t\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\t\tdeferred.resolve(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeferred.resolve(response);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tvar fail = function(response) {\n\t\t\t\t\tif (async) {\n\t\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\t\tdeferred.reject(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeferred.reject(response);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\targs.push(success);\n\t\t\t\targs.push(fail);\n\n\t\t\t\tfn.apply(cordovaHTTP, args);\n\n\t\t\t\treturn deferred.promise;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tuseBasicAuth: function(username, password) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.useBasicAuth, [username, password]);\n\t\t\t\t},\n\t\t\t\tsetHeader: function(header, value) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.setHeader, [header, value]);\n\t\t\t\t},\n\t\t\t\tenableSSLPinning: function(enable) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.enableSSLPinning, [enable]);\n\t\t\t\t},\n\t\t\t\tacceptAllCerts: function(allow) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.acceptAllCerts, [allow]);\n\t\t\t\t},\n\t\t\t\tsetTimeouts: function(connectionTimeout, readTimeout) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.setTimeouts, [connectionTimeout, readTimeout]);\n\t\t\t\t},\n\t\t\t\thead: function(url, params, headers) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.head, [url, params, headers], true);\n\t\t\t\t},\n\t\t\t\tpost: function(url, params, headers) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.post, [url, params, headers], true);\n\t\t\t\t},\n\t\t\t\tput: function(url, params, headers) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.put, [url, params, headers], true);\n\t\t\t\t},\n\t\t\t\tdelete: function(url, params, headers) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.delete, [url, params, headers], true);\n\t\t\t\t},\n\t\t\t\tget: function(url, params, headers) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.get, [url, params, headers], true);\n\t\t\t\t},\n\t\t\t\tuploadFile: function(url, params, headers, filePath, name) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.uploadFile, [url, params, headers, filePath, name], true);\n\t\t\t\t},\n\t\t\t\tdownloadFile: function(url, params, headers, filePath) {\n\t\t\t\t\treturn makePromise(cordovaHTTP.downloadFile, [url, params, headers, filePath], true);\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t} else {\n\t\t/* eslint-disable no-console */\n\t\tconsole.log('!!!! window.cordovaHTTP NOT found.');\n\t\t/* eslint-enable no-console */\n\t}\n});\n\nmodule.factory('HTTP', function($http, $injector, $log, $q, $window) {\n\t//var requestTimeout = parseInt($injector.get('config.request.timeout'), 10) * 1000;\n\tvar requestTimeout = 10000;\n\tvar enableCachebusting = false;\n\n\tvar ready;\n\tvar initialize = function() {\n\t\tvar deferred = $q.defer();\n\n\t\tif ($injector.has('cordovaHTTP')) {\n\t\t\t$log.info('HTTP: Cordova HTTP is available.');\n\t\t\tvar cordovaHTTP = $injector.get('cordovaHTTP');\n\t\t\tcordovaHTTP.enableSSLPinning(false);\n\t\t\tcordovaHTTP.acceptAllCerts(true);\n\t\t\tcordovaHTTP.setTimeouts(requestTimeout, requestTimeout);\n\t\t\tdeferred.resolve(cordovaHTTP);\n\t\t} else {\n\t\t\t$log.warn('HTTP: Cordova HTTP is not available.');\n\t\t\tdeferred.resolve(undefined);\n\t\t}\n\t\treturn deferred.promise;\n\t};\n\n\tvar defaultOptions = {\n\t\tcache: false,\n\t\ttimeout: requestTimeout,\n\t\theaders: {\n\t\t\tAccept: 'application/xml'\n\t\t}\n\t};\n\n\tvar call = function(passedOptions) {\n\t\tvar options = angular.extend({}, defaultOptions, passedOptions);\n\n\t\tif (!ready) {\n\t\t\tready = initialize();\n\t\t}\n\n\t\treturn ready.then(function(cordovaHTTP) {\n\t\t\tif (options.url.indexOf('http') !== 0) {\n\t\t\t\treturn $q.reject(options.url + ' is not a valid URL!');\n\t\t\t}\n\n\t\t\tif (!options.params) {\n\t\t\t\toptions.params = {};\n\t\t\t}\n\n\t\t\tif (options.method === 'GET' && enableCachebusting) {\n\t\t\t\toptions.params._x = new Date().getTime();\n\t\t\t}\n\n\t\t\tif (options.params.cache) {\n\t\t\t\t// disable cachebusting for this request\n\t\t\t\toptions.cache = true;\n\t\t\t\tdelete options.params._x;\n\t\t\t\tdelete options.params.cache;\n\t\t\t}\n\n\t\t\t//$log.debug('Making HTTP call with options:' + angular.toJson(options));\n\t\t\tif (cordovaHTTP) {\n\t\t\t\tvar handleSuccess = function(response) {\n\t\t\t\t\t//$log.debug('HTTP.handleSuccess: ' + angular.toJson(response.data));\n\t\t\t\t\treturn response;\n\t\t\t\t};\n\t\t\t\tvar handleError = function(err) {\n\t\t\t\t\t$log.error('HTTP.handleError: ' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t};\n\n\t\t\t\tif (options.method === 'GET') {\n\t\t\t\t\treturn cordovaHTTP.get(options.url, options.params, options.headers).then(handleSuccess, handleError);\n\t\t\t\t} else if (options.method === 'HEAD') {\n\t\t\t\t\treturn cordovaHTTP.head(options.url, options.params, options.headers).then(handleSuccess, handleError);\n\t\t\t\t} else if (options.method === 'PUT') {\n\t\t\t\t\toptions.params = angular.extend({}, options.data, options.params);\n\t\t\t\t\treturn cordovaHTTP.put(options.url, options.params, options.headers).then(handleSuccess, handleError);\n\t\t\t\t} else if (options.method === 'POST') {\n\t\t\t\t\toptions.params = angular.extend({}, options.data, options.params);\n\t\t\t\t\treturn cordovaHTTP.post(options.url, options.params, options.headers).then(handleSuccess, handleError);\n\t\t\t\t} else if (options.method === 'DELETE') {\n\t\t\t\t\treturn cordovaHTTP.delete(options.url, options.params, options.headers).then(handleSuccess, handleError);\n\t\t\t\t} else {\n\t\t\t\t\t$log.error('HTTP: Unknown method: ' + options.method);\n\t\t\t\t\treturn $q.reject('Unknown method: ' + options.method);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn $http(options);\n\t\t\t}\n\t\t});\n\t};\n\n\tvar get = function(url, options) {\n\t\toptions.method = 'GET';\n\t\toptions.url = url;\n\t\treturn call(options);\n\t};\n\n\tvar del = function(url, options) {\n\t\toptions.method = 'DELETE';\n\t\toptions.url = url;\n\t\treturn call(options);\n\t};\n\n\tvar post = function(url, options) {\n\t\toptions.method = 'POST';\n\t\toptions.url = url;\n\t\treturn call(options);\n\t};\n\n\tvar put = function(url, options) {\n\t\toptions.method = 'PUT';\n\t\toptions.url = url;\n\t\treturn call(options);\n\t};\n\n\tvar useBasicAuth = function(username, password) {\n\t\tif (!ready) {\n\t\t\tready = initialize();\n\t\t}\n\t\treturn ready.then(function(cordovaHTTP) {\n\t\t\tif (cordovaHTTP) {\n\t\t\t\tcordovaHTTP.useBasicAuth(username, password);\n\t\t\t}\n\t\t});\n\t};\n\n\treturn {\n\t\tget: get,\n\t\tdel: del,\n\t\tpost: post,\n\t\tput: put,\n\t\tcall: call,\n\t\tuseBasicAuth: useBasicAuth\n\t};\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/HTTP.js\n ** module id = 128\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/HTTP.js?");

/***/ },
/* 129 */
/*!******************************!*\
  !*** ./src/app/misc/util.js ***!
  \******************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\t/* global cordova: true */\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tlodash = __webpack_require__(/*! lodash */ 130),\n\t\tAddress6 = __webpack_require__(/*! ip-address */ 131).Address6;\n\n\t__webpack_require__(/*! ngCordova */ 9);\n\n\t__webpack_require__(/*! ./Analytics */ 12);\n\t__webpack_require__(/*! ./Errors */ 166);\n\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\tangular.module('opennms.services.Util', [\n\t\t'ionic',\n\t\t'ngCordova',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Settings'\n\t])\n\t.filter('ip', function() {\n\t\treturn function(addr) {\n\t\t\tif (addr && addr.contains(':')) {\n\t\t\t\tvar address = new Address6(addr);\n\t\t\t\tif (address.isValid()) {\n\t\t\t\t\treturn address.correctForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn addr;\n\t\t};\n\t})\n\t.factory('UtilEventBroadcaster', function($rootScope, $log) {\n\t\tvar markDirty = function(type) {\n\t\t\t$log.debug('util.markDirty: ' + type);\n\t\t\t$rootScope.$broadcast('opennms.dirty', type);\n\t\t};\n\n\t\tvar defaultServerUpdated = function(server) {\n\t\t\t$log.debug('util.defaultServerUpdated: ' + angular.toJson(server));\n\t\t\t$rootScope.$broadcast('opennms.servers.defaultUpdated', server);\n\t\t};\n\n\t\tvar serversUpdated = function(newServers, oldServers) {\n\t\t\t$log.debug('util.serversUpdated: ' + angular.toJson(newServers));\n\t\t\t$rootScope.$broadcast('opennms.servers.updated', newServers, oldServers);\n\t\t};\n\n\t\tvar serverRemoved = function(server) {\n\t\t\t$log.debug('util.serversUpdated: ' + server.name);\n\t\t\t$rootScope.$broadcast('opennms.servers.removed', server);\n\t\t};\n\n\t\treturn {\n\t\t\tdirty: markDirty,\n\t\t\tserversUpdated: serversUpdated,\n\t\t\tdefaultServerUpdated: defaultServerUpdated,\n\t\t\tserverRemoved: serverRemoved\n\t\t};\n\t})\n\t.factory('UtilEventHandler', function($rootScope, $log) {\n\t\tvar eventListeners = {\n\t\t};\n\n\t\tvar addListener = function(evt, f) {\n\t\t\tif (!eventListeners[evt]) {\n\t\t\t\teventListeners[evt] = [];\n\t\t\t}\n\t\t\teventListeners[evt].push(f);\n\t\t};\n\n\t\t$rootScope.$on('opennms.dirty', function(ev, type) {\n\t\t\tvar types = [type], prop;\n\t\t\tif (type === 'all') {\n\t\t\t\ttypes = [];\n\t\t\t\tfor (prop in eventListeners) {\n\t\t\t\t\tif (eventListeners.hasOwnProperty(prop)) {\n\t\t\t\t\t\ttypes.push(prop);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar handleType = function(eventListenerType) {\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListenerType.length; i < len; i++) {\n\t\t\t\t\t\teventListenerType[i]();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tfor (var i=0, len=types.length; i < len; i++) {\n\t\t\t\tif (eventListeners['opennms.dirty'] && eventListeners['opennms.dirty'][types[i]]) {\n\t\t\t\t\t$log.debug('util.onDirty: ' + types[i]);\n\t\t\t\t\thandleType(eventListeners['opennms.dirty'][types[i]]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('opennms.errors.updated', function(ev, errors) {\n\t\t\tif (eventListeners['opennms.errors.updated']) {\n\t\t\t\t$log.debug('util.onErrorsUpdated: ' + angular.toJson(errors));\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListeners['opennms.errors.updated'].length; i < len; i++) {\n\t\t\t\t\t\teventListeners['opennms.errors.updated'][i](errors);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('opennms.info.updated', function(ev, info) {\n\t\t\tif (eventListeners['opennms.info.updated']) {\n\t\t\t\t$log.debug('util.onInfoUpdated: ' + angular.toJson(info));\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListeners['opennms.info.updated'].length; i < len; i++) {\n\t\t\t\t\t\teventListeners['opennms.info.updated'][i](info);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('opennms.product.updated', function(ev, product) {\n\t\t\tif (eventListeners['opennms.product.updated']) {\n\t\t\t\t$log.debug('util.onProductUpdated: ' + product.id);\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListeners['opennms.product.updated'].length; i < len; i++) {\n\t\t\t\t\t\teventListeners['opennms.product.updated'][i](product);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('opennms.servers.defaultUpdated', function(ev, server) {\n\t\t\tif (eventListeners['opennms.servers.defaultUpdated']) {\n\t\t\t\t$log.debug('util.onDefaultServerUpdated: ' + angular.toJson(server));\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListeners['opennms.servers.defaultUpdated'].length; i < len; i++) {\n\t\t\t\t\t\teventListeners['opennms.servers.defaultUpdated'][i](server);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('opennms.servers.updated', function(ev, newServers, oldServers) {\n\t\t\tif (eventListeners['opennms.servers.updated']) {\n\t\t\t\t$log.debug('util.onServersUpdated: ' + angular.toJson(newServers));\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListeners['opennms.servers.updated'].length; i < len; i++) {\n\t\t\t\t\t\teventListeners['opennms.servers.updated'][i](newServers, oldServers);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('opennms.servers.removed', function(ev, server) {\n\t\t\tif (eventListeners['opennms.servers.removed']) {\n\t\t\t\t$log.debug('util.onServerRemoved: ' + server.name);\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListeners['opennms.servers.removed'].length; i < len; i++) {\n\t\t\t\t\t\teventListeners['opennms.servers.removed'][i](server);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('opennms.settings.updated', function(ev, newSettings, oldSettings, changedSettings) {\n\t\t\tif (eventListeners['opennms.settings.updated']) {\n\t\t\t\t$log.debug('util.onSettingsUpdated: ' + angular.toJson(changedSettings));\n\t\t\t\t$rootScope.$evalAsync(function() {\n\t\t\t\t\tfor (var i=0, len=eventListeners['opennms.settings.updated'].length; i < len; i++) {\n\t\t\t\t\t\teventListeners['opennms.settings.updated'][i](newSettings, oldSettings, changedSettings);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tonDirty: function(type, f) {\n\t\t\t\tif (!eventListeners['opennms.dirty']) {\n\t\t\t\t\teventListeners['opennms.dirty'] = {};\n\t\t\t\t}\n\t\t\t\tif (!eventListeners['opennms.dirty'][type]) {\n\t\t\t\t\teventListeners['opennms.dirty'][type] = [];\n\t\t\t\t}\n\t\t\t\teventListeners['opennms.dirty'][type].push(f);\n\t\t\t},\n\t\t\tonErrorsUpdated: function(f) {\n\t\t\t\taddListener('opennms.errors.updated', f);\n\t\t\t},\n\t\t\tonInfoUpdated: function(f) {\n\t\t\t\taddListener('opennms.info.updated', f);\n\t\t\t},\n\t\t\tonProductUpdated: function(f) {\n\t\t\t\taddListener('opennms.product.updated', f);\n\t\t\t},\n\t\t\tonServersUpdated: function(f) {\n\t\t\t\taddListener('opennms.servers.updated', f);\n\t\t\t},\n\t\t\tonDefaultServerUpdated: function(f) {\n\t\t\t\taddListener('opennms.servers.defaultUpdated', f);\n\t\t\t},\n\t\t\tonServerRemoved: function(f) {\n\t\t\t\taddListener('opennms.servers.removed', f);\n\t\t\t},\n\t\t\tonSettingsUpdated: function(f) {\n\t\t\t\taddListener('opennms.settings.updated', f);\n\t\t\t}\n\t\t};\n\t})\n\t.factory('util', function($rootScope, $log, $state, $window, $cordovaInAppBrowser, $ionicHistory, $ionicPlatform, $ionicViewSwitcher, Servers, Settings, UtilEventBroadcaster, UtilEventHandler) {\n\t\t$log.info('util: Initializing.');\n\n\t\t$ionicPlatform.ready(function() {\n\t\t\tif (typeof cordova.plugins.Keyboard !== 'undefined') {\n\t\t\t\t$log.debug('Util: disabling native keyboard scroll.');\n\t\t\t\tcordova.plugins.Keyboard.disableScroll(true);\n\t\t\t\tcordova.plugins.Keyboard.hideKeyboardAccessoryBar(false);\n\t\t\t} else {\n\t\t\t\t$log.debug('Util: no Keyboard plugin found.');\n\t\t\t}\n\t\t});\n\n\t\tvar goToDashboard = function(direction) {\n\t\t\t$ionicHistory.nextViewOptions({\n\t\t\t\tdisableBack: true,\n\t\t\t\thistoryRoot: true\n\t\t\t});\n\t\t\tif (direction) {\n\t\t\t\t$ionicViewSwitcher.nextDirection(direction);\n\t\t\t}\n\t\t\t$state.go('dashboard');\n\t\t};\n\n\t\tvar icons = {\n\t\t\tINDETERMINATE: 'ion-help-circled',\n\t\t\tCLEARED: 'ion-happy',\n\t\t\tNORMAL: 'ion-record',\n\t\t\tWARNING: 'ion-minus-circled',\n\t\t\tMINOR: 'ion-alert-circled',\n\t\t\tMAJOR: 'ion-flame',\n\t\t\tCRITICAL: 'ion-nuclear'\n\t\t};\n\t\tvar colors = {\n\t\t\tINDETERMINATE: '#999900',\n\t\t\tCLEARED: '#999',\n\t\t\tNORMAL: 'green',\n\t\t\tWARNING: '#ffcc00',\n\t\t\tMINOR: '#ff9900',\n\t\t\tMAJOR: '#ff3300',\n\t\t\tCRITICAL: '#cc0000'\n\t\t};\n\n\t\tvar showKeyboard = function() {\n\t\t\t//$log.debug('util.showKeyboard');\n\t\t\tif ($window.cordova && $window.cordova.plugins && $window.cordova.plugins.Keyboard) {\n\t\t\t\tcordova.plugins.Keyboard.show();\n\t\t\t}\n\t\t};\n\t\tvar hideKeyboard = function() {\n\t\t\t//$log.debug('util.hideKeyboard');\n\t\t\tif ($window.cordova && $window.cordova.plugins && $window.cordova.plugins.Keyboard) {\n\t\t\t\tcordova.plugins.Keyboard.close();\n\t\t\t}\n\t\t};\n\n\t\tvar hideSplashscreen = function() {\n\t\t\tif (navigator.splashscreen) {\n\t\t\t\tnavigator.splashscreen.hide();\n\t\t\t}\n\t\t};\n\n\t\tvar openServer = function() {\n\t\t\tServers.getDefault().then(function(server) {\n\t\t\t\tif (server) {\n\t\t\t\t\t$log.debug('util.openServer: ' + server.url);\n\t\t\t\t\t$cordovaInAppBrowser.open(server.url, '_blank');\n\t\t\t\t} else {\n\t\t\t\t\t$log.debug('util.openServer: no server defined');\n\t\t\t\t}\n\t\t\t}, function() {\n\t\t\t\t$log.debug('util.openServer: unable to get default server');\n\t\t\t});\n\t\t};\n\n\t\tvar trackEvent = function(category, event, label, value) {\n\t\t\t$rootScope.$broadcast('opennms.analytics.trackEvent', category, event, label, value);\n\t\t};\n\n\n\t\treturn {\n\t\t\tdashboard: goToDashboard,\n\t\t\ticon: function(severity) {\n\t\t\t\tseverity = severity? severity.toUpperCase() : 'INDETERMINATE';\n\t\t\t\treturn icons[severity] || icons.INDETERMINATE;\n\t\t\t},\n\t\t\tcolor: function(severity) {\n\t\t\t\tseverity = severity? severity.toUpperCase() : 'INDETERMINATE';\n\t\t\t\treturn colors[severity] || colors.INDETERMINATE;\n\t\t\t},\n\t\t\tseverities: function() {\n\t\t\t\tvar ret = [];\n\t\t\t\tfor (var sev in colors) {\n\t\t\t\t\tret.push(sev);\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t},\n\t\t\tshowKeyboard: showKeyboard,\n\t\t\thideKeyboard: hideKeyboard,\n\t\t\thideSplashscreen: hideSplashscreen,\n\t\t\topenServer: openServer,\n\t\t\ttrackEvent: trackEvent,\n\t\t\tdirty: UtilEventBroadcaster.dirty,\n\t\t\tonDirty: UtilEventHandler.onDirty,\n\t\t\tonErrorsUpdated: UtilEventHandler.onErrorsUpdated,\n\t\t\tonInfoUpdated: UtilEventHandler.onInfoUpdated,\n\t\t\tonProductUpdated: UtilEventHandler.onProductUpdated,\n\t\t\tonServersUpdated: UtilEventHandler.onServersUpdated,\n\t\t\tonDefaultServerUpdated: UtilEventHandler.onDefaultServerUpdated,\n\t\t\tonServerRemoved: UtilEventHandler.onServerRemoved,\n\t\t\tonSettingsUpdated: UtilEventHandler.onSettingsUpdated\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/util.js\n ** module id = 129\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/util.js?");

/***/ },
/* 130 */,
/* 131 */,
/* 132 */,
/* 133 */,
/* 134 */,
/* 135 */,
/* 136 */,
/* 137 */,
/* 138 */,
/* 139 */,
/* 140 */,
/* 141 */,
/* 142 */,
/* 143 */,
/* 144 */,
/* 145 */,
/* 146 */,
/* 147 */,
/* 148 */,
/* 149 */,
/* 150 */,
/* 151 */,
/* 152 */,
/* 153 */,
/* 154 */,
/* 155 */,
/* 156 */,
/* 157 */,
/* 158 */,
/* 159 */,
/* 160 */,
/* 161 */,
/* 162 */,
/* 163 */,
/* 164 */,
/* 165 */,
/* 166 */
/*!********************************!*\
  !*** ./src/app/misc/Errors.js ***!
  \********************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\tangular.module('opennms.services.Errors', [\n\t\t'ionic'\n\t])\n\t.factory('Errors', function($rootScope, $log) {\n\t\t$log.info('Errors: Initializing.');\n\n\t\tvar _errors = {};\n\n\t\tvar getErrorsAsArray = function() {\n\t\t\tvar ret = [];\n\t\t\tfor (var key in _errors) {\n\t\t\t\tif (_errors.hasOwnProperty(key)) {\n\t\t\t\t\tret.push({\n\t\t\t\t\t\ttype: key,\n\t\t\t\t\t\tmessage: _errors[key]\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ret;\n\t\t};\n\t\tvar setError = function(type, message) {\n\t\t\tif (message !== _errors[type]) {\n\t\t\t\t_errors[type] = message;\n\t\t\t\t$rootScope.$broadcast('opennms.errors.updated', getErrorsAsArray());\n\t\t\t}\n\t\t};\n\t\tvar clearError = function(type) {\n\t\t\tif (_errors[type]) {\n\t\t\t\tdelete _errors[type];\n\t\t\t\t$rootScope.$broadcast('opennms.errors.updated', getErrorsAsArray());\n\t\t\t}\n\t\t};\n\t\tvar getErrors = function(type) {\n\t\t\tif (type) {\n\t\t\t\treturn _errors[type];\n\t\t\t} else {\n\t\t\t\treturn getErrorsAsArray();\n\t\t\t}\n\t\t};\n\t\tvar resetErrors = function() {\n\t\t\tvar oldErrors = getErrors();\n\t\t\t_errors = {};\n\t\t\tif (oldErrors.length > 0) {\n\t\t\t\t$rootScope.$broadcast('opennms.errors.updated', getErrorsAsArray());\n\t\t\t}\n\t\t};\n\n\t\treturn {\n\t\t\tset: setError,\n\t\t\tclear: clearError,\n\t\t\treset: resetErrors,\n\t\t\tget: getErrors,\n\t\t\thasError: function(type) {\n\t\t\t\tif (_errors[type]) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Errors.js\n ** module id = 166\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Errors.js?");

/***/ },
/* 167 */
/*!************************************!*\
  !*** ./src/app/servers/Servers.js ***!
  \************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar DB_NAME = 'servers';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tmoment = __webpack_require__(/*! moment */ 14),\n\t\tServer = __webpack_require__(/*! ./models/Server */ 168),\n\t\tURI = __webpack_require__(/*! urijs */ 123);\n\n\t__webpack_require__(/*! ../db/db */ 114);\n\t__webpack_require__(/*! ../events/EventService */ 169);\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\tangular.module('opennms.services.Servers', [\n\t\t'ionic',\n\t\t'ngCordova',\n\t\t'uuid4',\n\t\t'opennms.services.DB',\n\t\t'opennms.services.Settings',\n\t\t'opennms.services.Util'\n\t]).factory('Servers', function($q, $rootScope, $interval, $log, $timeout, uuid4, db, Settings, UtilEventBroadcaster, UtilEventHandler) {\n\t\t$log.info('Servers: Initializing.');\n\n\t\tvar ready = $q.defer();\n\t\tvar servers = [];\n\t\tvar defaultServer;\n\n\t\tvar serversDB = db.get(DB_NAME);\n\t\tserversDB.createIndex({\n\t\t\tindex: {\n\t\t\t\tfields: ['name']\n\t\t\t}\n\t\t});\n\n\t\tvar isReady = function() {\n\t\t\tvar deferred = $q.defer();\n\t\t\tready.promise.then(function(r) {\n\t\t\t\tdeferred.resolve(r);\n\t\t\t}, function(err) {\n\t\t\t\tdeferred.resolve(false);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar _sortServers = function(a, b) {\n\t\t\tif (a && b) {\n\t\t\t\treturn a.name.localeCompare(b.name);\n\t\t\t}\n\t\t\treturn 0;\n\t\t};\n\n\t\tvar _toServer = function(server) {\n\t\t\tif (!server) {\n\t\t\t\treturn server;\n\t\t\t}\n\t\t\tif (angular.isArray(server)) {\n\t\t\t\tfor (var i=0, len=server.length; i < len; i++) {\n\t\t\t\t\tserver[i] = _toServer(server[i]);\n\t\t\t\t}\n\t\t\t\treturn server;\n\t\t\t} else if (server instanceof Server) {\n\t\t\t\treturn server;\n\t\t\t} else {\n\t\t\t\treturn new Server(server);\n\t\t\t}\n\t\t};\n\n\t\tvar getServers = function() {\n\t\t\treturn isReady().then(function() {\n\t\t\t\treturn serversDB.find({\n\t\t\t\t\tselector: { name: {$gt: null}},\n\t\t\t\t\tsort: ['name']\n\t\t\t\t}).then(function(docs) {\n\t\t\t\t\treturn _toServer(docs.docs);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar getDefaultServer = function() {\n\t\t\tvar onFailure = function() {\n\t\t\t\treturn getServers().then(function(servers) {\n\t\t\t\t\tif (servers.length > 0) {\n\t\t\t\t\t\tSettings.setDefaultServerId(servers[0]._id);\n\t\t\t\t\t\treturn _toServer(servers[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\treturn isReady().then(function() {\n\t\t\t\treturn Settings.getDefaultServerId().then(function(serverId) {\n\t\t\t\t\tif (serverId) {\n\t\t\t\t\t\treturn serversDB.get(serverId).then(function(server) {\n\t\t\t\t\t\t\treturn _toServer(server);\n\t\t\t\t\t\t}).catch(function(err) {\n\t\t\t\t\t\t\tif (err.error && err.reason === 'missing') {\n\t\t\t\t\t\t\t\treturn onFailure();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$log.error('Failed to get server ' + serverId + ': ' + angular.toJson(err));\n\t\t\t\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn onFailure();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar checkDefaultServerUpdated = function() {\n\t\t\tvar oldDefaultServer = defaultServer;\n\t\t\tgetDefaultServer().then(function(newDefaultServer) {\n\t\t\t\tdefaultServer = newDefaultServer;\n\t\t\t\tif (!angular.equals(oldDefaultServer, newDefaultServer)) {\n\t\t\t\t\tUtilEventBroadcaster.defaultServerUpdated(newDefaultServer);\n\t\t\t\t\tUtilEventBroadcaster.dirty('all');\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar checkServersUpdated = function(force) {\n\t\t\tvar oldServers = angular.copy(servers);\n\t\t\toldServers.sort(_sortServers);\n\t\t\treturn getServers().then(function(newServers) {\n\t\t\t\tnewServers.sort(_sortServers);\n\t\t\t\tservers = angular.copy(newServers);\n\t\t\t\tif (force === true || !angular.equals(oldServers, newServers)) {\n\t\t\t\t\t$log.debug('Servers.checkServersUpdated: server list has changed.');\n\t\t\t\t\t$log.debug('old: ' + angular.toJson(oldServers));\n\t\t\t\t\t$log.debug('new: ' + angular.toJson(newServers));\n\t\t\t\t\tUtilEventBroadcaster.serversUpdated(newServers, oldServers);\n\t\t\t\t\t$timeout(checkDefaultServerUpdated);\n\t\t\t\t}\n\t\t\t\treturn newServers;\n\t\t\t});\n\t\t};\n\n\t\tvar refreshPromise;\n\t\tvar startRefresh = function() {\n\t\t\tif (refreshPromise) {\n\t\t\t\t$interval.cancel(refreshPromise);\n\t\t\t}\n\t\t\tSettings.refreshInterval().then(function(refreshInterval) {\n\t\t\t\trefreshPromise = $interval(checkServersUpdated, refreshInterval);\n\t\t\t});\n\t\t};\n\n\t\tvar fetchServerNames = function() {\n\t\t\treturn serversDB.find({\n\t\t\t\tselector: {name: {$gt: null}},\n\t\t\t\tsort: ['name']\n\t\t\t}).then(function(docs) {\n\t\t\t\treturn docs.docs.map(function(server) {\n\t\t\t\t\treturn server.name;\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar _saveServer = function(server) {\n\t\t\tif (!server._id) {\n\t\t\t\tserver._id = uuid4.generate();\n\t\t\t}\n\n\t\t\treturn serversDB.get(server._id).then(function(doc) {\n\t\t\t\tangular.extend(doc, server);\n\t\t\t\t$log.debug('_saveServer: updating: ' + angular.toJson(doc));\n\t\t\t\treturn serversDB.put(doc).then(function(result) {\n\t\t\t\t\tdoc._rev = result.rev;\n\t\t\t\t\treturn doc;\n\t\t\t\t});\n\t\t\t}).catch(function(err) {\n\t\t\t\tif (err.error && err.reason === 'missing') {\n\t\t\t\t\t$log.debug('_saveServer: saving: ' + angular.toJson(server));\n\t\t\t\t\treturn serversDB.put(server).then(function(result) {\n\t\t\t\t\t\tserver._rev = result.rev;\n\t\t\t\t\t\treturn server;\n\t\t\t\t\t}).catch(function(err) {\n\t\t\t\t\t\t$log.error('Failed to save ' + server.name + ': ' + angular.toJson(err));\n\t\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$log.error('Failed to get server ' + server.name + ' (' + server._id + '): ' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t}\n\t\t\t}).finally(function() {\n\t\t\t\tcheckServersUpdated();\n\t\t\t});\n\t\t};\n\n\t\tvar init = function() {\n\t\t\treturn fetchServerNames().then(function(names) {\n\t\t\t\tif (names.length > 0) {\n\t\t\t\t\treturn names;\n\t\t\t\t} else {\n\t\t\t\t\t$log.info('Servers.init: no server names found, attempting to upgrade old settings.');\n\t\t\t\t\treturn Settings.get().then(function(settings) {\n\t\t\t\t\t\t$log.debug('Servers.init: settings = ' + angular.toJson(settings));\n\t\t\t\t\t\tif (settings.server !== undefined && settings.username !== undefined && settings.password !== undefined) {\n\t\t\t\t\t\t\tvar server = new Server({\n\t\t\t\t\t\t\t\tname: URI(settings.server).hostname(),\n\t\t\t\t\t\t\t\turl: settings.server,\n\t\t\t\t\t\t\t\tusername: settings.username,\n\t\t\t\t\t\t\t\tpassword: settings.password\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t$log.debug('Servers.init: saving default server: ' + angular.toJson(server, true));\n\t\t\t\t\t\t\treturn _saveServer(server);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$log.debug('Servers.init: No servers configured.');\n\t\t\t\t\t\t\treturn $q.reject('No servers configured.');\n\t\t\t\t\t\t}\n\t\t\t\t\t}, function(err) {\n\t\t\t\t\t\t$log.info('Servers.init: No settings found.');\n\t\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}).then(function() {\n\t\t\t\tready.resolve(true);\n\t\t\t\tstartRefresh();\n\t\t\t\treturn ready.promise;\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('Servers.init: failed initialization: ' + angular.toJson(err));\n\t\t\t\tready.resolve(false);\n\t\t\t\treturn ready.promise;\n\t\t\t});\n\t\t};\n\n\t\tvar getServerNames = function() {\n\t\t\treturn isReady().then(function() {\n\t\t\t\treturn fetchServerNames();\n\t\t\t});\n\t\t};\n\n\t\tvar setDefaultServer = function(server) {\n\t\t\tif (server && server._id) {\n\t\t\t\treturn Settings.setDefaultServerId(server._id).then(function() {\n\t\t\t\t\treturn checkServersUpdated();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn $q.reject('Not sure how to handle server \"'+server+'\"');\n\t\t\t}\n\t\t};\n\n\t\tvar saveServer = function(server) {\n\t\t\treturn isReady().then(function() {\n\t\t\t\treturn _saveServer(server);\n\t\t\t});\n\t\t};\n\n\t\tvar removeServer = function(server) {\n\t\t\treturn isReady().then(function() {\n\t\t\t\treturn serversDB.remove(server).then(function() {\n\t\t\t\t\treturn Settings.getDefaultServerId().then(function(defaultServerId) {\n\t\t\t\t\t\tif (defaultServerId === server._id) {\n\t\t\t\t\t\t\treturn Settings.setDefaultServerId(undefined).then(function() {\n\t\t\t\t\t\t\t\tUtilEventBroadcaster.serverRemoved(server);\n\t\t\t\t\t\t\t\treturn server;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tUtilEventBroadcaster.serverRemoved(server);\n\t\t\t\t\t\t\treturn server;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}).finally(function() {\n\t\t\t\tcheckServersUpdated();\n\t\t\t});\n\t\t};\n\n\t\tvar isServerConfigured = function() {\n\t\t\treturn getDefaultServer().then(function(server) {\n\t\t\t\tif (server && server.name) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\treturn false;\n\t\t\t});\n\t\t};\n\n\t\tUtilEventHandler.onSettingsUpdated(function(newSettings, oldSettings, changedSettings) {\n\t\t\tif (changedSettings && changedSettings.defaultServerId) {\n\t\t\t\t$timeout(checkServersUpdated);\n\t\t\t}\n\t\t});\n\n\t\tinit();\n\n\t\treturn {\n\t\t\tgetDefault: getDefaultServer,\n\t\t\tsetDefault: setDefaultServer,\n\t\t\tconfigured: isServerConfigured,\n\t\t\tnames: getServerNames,\n\t\t\tall: getServers,\n\t\t\tsave: saveServer,\n\t\t\tremove: removeServer\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/servers/Servers.js\n ** module id = 167\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/servers/Servers.js?");

/***/ },
/* 168 */
/*!******************************************!*\
  !*** ./src/app/servers/models/Server.js ***!
  \******************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar moment = __webpack_require__(/*! moment */ 14),\n  URI = __webpack_require__(/*! urijs */ 123);\n\n/**\n * @ngdoc object\n * @name Server\n * @param {Object} server a server JSON object\n * @constructor\n */\nfunction Server(server) {\n  'use strict';\n\n  var self = this;\n  if (!server) {\n    server = {};\n  }\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Server#_id\n   * @propertyOf Server\n   * @returns {string} Unique Identifier\n   */\n  self._id = server._id;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Server#_rev\n   * @propertyOf Server\n   * @returns {string} Revision\n   */\n  self._rev = server._rev;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Server#name\n   * @propertyOf Server\n   * @returns {string} Server Name\n   */\n  self.name = server.name;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Server#url\n   * @propertyOf Server\n   * @returns {string} The root URL of the server.\n   */\n  self.url = server.url;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Server#username\n   * @propertyOf Server\n   * @returns {string} The username used to connect to the server.\n   */\n  self.username = server.username;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Server#password\n   * @propertyOf Server\n   * @returns {string} The password used to connect to the server.\n   */\n  self.password = server.password;\n\n  self.relativeUrl = function(segment) {\n    return self.url? URI(self.url).segment(segment).toString() : undefined;\n  };\n\n  self.restUrl = function(segment) {\n    if (self.url) {\n      var url = URI(self.url).segment('rest/');\n      if (segment) {\n        url.segment(segment);\n      }\n      return url.toString();\n    } else {\n      return undefined;\n    }\n  };\n}\n\nmodule.exports = Server;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/servers/models/Server.js\n ** module id = 168\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/servers/models/Server.js?");

/***/ },
/* 169 */
/*!****************************************!*\
  !*** ./src/app/events/EventService.js ***!
  \****************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tOnmsEvent = __webpack_require__(/*! ./models/Event */ 170);\n\n\t__webpack_require__(/*! ../misc/Rest */ 121);\n\n\tangular.module('opennms.services.Events', [\n\t\t'ionic',\n\t\t'opennms.services.Rest'\n\t])\n\t.factory('EventService', function($q, $log, RestService) {\n\t\t$log.info('EventService: Initializing.');\n\n\t\tvar getEventsForNode = function(nodeId, limit) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tvar params = {\n\t\t\t\tlimit: limit||10,\n\t\t\t\t'node.id': nodeId,\n\t\t\t\torderBy: 'eventTime',\n\t\t\t\torder: 'desc'\n\t\t\t};\n\n\t\t\tRestService.getXml('/events', params).then(function(results) {\n\t\t\t\t/* jshint -W069 */ /* \"better written in dot notation\" */\n\t\t\t\tvar ret = [];\n\t\t\t\tif (results && results.events && results.events.event) {\n\t\t\t\t\tvar events = results.events.event;\n\t\t\t\t\tif (!angular.isArray(events)) {\n\t\t\t\t\t\tevents = [events];\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i=0, len=events.length; i < len; i++) {\n\t\t\t\t\t\tret.push(new OnmsEvent(events[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'EventService.getEventsForNode';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\treturn {\n\t\t\tnode: getEventsForNode\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/events/EventService.js\n ** module id = 169\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/events/EventService.js?");

/***/ },
/* 170 */
/*!****************************************!*\
  !*** ./src/app/events/models/Event.js ***!
  \****************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name Event\n * @param {Object} event an event JSON object\n * @constructor\n */\nfunction Event(event) {\n  'use strict';\n  //console.log('new Event():', event);\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#id\n   * @propertyOf Event\n   * @returns {number} Unique identifier for the event\n   */\n  self.id = parseInt(event['_id'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#uei\n   * @propertyOf Event\n   * @returns {string} Universal Event Identifer (UEI) for this event\n   */\n  self.uei = event['uei'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#title\n   * @propertyOf Event\n   * @returns {string} A readable title for the event (based on the UEI).\n   */\n  self.title = self.uei.replace(/^.*\\//g, '').replace(/([A-Z])/g, ' $1');\n  self.title = self.title.charAt(0).toUpperCase() + self.title.slice(1);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#nodeId\n   * @propertyOf Event\n   * @returns {number} Unique integer identifier for node\n   */\n  self.nodeId = Number(event['nodeId']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#nodeLabel\n   * @propertyOf Event\n   * @returns {string} The human-readable name of the node of this event.\n   */\n  self.nodeLabel = event['nodeLabel'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#ipAddress\n   * @propertyOf Event\n   * @returns {string} IP Address of node's interface\n   */\n  self.ipAddress = event['ipAddress'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#severity\n   * @propertyOf Event\n   * @returns {string} Severity the of event.\n   */\n  self.severity = event['_severity'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#createTime\n   * @propertyOf Event\n   * @returns {*|Date} Creation time of event in database\n   */\n  self.createTime = moment(event['createTime']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#time\n   * @propertyOf Event\n   * @returns {*|Date} The &lt;time&gt; element from the Event Data Stream DTD, which is the time the event was received by the source process.\n   */\n  self.time = moment(event['time']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#source\n   * @propertyOf Event\n   * @returns {string} The subsystem the event originated from.\n   */\n  self.source = event['source'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#log\n   * @propertyOf Event\n   * @returns {boolean} Whether the event was logged but not displayed.\n   */\n  self.log = event['_log'] === 'Y';\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#display\n   * @propertyOf Event\n   * @returns {boolean} Whether the event was both logged and displayed.\n   */\n  self.display = event['_display'] === 'Y';\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event\n   * @propertyOf Event\n   * @returns {string} Free-form textual description of the event\n   */\n  self.description = event['description'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Event#logMessage\n   * @propertyOf Event\n   * @returns {string} Formatted display text to control how the event will appear in the browser.\n   */\n  self.logMessage = event['logMessage'];\n\n  // Check to see if the event JSON has the 'serviceType' property before parsing it.\n  if (event.hasOwnProperty('serviceType')) {\n\n    /**\n     * @description\n     * @ngdoc property\n     * @name Event#serviceType\n     * @propertyOf Event\n     * @returns {number} Unique integer identifier of service/poller package\n     */\n    self.serviceType = event['serviceType']['_id'];\n\n    /**\n     * @description\n     * @ngdoc property\n     * @name Event#serviceName\n     * @propertyOf Event\n     * @returns {string} Human-readable name of the service\n     */\n    self.serviceName = event['serviceType']['name'];\n  }\n  // XXX: convert event['parms'] into an object for parms.\n  self.parms = {};\n\n  /**\n   * @description Provides a formatted severity CSS class\n   * @ngdoc method\n   * @name Event#getSeverityClass\n   * @methodOf Event\n   * @returns {string} formatted CSS class name\n   */\n  self.getSeverityClass = function() {\n    if (this.severity !== null && angular.isString(this.severity) && this.severity.length !== 0) {\n      return 'severity-'+angular.uppercase(this.severity);\n    }\n    return '';\n  };\n\n}\n\nmodule.exports = Event;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/events/models/Event.js\n ** module id = 170\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/events/models/Event.js?");

/***/ },
/* 171 */
/*!*******************************!*\
  !*** ./src/app/misc/Ionic.js ***!
  \*******************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\t__webpack_require__(/*! ./BuildConfig */ 118);\n\n\tangular.module('opennms.services.Ionic', [\n\t\t'ionic',\n\t\t'ionic.service.core',\n\t\t'ionic.service.deploy',\n\t\t'ngCordova',\n\t\t'opennms.services.BuildConfig'\n\t])\n\t.config(['$ionicAppProvider', 'config.build.ionicPublicKey', function($log, $ionicAppProvider, ionicPublicKey) {\n\t\tif (ionicPublicKey) {\n\t\t\t$log.info('Public key set.  Initializing.');\n\t\t\t$ionicAppProvider.identify({\n\t\t\t\t// The App ID (from apps.ionic.io) for the server\n\t\t\t\tapp_id: 'bf988c24',\n\t\t\t\t// The public API key all services will use for this app\n\t\t\t\tapi_key: ionicPublicKey\n\t\t\t});\n\t\t}\n\t}])\n\t.factory('IonicService', ['$q', '$log', '$ionicDeploy', '$ionicPopup', 'config.build.ionicPublicKey', function($q, $log, $ionicDeploy, $ionicPopup, ionicPublicKey) {\n\t\tvar rejected = $q.defer();\n\t\trejected.reject(false);\n\n\t\t$ionicDeploy.setChannel('Dev');\n\n\t\tvar checkForUpdates = function() {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tif (!ionicPublicKey) {\n\t\t\t\t$log.info('Ionic.checkForUpdates: skipping, no public key configured.');\n\t\t\t\tdeferred.reject(false);\n\t\t\t\treturn deferred.promise;\n\t\t\t}\n\n\t\t\t$log.info('Ionic.checkForUpdates: checking for updates.');\n\t\t\t$ionicDeploy.check().then(function(hasUpdate) {\n\t\t\t\t$log.debug('Ionic.checkForUpdates: hasUpdate = ' + hasUpdate);\n\t\t\t\tdeferred.resolve(hasUpdate);\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('Ionic.checkForUpdates: failed: ' + angular.toJson(err));\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar promptForUpdates = function() {\n\t\t\tif (!ionicPublicKey) {\n\t\t\t\t$log.info('Ionic.promptForUpdates: skipping, no public key configured.');\n\t\t\t\treturn rejected.promise;\n\t\t\t}\n\n\t\t\treturn checkForUpdates().then(function(hasUpdate) {\n\t\t\t\tif (hasUpdate) {\n\t\t\t\t\treturn $ionicPopup.confirm({\n\t\t\t\t\t\ttitle: 'Update Compass?',\n\t\t\t\t\t\ttemplate: 'OpenNMS Compass has an update. Install now?',\n\t\t\t\t\t\tcancelText: 'Not now.',\n\t\t\t\t\t\tcancelType: 'button-default',\n\t\t\t\t\t\tokType: 'button-compass'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('Ionic.promptForUpdates: failed: ' + angular.toJson(err));\n\t\t\t\treturn false;\n\t\t\t});\n\t\t};\n\n\t\tvar doUpdate = function() {\n\t\t\tif (!ionicPublicKey) {\n\t\t\t\t$log.debug('Ionic.doUpdate: skipping, no public key configured.');\n\t\t\t\treturn rejected.promise;\n\t\t\t}\n\n\t\t\t$log.info('Ionic.doUpdate: updating app.');\n\t\t\treturn $ionicDeploy.update().then(function(res) {\n\t\t\t\t$log.debug('Ionic.doUpdate: success! ' + angular.toJson(res));\n\t\t\t\treturn true;\n\t\t\t}, function(err) {\n\t\t\t\t$log.info('Ionic.doUpdate: failed: ' + angular.toJson(err));\n\t\t\t\treturn false;\n\t\t\t}, function(progress) {\n\t\t\t\t$log.debug('Ionic.doUpdate: progress: ' + angular.toJson(progress));\n\t\t\t});\n\t\t};\n\n\t\treturn {\n\t\t\tcheckForUpdates: checkForUpdates,\n\t\t\tpromptForUpdates: promptForUpdates,\n\t\t\tupdate: doUpdate\n\t\t};\n\t}]);\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Ionic.js\n ** module id = 171\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Ionic.js?");

/***/ },
/* 172 */
/*!********************************!*\
  !*** ./src/app/misc/Modals.js ***!
  \********************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\t__webpack_require__(/*! ./Analytics */ 12);\n\t__webpack_require__(/*! ./BuildConfig */ 118);\n\t__webpack_require__(/*! ./Errors */ 166);\n\t__webpack_require__(/*! ./Info */ 119);\n\t__webpack_require__(/*! ./util */ 129);\n\n\t__webpack_require__(/*! ../alarms/AlarmService */ 173);\n\t__webpack_require__(/*! ../events/EventService */ 169);\n\t__webpack_require__(/*! ../outages/OutageService */ 176);\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\tvar alarmDetailTemplate = __webpack_require__(/*! ngtemplate!html!../alarms/alarm-detail.html */ 180);\n\tvar outagesTemplate = __webpack_require__(/*! ngtemplate!html!../outages/outages.html */ 181);\n\tvar settingsTemplate = __webpack_require__(/*! ngtemplate!html!../settings/settings.html */ 182);\n\n\tangular.module('opennms.services.Modals', [\n\t\t'ionic',\n\t\t'ngCordova',\n\t\t'opennms.services.Alarms',\n\t\t'opennms.services.Analytics',\n\t\t'opennms.services.BuildConfig',\n\t\t'opennms.services.Errors',\n\t\t'opennms.services.Events',\n\t\t'opennms.services.Info',\n\t\t'opennms.services.Outages',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Settings',\n\t\t'opennms.services.Util'\n\t])\n\t.factory('Modals', function($q, $rootScope, $interval, $log, $ionicModal, $ionicPopup, AlarmService, Analytics, Errors, EventService, Info, OutageService, Servers, Settings, util) {\n\t\t$log.info('Modals: initializing.');\n\n\t\tvar $scope = $rootScope.$new();\n\t\t$scope.util = util;\n\t\t$scope.settings = Settings;\n\n\t\tServers.getDefault().then(function(server) {\n\t\t\tif (server && server.username) {\n\t\t\t\t$scope.username = server.username;\n\t\t\t}\n\t\t});\n\t\tutil.onDefaultServerUpdated(function(server) {\n\t\t\tif (server && server.username) {\n\t\t\t\t$scope.username = server.username;\n\t\t\t} else {\n\t\t\t\t$scope.username = undefined;\n\t\t\t}\n\t\t});\n\n\t\t$scope.alarmModal = $q.defer();\n\t\t$scope.outageModal = $q.defer();\n\t\t$scope.settingsModal = $q.defer();\n\n\t\t$ionicModal.fromTemplateUrl(outagesTemplate, {\n\t\t\tscope: $scope.$new(),\n\t\t\tanimation: 'slide-in-up'\n\t\t}).then(function(modal) {\n\t\t\tvar timer;\n\n\t\t\tvar getOutages = function(outage) {\n\t\t\t\tOutageService.node(outage.nodeId).then(function(nodeOutages) {\n\t\t\t\t\tnodeOutages.sort(function(a, b) {\n\t\t\t\t\t\tvar comp = a.ipAddress.localeCompare(b.ipAddress);\n\t\t\t\t\t\tif (comp === 0) {\n\t\t\t\t\t\t\treturn a.monitoredService.serviceName.localeCompare(b.monitoredService.serviceName);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn comp;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\toutage.nodeOutages = nodeOutages;\n\t\t\t\t\treturn nodeOutages;\n\t\t\t\t}, function(err) {\n\t\t\t\t\toutage.nodeOutages = [];\n\t\t\t\t\treturn err;\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar byId = function(outages) {\n\t\t\t\tvar ret = {};\n\t\t\t\tfor (var i=0, len=outages.length; i < len; i++) {\n\t\t\t\t\tret[outages[i].nodeId] = outages[i];\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t};\n\n\t\t\tmodal.scope.refreshOutages = function() {\n\t\t\t\t$log.debug('Modals.outages.refreshOutages()');\n\t\t\t\treturn OutageService.summaries().then(function(outages) {\n\t\t\t\t\t$log.debug('Got outages: ' + outages.length);\n\t\t\t\t\tvar oldOutages = byId(modal.scope.outages);\n\t\t\t\t\tvar oldOutage;\n\t\t\t\t\tfor (var i=0, len=outages.length; i < len; i++) {\n\t\t\t\t\t\toldOutage = oldOutages[outages[i].nodeId];\n\t\t\t\t\t\tif (oldOutage && oldOutage.nodeOutages) {\n\t\t\t\t\t\t\toutages[i].nodeOutages = oldOutage.nodeOutages;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgetOutages(outages[i]);\n\t\t\t\t\t}\n\t\t\t\t\tmodal.scope.outages = outages;\n\t\t\t\t\tdelete modal.scope.error;\n\t\t\t\t\treturn outages;\n\t\t\t\t}, function(err) {\n\t\t\t\t\t$log.error('Error refreshing outages: ' + angular.toJson(err));\n\t\t\t\t\tmodal.scope.error = err;\n\t\t\t\t\tmodal.scope.outages = [];\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t}).finally(function() {\n\t\t\t\t\tmodal.scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar startRefresh = function() {\n\t\t\t\t//timer = $interval(modal.scope.refreshOutages, Settings.refreshInterval());\n\t\t\t\tmodal.scope.refreshOutages();\n\t\t\t};\n\n\t\t\tvar stopRefresh = function() {\n\t\t\t\tif (timer) {\n\t\t\t\t\t$interval.cancel(timer);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmodal.scope.show = function() {\n\t\t\t\tmodal.scope.outages = [];\n\t\t\t\tmodal.scope.refreshOutages().then(function() {\n\t\t\t\t\tAnalytics.trackView('outages');\n\t\t\t\t\tmodal.show();\n\t\t\t\t});\n\t\t\t};\n\t\t\tmodal.scope.hide = function() {\n\t\t\t\tmodal.hide();\n\t\t\t};\n\t\t\tutil.onSettingsUpdated(function(newSettings, oldSettings, changedSettings) {\n\t\t\t\tif (modal.isShown() && timer && changedSettings && changedSettings.refreshInterval) {\n\t\t\t\t\tstopRefresh();\n\t\t\t\t\tstartRefresh();\n\t\t\t\t}\n\t\t\t});\n\t\t\tmodal.scope.$on('modal.hidden', stopRefresh);\n\t\t\t$scope.outageModal.resolve(modal);\n\t\t});\n\n\t\t$ionicModal.fromTemplateUrl('templates/alarm-detail.html', {\n\t\t\tscope: $scope.$new(),\n\t\t\tanimation: 'slide-in-up'\n\t\t}).then(function(modal) {\n\t\t\tvar timer;\n\t\t\tmodal.scope.updateAlarmData = function() {\n\t\t\t\tif (modal.scope.alarm && modal.scope.alarm.id) {\n\t\t\t\t\tvar promise = AlarmService.alarm(modal.scope.alarm.id);\n\t\t\t\t\tpromise['finally'](function() {\n\t\t\t\t\t\tmodal.scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t\t});\n\t\t\t\t\tpromise.then(function(alarm) {\n\t\t\t\t\t\tmodal.scope.alarm = alarm;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$log.debug('Modals.alarmDetail.updateAlarmData: no alarm associated with alarm modal!');\n\t\t\t\t\tmodal.scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t}\n\t\t\t};\n\t\t\tmodal.scope.clear = function() {\n\t\t\t\tAlarmService.clear(modal.scope.alarm).then(modal.scope.updateAlarmData, function(err) {\n\t\t\t\t\t$log.error('Modals.alarmDetail.clear: error: ',err);\n\t\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\t\ttemplate: '<p>Unable to clear alarm.</p>\\n' +\n\t\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to clear alarms.',\n\t\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tmodal.scope.updateAlarmData();\n\t\t\t\t});\n\t\t\t};\n\t\t\tmodal.scope.escalate = function() {\n\t\t\t\tAlarmService.escalate(modal.scope.alarm).then(modal.scope.updateAlarmData, function(err) {\n\t\t\t\t\t$log.error('Modals.alarmDetail.escalate: error: ',err);\n\t\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\t\ttemplate: '<p>Unable to escalate alarm.</p>\\n' +\n\t\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to escalate alarms.',\n\t\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tmodal.scope.updateAlarmData();\n\t\t\t\t});\n\t\t\t};\n\t\t\tmodal.scope.acknowledge = function() {\n\t\t\t\tAlarmService.acknowledge(modal.scope.alarm).then(modal.scope.updateAlarmData, function(err) {\n\t\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\t\ttemplate: '<p>Unable to acknowledge alarm.</p>\\n' +\n\t\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to acknowledge alarms.',\n\t\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tmodal.scope.updateAlarmData();\n\t\t\t\t});\n\t\t\t};\n\t\t\tmodal.scope.unacknowledge = function() {\n\t\t\t\tAlarmService.unacknowledge(modal.scope.alarm).then(modal.scope.updateAlarmData, function(err) {\n\t\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\t\ttemplate: '<p>Unable to unacknowledge alarm.</p>\\n' +\n\t\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to unacknowledge alarms.',\n\t\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tmodal.scope.updateAlarmData();\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar startRefresh = function() {\n\t\t\t\t//timer = $interval(modal.scope.updateAlarmData, Settings.refreshInterval());\n\t\t\t\tmodal.scope.updateAlarmData();\n\t\t\t};\n\n\t\t\tvar stopRefresh = function() {\n\t\t\t\tif (timer) {\n\t\t\t\t\t$interval.cancel(timer);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmodal.scope.show = function(alarm) {\n\t\t\t\tmodal.scope.alarm = alarm;\n\t\t\t\tstartRefresh();\n\t\t\t\tAnalytics.trackView('alarm-detail');\n\t\t\t\tmodal.show();\n\t\t\t};\n\t\t\tmodal.scope.hide = function() {\n\t\t\t\tmodal.hide();\n\t\t\t};\n\t\t\tutil.onSettingsUpdated(function(newSettings, oldSettings, changedSettings) {\n\t\t\t\tif (modal.isShown() && timer && changedSettings && changedSettings.refreshInterval) {\n\t\t\t\t\tstopRefresh();\n\t\t\t\t\tstartRefresh();\n\t\t\t\t}\n\t\t\t});\n\t\t\tmodal.scope.$on('modal.hidden', stopRefresh);\n\t\t\t$scope.alarmModal.resolve(modal);\n\t\t});\n\n\t\t$ionicModal.fromTemplateUrl(settingsTemplate, {\n\t\t\tscope: $scope.$new(),\n\t\t\tanimation: 'slide-in-up'\n\t\t}).then(function(modal) {\n\t\t\tmodal.scope.show = function(launchAdd) {\n\t\t\t\t//$scope.launchAddServer = launchAdd;\n\t\t\t\tmodal.scope.launchAddServer = launchAdd;\n\t\t\t\tAnalytics.trackView('settings');\n\t\t\t\tmodal.show();\n\t\t\t};\n\t\t\tmodal.scope.hide = function() {\n\t\t\t\tmodal.hide();\n\t\t\t};\n\t\t\t$scope.settingsModal.resolve(modal);\n\t\t});\n\n\t\t$scope.$on('$destroy', function() {\n\t\t\t$scope.alarmModal.promise.then(function(modal) {\n\t\t\t\tmodal.scope.hide();\n\t\t\t\tmodal.remove();\n\t\t\t});\n\t\t\t$scope.outageModal.promise.then(function(modal) {\n\t\t\t\tmodal.scope.hide();\n\t\t\t\tmodal.remove();\n\t\t\t});\n\t\t\t$scope.settingsModal.promise.then(function(modal) {\n\t\t\t\tmodal.scope.hide();\n\t\t\t\tmodal.remove();\n\t\t\t});\n\t\t});\n\n\t\t$scope.modals = {\n\t\t\talarm: function(alarm) {\n\t\t\t\t$scope.alarmModal.promise.then(function(modal) {\n\t\t\t\t\tmodal.scope.show(alarm);\n\t\t\t\t});\n\t\t\t},\n\t\t\toutages: function() {\n\t\t\t\t$scope.outageModal.promise.then(function(modal) {\n\t\t\t\t\tmodal.scope.show();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsettings: function(launchAdd) {\n\t\t\t\t$scope.settingsModal.promise.then(function(modal) {\n\t\t\t\t\tmodal.scope.show(launchAdd);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\treturn $scope.modals;\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Modals.js\n ** module id = 172\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Modals.js?");

/***/ },
/* 173 */
/*!****************************************!*\
  !*** ./src/app/alarms/AlarmService.js ***!
  \****************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tAlarm = __webpack_require__(/*! ./Alarm */ 174),\n\t\tAlarmFilter = __webpack_require__(/*! ./AlarmFilter */ 175);\n\n\t__webpack_require__(/*! ../misc/Rest */ 121);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tangular.module('opennms.services.Alarms', [\n\t\t'ionic',\n\t\t'opennms.services.Rest',\n\t\t'opennms.services.Util'\n\t])\n\t.factory('AlarmService', function($q, $log, RestService, util) {\n\t\t$log.info('AlarmService: Initializing.');\n\n\t\tvar getAlarms = function(filter) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tif (!filter) {\n\t\t\t\tfilter = new AlarmFilter();\n\t\t\t}\n\n\t\t\tRestService.getXml('/alarms', filter.toParams()).then(function(results) {\n\t\t\t\t/* jshint -W069 */ /* \"better written in dot notation\" */\n\t\t\t\tvar ret = [];\n\t\t\t\tif (results && results['alarms'] && results['alarms']['alarm']) {\n\t\t\t\t\tvar alarms = results['alarms']['alarm'];\n\t\t\t\t\tif (!angular.isArray(alarms)) {\n\t\t\t\t\t\talarms = [alarms];\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i=0, len=alarms.length; i < len; i++) {\n\t\t\t\t\t\tret.push(new Alarm(alarms[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'AlarmService.getAlarms';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar getAlarm = function(alarm) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tvar alarmId;\n\t\t\tif (angular.isNumber(alarm)) {\n\t\t\t\talarmId = alarm;\n\t\t\t} else {\n\t\t\t\talarmId = alarm.id;\n\t\t\t}\n\n\t\t\tif (!alarmId) {\n\t\t\t\t$log.error('AlarmService.getAlarm: invalid alarm is missing ID! ' + angular.toJson(alarm));\n\t\t\t\tdeferred.reject('Alarm is missing ID!');\n\t\t\t\treturn deferred.promise;\n\t\t\t}\n\n\t\t\tRestService.getXml('/alarms/' + alarmId).then(function(results) {\n\t\t\t\t/* jshint -W069 */ /* \"better written in dot notation\" */\n\t\t\t\tvar ret;\n\t\t\t\tif (results && results['alarm']) {\n\t\t\t\t\tret = new Alarm(results['alarm']);\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'AlarmService.getAlarm';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar getSeverities = function(filter) {\n\t\t\tfilter = filter || new AlarmFilter({limit:100,minimumSeverity:'WARNING'});\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tgetAlarms(filter).then(function(results) {\n\t\t\t\tvar alarmSeverities = {}, alarm, legend = [];\n\n\t\t\t\tfor (var i=0, len=results.length; i < len; i++) {\n\t\t\t\t\talarm = results[i];\n\t\t\t\t\tif (alarmSeverities.hasOwnProperty(alarm.severity)) {\n\t\t\t\t\t\talarmSeverities[alarm.severity]++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\talarmSeverities[alarm.severity] = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (var sev in alarmSeverities) {\n\t\t\t\t\tlegend.push({\n\t\t\t\t\t\tseverity: sev.toUpperCase(),\n\t\t\t\t\t\tcount: alarmSeverities[sev]\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar severities = util.severities();\n\t\t\t\tlegend.sort(function(a, b) {\n\t\t\t\t\treturn severities.indexOf(a.severity) - severities.indexOf(b.severity);\n\t\t\t\t});\n\t\t\t\tdeferred.resolve(legend);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'AlarmService.getSeverities';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar clear = function(alarm) {\n\t\t\tvar deferred = $q.defer();\n\t\t\tRestService.put('/alarms/' + alarm.id + '?clear=true', {limit:0}).then(function(response) {\n\t\t\t\tutil.dirty('alarms');\n\t\t\t\tdeferred.resolve(response);\n\t\t\t}, function(err) {\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar escalate = function(alarm) {\n\t\t\tvar deferred = $q.defer();\n\t\t\tRestService.put('/alarms/' + alarm.id + '?escalate=true', {limit:0}).then(function(response) {\n\t\t\t\tutil.dirty('alarms');\n\t\t\t\tdeferred.resolve(response);\n\t\t\t}, function(err) {\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar acknowledge = function(alarm) {\n\t\t\tvar deferred = $q.defer();\n\t\t\tRestService.put('/alarms/' + alarm.id + '?ack=true', {limit:0}).then(function(response) {\n\t\t\t\tutil.dirty('alarms');\n\t\t\t\tdeferred.resolve(response);\n\t\t\t}, function(err) {\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar unacknowledge = function(alarm) {\n\t\t\tvar deferred = $q.defer();\n\t\t\tRestService.put('/alarms/' + alarm.id + '?ack=false', {limit:0}).then(function(response) {\n\t\t\t\tutil.dirty('alarms');\n\t\t\t\tdeferred.resolve(response);\n\t\t\t}, function(err) {\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\treturn {\n\t\t\tget: getAlarms,\n\t\t\talarm: getAlarm,\n\t\t\tseverities: getSeverities,\n\t\t\tclear: clear,\n\t\t\tescalate: escalate,\n\t\t\tacknowledge: acknowledge,\n\t\t\tunacknowledge: unacknowledge\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/alarms/AlarmService.js\n ** module id = 173\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/alarms/AlarmService.js?");

/***/ },
/* 174 */
/*!*********************************!*\
  !*** ./src/app/alarms/Alarm.js ***!
  \*********************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar OnmsEvent = __webpack_require__(/*! ../events/models/Event */ 170),\n  moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name Alarm\n * @param {Object} alarm an alarm JSON object\n * @constructor\n */\nfunction Alarm(alarm) {\n  'use strict';\n\n  var self = this;\n  //console.log('alarm:', alarm);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#id\n   * @propertyOf Alarm\n   * @returns {number} Alarm ID\n   */\n  self.id   = parseInt(alarm['_id'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#count\n   * @propertyOf Alarm\n   * @returns {number} Number of times the alarm has triggered.\n   */\n  self.count = parseInt(alarm['_count'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#ackUser\n   * @propertyOf Alarm\n   * @returns {string} User that acknowledged the alarm.\n   */\n  self.ackUser = alarm['ackUser'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#ackTime\n   * @propertyOf Alarm\n   * @returns {string} The time the alarm was acknowledged.\n   */\n  self.ackTime = alarm['ackTime']? moment(alarm['ackTime']) : undefined;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#uei\n   * @propertyOf Alarm\n   * @returns {string} Universal Event Identifier for the alarm.\n   */\n  self.uei   = alarm['uei'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#title\n   * @propertyOf Alarm\n   * @returns {string} A readable title for the alarm (based on the UEI).\n   */\n  self.title = self.uei.replace(/^.*\\//g, '').replace(/([A-Z])/g, ' $1');\n  self.title = self.title.charAt(0).toUpperCase() + self.title.slice(1);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#severity\n   * @propertyOf Alarm\n   * @returns {string} Severity the of alarm.\n   */\n  self.severity   = alarm['_severity'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#type\n   * @propertyOf Alarm\n   * @returns {number} Alarm type ID, see {@link http://www.opennms.org/wiki/Configuring_alarms#Alarm_Types alarm types}\n   */\n  self.type   = parseInt(alarm['_type'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#description\n   * @propertyOf Alarm\n   * @returns {string} The description of the alarm\n   */\n  self.description   = alarm['description'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#firstTimeEvent\n   * @propertyOf Alarm\n   * @returns {*|Date} The first time an event was reduced by this alarm\n   */\n  self.firstEventTime   = moment(alarm['firstEventTime']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#lastEventTime\n   * @propertyOf Alarm\n   * @returns {*|Date} The last time an event was reduced by this alarm\n   */\n  self.lastEventTime   = moment(alarm['lastEventTime']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#lastEvent\n   * @propertyOf Alarm\n   * @returns {Event} The last event to be reduced by this alarm\n   */\n  self.lastEvent   = new OnmsEvent(alarm['lastEvent']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#logMessage\n   * @propertyOf Alarm\n   * @returns {string} Formatted display text to control how the alarm will appear in the browser.\n   */\n  self.logMessage   = alarm['logMessage'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#reductionKey\n   * @propertyOf Alarm\n   * @returns {string} Reduction key for this alarm\n   */\n  self.reductionKey   = alarm['reductionKey'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#troubleTicketId\n   * @propertyOf Alarm\n   * @returns {string} The trouble ticket ID associated with this alarm, if any.\n   */\n  self.troubleTicketId = alarm['troubleTicket'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#troubleTicketState\n   * @propertyOf Alarm\n   * @returns {string} The trouble ticket state, if any.\n   */\n  self.troubleTicketState = alarm['troubleTicketState'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#nodeId\n   * @propertyOf Alarm\n   * @returns {number} Unique integer identifier for node\n   */\n  self.nodeId   = parseInt(alarm['nodeId'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#nodeLabel\n   * @propertyOf Alarm\n   * @returns {string} The human-readable name of the node of this alarm.\n   */\n  self.nodeLabel   = alarm['nodeLabel'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#stickyMemo\n   * @propertyOf Alarm\n   * @returns {object} The sticky memo associated with this alarm.\n   */\n  self.stickyMemo = alarm['stickyMemo'];\n  if (self.stickyMemo) {\n    if (self.stickyMemo.updated) {\n      self.stickyMemo.updated = moment(self.stickyMemo.updated);\n    }\n    if (self.stickyMemo.created) {\n      self.stickyMemo.created = moment(self.stickyMemo.created);\n    }\n  }\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#journalMemo\n   * @propertyOf Alarm\n   * @returns {object} The journal (reduction key) memo associated with this alarm.\n   */\n  self.journalMemo = alarm['reductionKeyMemo'];\n  if (self.journalMemo) {\n    if (self.journalMemo.updated) {\n      self.journalMemo.updated = moment(self.journalMemo.updated);\n    }\n    if (self.journalMemo.created) {\n      self.journalMemo.created = moment(self.journalMemo.created);\n    }\n  }\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#parms\n   * @propertyOf Alarm\n   * @returns {object} The &lt;parms&gt; element for this alarm.\n   */\n  self.parms   = {};\n  // alarm['parms'];\n\n  /**\n   * @description Provides a formatted severity CSS class\n   * @ngdoc method\n   * @name Alarm#getSeverityClass\n   * @methodOf Alarm\n   * @returns {string} formatted CSS class name\n   */\n  self.getSeverityClass = function() {\n    if (this.severity !== null && angular.isString(this.severity) && this.severity.length !== 0) {\n      return 'severity-'+angular.uppercase(this.severity);\n    }\n    return '';\n  };\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Alarm#className\n   * @propertyOf Alarm\n   * @returns {string} the name of this object class, used for troubleshooting and testing.\n   */\n  self.className = 'Alarm';\n\n  self.showCleared = function() {\n    if (self.severity === 'CLEARED') {\n      if (self.title.contains('Regained')) {\n        return false;\n      }\n      if (self.title.contains('Succeeded')) {\n        return false;\n      }\n      return true;\n    }\n    return false;\n  };\n}\n\nmodule.exports = Alarm;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/alarms/Alarm.js\n ** module id = 174\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/alarms/Alarm.js?");

/***/ },
/* 175 */
/*!***************************************!*\
  !*** ./src/app/alarms/AlarmFilter.js ***!
  \***************************************/
/***/ function(module, exports) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nfunction AlarmFilter(params) {\n\t'use strict';\n\n\tvar self = this;\n\n\tself.showAcknowledged = false;\n\tself.newestFirst = true;\n\tself.limit = 20;\n\tself.offset = 0;\n\tself.minimumSeverity = undefined;\n\n\tif (params) {\n\t\tif (params.hasOwnProperty('showAcknowledged')) {\n\t\t\tself.showAcknowledged = params.showAcknowledged;\n\t\t}\n\t\tif (params.hasOwnProperty('newestFirst')) {\n\t\t\tself.newestFirst = params.newestFirst;\n\t\t}\n\t\tif (params.hasOwnProperty('limit')) {\n\t\t\tself.limit = params.limit;\n\t\t}\n\t\tif (params.hasOwnProperty('offset')) {\n\t\t\tself.offset = params.offset;\n\t\t}\n\t\tif (params.hasOwnProperty('minimumSeverity') && params.minimumSeverity) {\n\t\t\tself.minimumSeverity = params.minimumSeverity.toUpperCase();\n\t\t}\n\t}\n}\n\nAlarmFilter.prototype.toParams = function() {\n\t'use strict';\n\tvar self = this;\n\tvar params = {};\n\tif (!self.showAcknowledged) {\n\t\tparams.alarmAckUser = 'null';\n\t}\n\tparams.orderBy = 'lastEventTime';\n\tif (self.newestFirst) {\n\t\tparams.order = 'desc';\n\t} else {\n\t\tparams.order = 'asc';\n\t}\n\tparams.limit = self.limit;\n\tparams.offset = self.offset;\n\tif (self.minimumSeverity) {\n\t\tparams.comparator = 'ge';\n\t\tparams.severity = self.minimumSeverity;\n\t}\n\treturn params;\n};\n\nAlarmFilter.prototype.clone = function() {\n\t'use strict';\n\tvar self = this;\n\tvar cloned = new AlarmFilter();\n\tcloned.showAcknowledged = self.showAcknowledged;\n\tcloned.newestFirst = self.newestFirst;\n\tcloned.limit = self.limit;\n\tcloned.offset = self.offset;\n\treturn cloned;\n};\n\nAlarmFilter.prototype.reset = function() {\n\t'use strict';\n\tvar obj = this.clone();\n\tobj.offset = 0;\n\treturn obj;\n};\n\nAlarmFilter.prototype.next = function() {\n\t'use strict';\n\tvar cloned = this.clone();\n\tcloned.offset += cloned.limit;\n\treturn cloned;\n};\n\nmodule.exports = AlarmFilter;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/alarms/AlarmFilter.js\n ** module id = 175\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/alarms/AlarmFilter.js?");

/***/ },
/* 176 */
/*!******************************************!*\
  !*** ./src/app/outages/OutageService.js ***!
  \******************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tOutage = __webpack_require__(/*! ./models/Outage */ 177),\n\t\tOutageSummary = __webpack_require__(/*! ./models/OutageSummary */ 179);\n\n\t__webpack_require__(/*! ../misc/Rest */ 121);\n\n\tangular.module('opennms.services.Outages', [\n\t\t'ionic',\n\t\t'opennms.services.Rest'\n\t])\n\t.factory('OutageService', function($q, $log, RestService) {\n\t\t$log.info('OutageService: Initializing.');\n\n\t\tvar getOutages = function(all) {\n\t\t\tvar deferred = $q.defer();\n\t\t\tvar params = {\n\t\t\t\torderBy: 'ifLostService',\n\t\t\t\torder: 'desc'\n\t\t\t};\n\t\t\tif (!all) {\n\t\t\t\tparams.ifRegainedService = 'null';\n\t\t\t}\n\t\t\tRestService.getXml('/outages', params).then(function(results) {\n\t\t\t\tvar ret = [];\n\t\t\t\tif (results && results.outages && results.outages.outage) {\n\t\t\t\t\tvar outages = results.outages.outage;\n\t\t\t\t\tif (!angular.isArray(outages)) {\n\t\t\t\t\t\toutages = [outages];\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i=0, len=outages.length; i < len; i++) {\n\t\t\t\t\t\tret.push(new Outage(outages[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'OutageService.getOutages';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar getOutagesForNode = function(nodeId) {\n\t\t\tvar deferred = $q.defer();\n\t\t\tvar url = '/outages/forNode/' + nodeId;\n\t\t\tvar params = {\n\t\t\t\tlimit: 50,\n\t\t\t\torderBy: 'ifLostService',\n\t\t\t\torder: 'desc'\n\t\t\t};\n\n\t\t\tRestService.getXml(url, params).then(function(results) {\n\t\t\t\tvar ret = [];\n\t\t\t\tif (results && results.outages && results.outages.outage) {\n\t\t\t\t\tvar outages = results.outages.outage;\n\t\t\t\t\tif (!angular.isArray(outages)) {\n\t\t\t\t\t\toutages = [outages];\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i=0, len=outages.length; i < len; i++) {\n\t\t\t\t\t\tret.push(new Outage(outages[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'OutageService.getOutagesForNode';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar getOutageSummaries = function() {\n\t\t\tvar deferred = $q.defer();\n\t\t\tvar url = '/outages/summaries';\n\t\t\tRestService.getXml(url).then(function(results) {\n\t\t\t\tvar ret = [];\n\t\t\t\tif (results && results['outage-summaries'] && results['outage-summaries']['outage-summary']) {\n\t\t\t\t\tvar summaries = results['outage-summaries']['outage-summary'];\n\t\t\t\t\tif (!angular.isArray(summaries)) {\n\t\t\t\t\t\tsummaries = [summaries];\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i=0, len=summaries.length; i < len; i++) {\n\t\t\t\t\t\tret.push(new OutageSummary(summaries[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'OutageService.getOutageSummaries';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\treturn {\n\t\t\tget: getOutages,\n\t\t\tnode: getOutagesForNode,\n\t\t\tsummaries: getOutageSummaries\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/outages/OutageService.js\n ** module id = 176\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/outages/OutageService.js?");

/***/ },
/* 177 */
/*!******************************************!*\
  !*** ./src/app/outages/models/Outage.js ***!
  \******************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar MonitoredService = __webpack_require__(/*! ../../nodes/models/MonitoredService */ 178),\n  moment = __webpack_require__(/*! moment */ 14),\n  OnmsEvent = __webpack_require__(/*! ../../events/models/Event */ 170);\n\n/**\n * @ngdoc object\n * @name Outage\n * @param {Object} outage an outage JSON object\n * @constructor\n */\nfunction Outage(outage) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Outage#id\n   * @propertyOf Outage\n   * @returns {number} The unique outage ID\n   */\n  self.id = parseInt(outage['_id'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Outage#ipAddress\n   * @propertyOf Outage\n   * @returns {string} IP Address of node's interface\n   */\n  self.ipAddress = outage['ipAddress'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Outage#ifLostService\n   * @propertyOf Outage\n   * @returns {*|Date} The time the service was lost.\n   */\n  self.ifLostService = moment(outage['_ifLostService']);\n\n  if (outage['_ifRegainedService']) {\n    /**\n     * @description\n     * @ngdoc property\n     * @name Outage#ifRegainedService\n     * @propertyOf Outage\n     * @returns {*|Date} The time the service was regained. Property is undefined if the service hasn't been regained.\n     */\n    self.ifRegainedService = moment(outage['_ifRegainedService']);\n  }\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Outage#monitoredService\n   * @propertyOf Outage\n   * @returns {MonitoredService} The monitored service related to this outage.\n   */\n  self.monitoredService = new MonitoredService(outage['monitoredService']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Outage#serviceLostEvent\n   * @propertyOf Outage\n   * @returns {Event} The event that was emitted when the service was lost.\n   */\n  self.serviceLostEvent = new OnmsEvent(outage['serviceLostEvent']);\n  //self.node = new Node(self.nodeId);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Outage#nodeid\n   * @propertyOf Outage\n   * @returns {number} Unique integer identifier for node\n   */\n  self.nodeId = self.serviceLostEvent.nodeId;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Outage#nodeLabel\n   * @propertyOf Outage\n   * @returns {string} The human-readable name of the node of this alarm.\n   */\n  self.nodeLabel = self.serviceLostEvent.nodeLabel;\n\n  /**\n   * @description Helper method to get a friendly node label. It will generate\n   *              a node label based on the node ID if the nodeLabel property\n   *              is not defined or is empty.\n   * @ngdoc method\n   * @name Outage#getNodeName\n   * @methodOf Outage\n   * @returns {string} a formatted node label using the nodeLabel or the nodeId formatted into a string.\n   */\n  self.getNodeName = function() {\n    if (self.nodeLabel === undefined || self.nodeLabel === '') {\n      return 'Node ' + self.nodeId;\n    } else {\n      return self.nodeLabel;\n    }\n  };\n\n  /**\n   * @description Provides a formatted severity CSS class\n   * @ngdoc method\n   * @name Outage#getSeverityClass\n   * @methodOf Outage\n   * @returns {string} formatted CSS class name\n   */\n  self.getSeverityClass = function() {\n    if (this.serviceLostEvent.severity !== null && angular.isString(this.serviceLostEvent.severity) && this.serviceLostEvent.severity.length !== 0) {\n      return 'severity-'+angular.uppercase(this.serviceLostEvent.severity);\n    }\n    return '';\n  };\n}\n\nmodule.exports = Outage;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/outages/models/Outage.js\n ** module id = 177\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/outages/models/Outage.js?");

/***/ },
/* 178 */
/*!**************************************************!*\
  !*** ./src/app/nodes/models/MonitoredService.js ***!
  \**************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name MonitoredService\n * @param {Object} svc an service JSON object\n * @constructor\n */\nfunction MonitoredService(svc) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name MonitoredService#id\n   * @propertyOf MonitoredService\n   * @returns {number} The unique service ID\n   */\n  self.id = svc['_id'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name MonitoredService#ipINterfaceId\n   * @propertyOf MonitoredService\n   * @returns {number} The unique ID of the IP interface this monitored service is associated with.\n   */\n  self.ipInterfaceId = svc['ipInterfaceId'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name MonitoredService#serviceId\n   * @propertyOf MonitoredService\n   * @returns {number} The unique ID of the service type this monitored service is of.\n   */\n  self.serviceId = svc['serviceType']['_id'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name MonitoredService#serviceName\n   * @propertyOf MonitoredService\n   * @returns {string} The human-readable name of the service type this monitored service is of.\n   */\n  self.serviceName = svc['serviceType']['name'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name MonitoredService#status\n   * @propertyOf MonitoredService\n   * @returns {*} the monitored service status.\n   */\n  self.status = svc['_status'];\n}\n\nmodule.exports = MonitoredService;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/models/MonitoredService.js\n ** module id = 178\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/models/MonitoredService.js?");

/***/ },
/* 179 */
/*!*************************************************!*\
  !*** ./src/app/outages/models/OutageSummary.js ***!
  \*************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name OutageSummary\n * @param {Object} data an outage summary JSON object\n * @constructor\n */\nfunction OutageSummary(data) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name OutageSummary#nodeid\n   * @propertyOf OutageSummary\n   * @returns {number} Unique integer identifier for node\n   */\n  self.nodeId = parseInt(data['_node-id'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name OutageSummary#nodeLabel\n   * @propertyOf OutageSummary\n   * @returns {string} The human-readable name of the node of this alarm.\n   */\n  self.nodeLabel = data['_node-label'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name OutageSummary#down\n   * @propertyOf OutageSummary\n   * @returns {*|Date} The time the outage started.\n   */\n  self.down = data['_time-down']? moment(data['_time-down']) : undefined;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name OutageSummary#up\n   * @propertyOf OutageSummary\n   * @returns {*|Date} The time the outage was resolved.\n   */\n  self.up = data['_time-up']? moment(data['_time-up']) : undefined;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name OutageSummary#now\n   * @propertyOf OutageSummary\n   * @returns {*|Date} The time the outage was retrieved from the server.\n   */\n  self.now = data['_time-now']? moment(data['_time-now']) : undefined;\n\n  /**\n   * @description Helper method to get a friendly node label. It will generate\n   *              a node label based on the node ID if the nodeLabel property\n   *              is not defined or is empty.\n   * @ngdoc method\n   * @name Outage#getNodeName\n   * @methodOf Outage\n   * @returns {string} a formatted node label using the nodeLabel or the nodeId formatted into a string.\n   */\n  self.getNodeName = function() {\n    if (self.nodeLabel === undefined || self.nodeLabel.trim() === '') {\n      return 'Node ' + self.nodeId;\n    } else {\n      return self.nodeLabel;\n    }\n  };\n}\n\nmodule.exports = OutageSummary;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/outages/models/OutageSummary.js\n ** module id = 179\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/outages/models/OutageSummary.js?");

/***/ },
/* 180 */
/*!********************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/alarms/alarm-detail.html ***!
  \********************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/alarms/alarm-detail.html';\nvar html = \"<ion-modal-view class=\\\"alarm-detail\\\">\\n\\t<ion-header-bar>\\n\\t\\t<div class=\\\"buttons\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"hide()\\\">Close</button>\\n\\t\\t</div>\\n\\t\\t<h1 class=\\\"title\\\">{{alarm.title}}</h1>\\n\\t</ion-header-bar>\\n\\t<ion-content ng-class=\\\"'severity severity-' + alarm.severity\\\">\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"updateAlarmData()\\\"></ion-refresher>\\n\\t\\t<ion-list>\\n\\t\\t\\t<ion-item ng-class=\\\"'item-divider item-compass item-icon-right severity severity-' + alarm.severity\\\">\\n\\t\\t\\t\\tAlarm Details\\n\\t\\t\\t\\t<i ng-class=\\\"'icon severity severity-' + alarm.severity + ' ' + util.icon(alarm.severity)\\\" title=\\\"{{alarm.severity.capitalize()}}\\\"></i>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">ID</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.id}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">UEI</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.uei}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\" style=\\\"vertical-align: middle\\\">Severity</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\" style=\\\"vertical-align: middle\\\">{{alarm.severity.capitalize()}}</div>\\n\\t\\t\\t\\t<div class=\\\"col col-10 pull-right\\\"><button class=\\\"button button-small\\\" ng-click=\\\"clear()\\\"><i class=\\\"icon ion-happy-outline\\\"></i></button></div>\\n\\t\\t\\t\\t<div class=\\\"col col-10 pull-right\\\"><button class=\\\"button button-small\\\" ng-click=\\\"escalate()\\\"><i class=\\\"icon ion-arrow-up-a\\\"></i></button></div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">Count</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.count}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\" ng-if=\\\"alarm.nodeLabel\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\" >Node</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.nodeLabel}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\" ng-if=\\\"alarm.ipAddress\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">Interface</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.ipAddress}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">First Event</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.firstEventTime.format('lll')}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">Last Event</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.lastEventTime.format('lll')}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\" ng-if=\\\"alarm.troubleTicketId\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">Ticket State</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.troubleTicketState}} ({{alarm.troubleTicketId}})</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\tLog Message\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"item-text-wrap message\\\"><p ng-bind-html=\\\"alarm.logMessage\\\"></p></ion-item>\\n\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\tDescription\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item ng-bind-html=\\\"alarm.description\\\" class=\\\"item-text-wrap message\\\"></ion-item>\\n\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\tAcknowledgements\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<span ng-if=\\\"alarm.ackUser\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"row\\\" ng-if=\\\"alarm.ackUser\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-33\\\">User</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.ackUser}}</div>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row\\\" ng-if=\\\"alarm.ackUser\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-33\\\">Time</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{alarm.ackTime.format('lll')}}</div>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"alarm.ackUser\\\">\\n\\t\\t\\t\\t\\t<button class=\\\"button button-block button-compass\\\" ng-click=\\\"unacknowledge()\\\">Unacknowledge This Alarm</button>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<ion-item ng-if=\\\"!alarm.ackUser\\\">\\n\\t\\t\\t\\t<button class=\\\"button button-block button-compass\\\" ng-click=\\\"acknowledge()\\\">Acknowledge This Alarm</button>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<span ng-if=\\\"alarm.stickyMemo\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tSticky Memo\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"alarm.stickyMemo\\\">\\n\\t\\t\\t\\t\\t<p>Last Updated at {{alarm.stickyMemo.updated.format('lll')}} by {{alarm.stickyMemo.author}}</p>\\n\\t\\t\\t\\t\\t<p ng-bind-html=\\\"alarm.stickyMemo.body\\\"></p>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<span ng-if=\\\"alarm.journalMemo\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tJournal Memo\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"alarm.journalMemo\\\">\\n\\t\\t\\t\\t\\t<p>Last Updated at {{alarm.journalMemo.updated.format('lll')}} by {{alarm.journalMemo.author}}</p>\\n\\t\\t\\t\\t\\t<p ng-bind-html=\\\"alarm.journalMemo.body\\\"></p>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-modal-view>\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/alarms/alarm-detail.html\n ** module id = 180\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/alarms/alarm-detail.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 181 */
/*!****************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/outages/outages.html ***!
  \****************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/outages/outages.html';\nvar html = \"<ion-modal-view class=\\\"outage-list\\\">\\n\\t<ion-header-bar>\\n\\t\\t<div class=\\\"buttons\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"hide()\\\">Close</button>\\n\\t\\t</div>\\n\\t\\t<h1 class=\\\"title\\\">Nodes with Outages</h1>\\n\\t</ion-header-bar>\\n\\t<ion-content>\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"refreshOutages()\\\"></ion-refresher>\\n\\t\\t<ion-list>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"error\\\" class=\\\"item-text-wrap error\\\">\\n\\t\\t\\t\\t\\tError: Unable to retrieve outage summaries.\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<span ng-repeat=\\\"outage in outages track by outage.nodeId\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\" ng-click=\\\"showNode(outage.nodeId)\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"item-note\\\">{{outage.down.fromNow()}}</span>\\n\\t\\t\\t\\t\\t<h2>{{outage.getNodeName()}}</h2>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"no-top no-bottom\\\" ng-if=\\\"angular.isUndefined(outage.nodeOutages)\\\">\\n\\t\\t\\t\\t\\t<ion-spinner></ion-spinner> Loading...\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-repeat=\\\"nodeOutage in outage.nodeOutages track by nodeOutage.id\\\" ng-class=\\\"'severity ' + nodeOutage.getSeverityClass()\\\" class=\\\"no-top no-bottom\\\" ng-click=\\\"showNode(outage.nodeId)\\\" ng-click=\\\"showNode(outage.nodeId)\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"row\\\">\\n\\t\\t\\t\\t\\t\\t<div class=\\\"col\\\" style=\\\"text-overflow: ellipsis; overflow: hidden\\\">{{nodeOutage.ipAddress}}</div>\\n\\t\\t\\t\\t\\t\\t<div class=\\\"col col-20 pull-right\\\">{{nodeOutage.monitoredService.serviceName}}</div>\\n\\t\\t\\t\\t\\t\\t<div class=\\\"col col-10 pull-right\\\"><i ng-class=\\\"'icon severity ' + nodeOutage.getSeverityClass() + ' ' + util.icon(nodeOutage.serviceLostEvent.severity)\\\" title=\\\"{{nodeOutage.serviceLostEvent.severity}}\\\"></i></div>\\n\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-modal-view>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/outages/outages.html\n ** module id = 181\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/outages/outages.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 182 */
/*!******************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/settings/settings.html ***!
  \******************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/settings/settings.html';\nvar html = \"<ion-modal-view class=\\\"settings\\\" ng-controller=\\\"SettingsCtrl\\\">\\n\\t<ion-header-bar class=\\\"bar-light\\\">\\n\\t\\t<div class=\\\"buttons\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"hide()\\\">Close</button>\\n\\t\\t</div>\\n\\t\\t<h1 class=\\\"title\\\">Settings</h1>\\n\\t\\t<div class=\\\"buttons\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"addServer()\\\" ng-if=\\\"!hideAddButton\\\">Add</button>\\n\\t\\t</div>\\n\\t</ion-header-bar>\\n\\t<ion-content scroll=\\\"false\\\">\\n\\t\\t<ion-tabs class=\\\"tabs-compass tabs-icon-left\\\" ng-keypress=\\\"handleKey($event)\\\">\\n\\t\\t\\t<ion-tab title=\\\"Settings\\\" icon-on=\\\"ion-ios-gear\\\" icon-off=\\\"ion-ios-gear-outline\\\" scroll=\\\"true\\\" on-select=\\\"hideAddButton = false\\\" on-deselect=\\\"hideAddButton = true\\\">\\n\\t\\t\\t\\t<ion-view class=\\\"servers\\\">\\n\\t\\t\\t\\t\\t<ion-content scroll=\\\"true\\\">\\n\\t\\t\\t\\t\\t\\t<ion-list show-delete=\\\"showDelete\\\" show-reorder=\\\"false\\\" can-swipe=\\\"true\\\" delegate-handle=\\\"server-list\\\">\\n\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item item-divider\\\">Servers</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t<ion-item ng-repeat=\\\"server in servers track by server.name\\\" class=\\\"item item-icon-left item-icon-right compass\\\" ng-click=\\\"selectServer(server)\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<i ng-class=\\\"'icon ' + (isDefaultServer(server)? 'ion-checkmark':'')\\\"></i>\\n\\t\\t\\t\\t\\t\\t\\t\\t<h2>{{server.name}}</h2>\\n\\t\\t\\t\\t\\t\\t\\t\\t<p>{{server.url}}</p>\\n\\t\\t\\t\\t\\t\\t\\t\\t<i class=\\\"icon onms-grabber\\\" style=\\\"right:-5\\\"></i>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-option-button class=\\\"button-compass\\\" ng-click=\\\"editServer(server)\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<!-- <i class=\\\"icon ion-edit\\\"></i> -->\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tEdit\\n\\t\\t\\t\\t\\t\\t\\t\\t</ion-option-button>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-option-button class=\\\"button-assertive\\\" ng-click=\\\"deleteServer(server)\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<!-- <i class=\\\"icon ion-trash-a\\\"></i> -->\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tDelete\\n\\t\\t\\t\\t\\t\\t\\t\\t</ion-option-button>\\n\\t\\t\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t\\t\\t</ion-list>\\n\\t\\t\\t\\t\\t</ion-content>\\n\\t\\t\\t\\t</ion-view>\\n\\t\\t\\t</ion-tab>\\n\\t\\t\\t<ion-tab title=\\\"About\\\" icon-on=\\\"ion-ios-information\\\" icon-off=\\\"ion-ios-information-outline\\\">\\n\\t\\t\\t\\t<ion-view class=\\\"errors\\\">\\n\\t\\t\\t\\t\\t<ion-content scroll=\\\"true\\\">\\n\\t\\t\\t\\t\\t\\t<ion-list>\\n\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">About OpenNMS Compass</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"row\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">Version:</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{version}}</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"row\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">Build:</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{build}}</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"row\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">Server:</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col\\\" ng-click=\\\"util.openServer()\\\">{{serverURL}}</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"row\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">User:</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{username}}</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t<span ng-if=\\\"serverName !== undefined\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tOpenNMS Server Information\\n\\t\\t\\t\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"row\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">Type:</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{info.packageDescription}}</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"row\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">Version:</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{info.version === '0.0.0'? 'Unknown':info.version}}</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap severity-WARNING\\\" ng-if=\\\"info.version === '0.0.0'\\\">Your OpenNMS does not support reporting server version information.</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap\\\" ng-if=\\\"hasAvailability\\\">Your OpenNMS server supports the Availability API.</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap severity-WARNING\\\" ng-if=\\\"!hasAvailability\\\">Your OpenNMS server does not support the Availability API. Dashboard availability by category requires Meridian 2015 or Horizon 15.0.2.</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap\\\" ng-if=\\\"canSetLocation\\\">Your OpenNMS server\\n\\t\\t\\t\\t\\t\\t\\t\\tsupports updating node geolocation information.</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap severity-WARNING\\\" ng-if=\\\"!canSetLocation\\\">Your OpenNMS server\\n\\t\\t\\t\\t\\t\\t\\t\\tdoes not support updating node geolocation information.  Updating node coordinates\\n\\t\\t\\t\\t\\t\\t\\t\\trequires Meridian 2015 or Horizon 15.0.2.</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t\\t<span ng-if=\\\"errors &amp;&amp; errors.length &gt; 0\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item class=\\\"item-divider item-assertive row\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-50\\\">Errors</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-50 pull-right\\\" ng-click=\\\"clearErrors()\\\">Clear</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ion-item ng-repeat=\\\"error in errors\\\" class=\\\"row item-text-wrap\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\\"col col-25\\\">{{formatType(error.type)}}</span>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\\"col col-75\\\">{{getErrorMessage(error)}}</span>\\n\\t\\t\\t\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t</ion-list>\\n\\t\\t\\t\\t\\t</ion-content>\\n\\t\\t\\t\\t</ion-view>\\n\\t\\t\\t</ion-tab>\\n\\t\\t</ion-tabs>\\n\\t</ion-content>\\n</ion-modal-view>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/settings/settings.html\n ** module id = 182\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/settings/settings.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 183 */
/*!********************************************!*\
  !*** ./src/app/alarms/AlarmsController.js ***!
  \********************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tAlarmFilter = __webpack_require__(/*! ./AlarmFilter */ 175);\n\n\t__webpack_require__(/*! ./AlarmService */ 173);\n\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\n\t__webpack_require__(/*! ../misc/Errors */ 166);\n\t__webpack_require__(/*! ../misc/Modals */ 172);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tvar alarmsTemplate = __webpack_require__(/*! ngtemplate!html!./alarms.html */ 184);\n\tvar filterTemplate = __webpack_require__(/*! ngtemplate!html!./alarm-filter.html */ 185);\n\tvar loadingTemplate = __webpack_require__(/*! ngtemplate!html!../misc/loading.html */ 186);\n\n\tangular.module('opennms.controllers.Alarms', [\n\t\t'ionic',\n\t\t'angularLocalStorage',\n\t\t'opennms.services.Alarms',\n\t\t'opennms.services.Errors',\n\t\t'opennms.services.Modals',\n\t\t'opennms.services.Util',\n\t\t'opennms.services.Servers'\n\t])\n\t.value('severities', {})\n\t.config(function($stateProvider) {\n\t\t$stateProvider\n\t\t.state('alarms', {\n\t\t\turl: '/alarms',\n\t\t\ttemplateUrl: alarmsTemplate,\n\t\t\tcontroller: 'AlarmsCtrl'\n\t\t});\n\t})\n\t.factory('severityStateTracker', function(util, severities) {\n\t\t/* jshint -W003: true */\n\t\t/* jshint -W026: true */\n\n\t\tvar severityNames = util.severities();\n\n\t\tfor (var i=0, len=severityNames.length; i < len; i++) {\n\t\t\tseverities[severityNames[i]] = true;\n\t\t}\n\n\t\tvar service = {\n\t\t\tget: get,\n\t\t\tall: all,\n\t\t\tisEnabled: isEnabled,\n\t\t\tenable: enable,\n\t\t\tdisable: disable,\n\t\t\ttoggle: toggle\n\t\t};\n\t\treturn service;\n\n\t\tfunction isEnabled(severity) {\n\t\t\treturn severities[severity];\n\t\t}\n\n\t\tfunction enable(severity) {\n\t\t\tseverities[severity] = true;\n\t\t}\n\n\t\tfunction disable(severity) {\n\t\t\tseverities[severity] = false;\n\t\t}\n\n\t\tfunction get(severity) {\n\t\t\treturn isEnabled(severity)? 'enabled':'disabled';\n\t\t}\n\n\t\tfunction all() {\n\t\t\tvar ret = {};\n\t\t\tfor (var sev in severities) {\n\t\t\t\tret[sev] = get(sev);\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\n\t\tfunction toggle(severity) {\n\t\t\tseverities[severity] = !isEnabled(severity);\n\t\t}\n\t})\n\t.filter('severity', function(severities) {\n\t\tfunction severity(alarms) {\n\t\t\tif (alarms) {\n\t\t\t\treturn alarms.filter(function(alarm) {\n\t\t\t\t\treturn severities[alarm.severity];\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn alarms;\n\t\t\t}\n\t\t}\n\n\t\t//severity.$stateful = true;\n\t\treturn severity;\n\t})\n\t.controller('AlarmsCtrl', function($q, $scope, $log, $timeout, $ionicListDelegate, $ionicLoading, $ionicModal, $ionicPopup, $ionicScrollDelegate, $ionicViewSwitcher, storage, util, AlarmService, Errors, Modals, Servers, severityStateTracker, severities) {\n\t\t$log.info('AlarmsCtrl initializing.');\n\n\t\tvar filterParams = storage.get('opennms.alarms.filterParams');\n\t\tif (!filterParams) {\n\t\t\tfilterParams = {limit:100};\n\t\t}\n\n\t\t$scope.modals = Modals;\n\t\t$scope.util  = util;\n\t\t$scope.alarms = undefined;\n\t\t$scope.legend = [];\n\t\t$scope.filter = new AlarmFilter(filterParams).reset();\n\t\t$scope.showAck = false;\n\t\t$scope.severities = severities;\n\n\t\t$log.debug('alarm filter: ' + angular.toJson($scope.filter));\n\t\tServers.getDefault().then(function(server) {\n\t\t\tif (server && server.username) {\n\t\t\t\t$scope.username = server.username;\n\t\t\t}\n\t\t});\n\n\t\t$scope.toggleSeverity = function(item) {\n\t\t\tseverityStateTracker.toggle(item.severity);\n\t\t\t//$log.debug(item.severity + '=' + severityStateTracker.get(item.severity));\n\t\t};\n\n\t\t$ionicModal.fromTemplateUrl(filterTemplate, {\n\t\t\tscope: $scope,\n\t\t\tanimation: 'slide-in-up'\n\t\t}).then(function(modal) {\n\t\t\t$scope.modal = modal;\n\t\t\tmodal.scope.$on('modal.hidden', function() {\n\t\t\t\tstorage.set('opennms.alarms.filterParams', $scope.filter);\n\t\t\t});\n\t\t});\n\n\t\tvar sortAlarms = function(a, b) {\n\t\t\treturn a.id - b.id;\n\t\t};\n\n\t\t$scope.getAlarms = function() {\n\t\t\t$ionicLoading.show({\n\t\t\t\ttemplateUrl: loadingTemplate,\n\t\t\t\thideOnStateChange: true\n\t\t\t});\n\n\t\t\tAlarmService.get($scope.filter).then(function(alarms) {\n\t\t\t\t//$log.debug('got alarms=',alarms);\n\t\t\t\t$scope.alarms = alarms;\n\t\t\t\tif (!$scope.alarms) {\n\t\t\t\t\t$scope.alarms = [];\n\t\t\t\t}\n\n\t\t\t\tErrors.clear('alarms');\n\n\t\t\t\tdelete $scope.error;\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t$ionicLoading.hide();\n\t\t\t}, function(err) {\n\t\t\t\tErrors.set('alarms', err);\n\t\t\t\t$scope.error = err;\n\t\t\t\t$scope.alarms = [];\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t$ionicLoading.hide();\n\t\t\t});\n\n\t\t\tAlarmService.severities(new AlarmFilter({limit:100,minimumSeverity:'INDETERMINATE'})).then(function(severities) {\n\t\t\t\t$scope.legend = severities;\n\t\t\t});\n\t\t};\n\n\t\t$scope.refreshAlarms = function() {\n\t\t\t$timeout(function() {\n\t\t\t\tvar delegate = $ionicScrollDelegate.$getByHandle('alarms-scroll');\n\t\t\t\tif (delegate) {\n\t\t\t\t\tdelegate.scrollTop();\n\t\t\t\t}\n\t\t\t\t$scope.filter = $scope.filter.reset();\n\t\t\t\t$scope.getAlarms();\n\t\t\t});\n\t\t};\n\n\t\tvar doThenRefresh = function(promise) {\n\t\t\tpromise['finally'](function() {\n\t\t\t\tutil.dirty('alarms');\n\t\t\t});\n\t\t};\n\n\t\t$scope.openAlarm = function(alarm) {\n\t\t\t$scope.modals.alarm(alarm);\n\t\t};\n\n\t\t$scope.toggleAck = function(alarm, e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tif (alarm.ackUser) {\n\t\t\t\tAlarmService.unacknowledge(alarm).then(undefined, function(err) {\n\t\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\t\ttemplate: '<p>Unable to unacknowledge alarm.</p>\\n' +\n\t\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to unacknowledge alarms.',\n\t\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tAlarmService.acknowledge(alarm).then(undefined, function(err) {\n\t\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\t\ttemplate: '<p>Unable to acknowledge alarm.</p>\\n' +\n\t\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to acknowledge alarms.',\n\t\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t$ionicListDelegate.closeOptionButtons();\n\t\t};\n\n\t\t$scope.clear = function(alarm, e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tAlarmService.clear(alarm).then(undefined, function(err) {\n\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\ttemplate: '<p>Unable to clear alarm.</p>\\n' +\n\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to clear alarms.',\n\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\t$ionicListDelegate.closeOptionButtons();\n\t\t};\n\n\t\t$scope.escalate = function(alarm, e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tAlarmService.escalate(alarm).then(undefined, function(err) {\n\t\t\t\tif (err.permissionDenied()) {\n\t\t\t\t\t$ionicPopup.alert({\n\t\t\t\t\t\ttitle: 'Permission Denied',\n\t\t\t\t\t\ttemplate: '<p>Unable to escalate alarm.</p>\\n' +\n\t\t\t\t\t\t\t'User \"' + $scope.username + '\" does not have permission to escalate alarms.',\n\t\t\t\t\t\tokType: 'button-assertive'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\t$ionicListDelegate.closeOptionButtons();\n\t\t};\n\n\t\tutil.onDirty('alarms', $scope.refreshAlarms);\n\t\tutil.onDefaultServerUpdated(function(defaultServer) {\n\t\t\tif (defaultServer && defaultServer.username) {\n\t\t\t\t$scope.username = defaultServer.username;\n\t\t\t} else {\n\t\t\t\t$scope.username = undefined;\n\t\t\t}\n\t\t});\n\n\t\t$scope.$on('modal.hidden', $scope.refreshAlarms);\n\t\t$scope.$on('$ionicView.beforeEnter', $scope.refreshAlarms);\n\t\t$scope.$on('$destroy', function() {\n\t\t\t$scope.modal.remove();\n\t\t});\n\t});\n\n}());\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/alarms/AlarmsController.js\n ** module id = 183\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/alarms/AlarmsController.js?");

/***/ },
/* 184 */
/*!**************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/alarms/alarms.html ***!
  \**************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/alarms/alarms.html';\nvar html = \"<ion-view view-title=\\\"Alarms\\\" class=\\\"alarms\\\">\\n\\t<ion-nav-bar class=\\\"bar-light\\\" align-title=\\\"center\\\">\\n\\t\\t<ion-nav-buttons side=\\\"left\\\">\\n\\t\\t\\t<button ng-if=\\\"modal\\\" class=\\\"button button-compass button-clear\\\" ng-click=\\\"modal.show()\\\"><i class=\\\"icon ion-ios-settings\\\"></i> Filter</button>\\n\\t\\t</ion-nav-buttons>\\n\\t\\t<ion-nav-buttons side=\\\"right\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ui-sref=\\\"dashboard({refresh:false})\\\" nav-direction=\\\"forward\\\">Dashboard <i class=\\\"icon ion-ios-arrow-right\\\"></i></button>\\n\\t\\t</ion-nav-buttons>\\n\\t</ion-nav-bar>\\n\\t<ion-header-bar class=\\\"bar bar-subheader legend row box\\\" ng-if=\\\"legend.length &gt; 0\\\">\\n\\t\\t<div ng-class=\\\"'col severity-' + item.severity + ' ' + (severities[item.severity]? 'enabled':'disabled')\\\" ng-repeat=\\\"item in legend track by item.severity\\\" ng-click=\\\"toggleSeverity(item)\\\"><i ng-class=\\\"'icon severity severity-' + item.severity + ' ' + util.icon(item.severity)\\\"></i> {{item.count}}</div>\\n\\t</ion-header-bar>\\n\\t<ion-content delegate-handle=\\\"alarms-scroll\\\" ng-class=\\\"legend.length &gt; 0? 'has-subheader':''\\\">\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"refreshAlarms()\\\"></ion-refresher>\\n\\t\\t<ion-list can-swipe=\\\"true\\\">\\n\\t\\t\\t<ion-item ng-if=\\\"alarms &amp;&amp; alarms.length === 0 &amp;&amp; !error\\\">\\n\\t\\t\\t\\tNo {{filter.showAcknowledged? 'matching':'unacknowledged'}} alarms found.\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item ng-class=\\\"'item-text-wrap error'\\\" ng-if=\\\"error\\\">\\n\\t\\t\\t\\tAn error occurred retrieving alarm data.\\n\\t\\t\\t\\t<span ng-if=\\\"error.permissionDenied()\\\">\\n\\t\\t\\t\\t\\tPermission denied.\\n\\t\\t\\t\\t</span>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item ng-class=\\\"'item item-text-wrap item-icon-right severity-' + alarm.severity\\\" ng-repeat=\\\"alarm in alarms | severity track by alarm.id\\\"\\n\\t\\t\\t\\tcollection-item-height=\\\"120\\\" ng-click=\\\"openAlarm(alarm)\\\">\\n\\t\\t\\t\\t<ion-delete-button class=\\\"ion-ios-checkmark-outline\\\" ng-click=\\\"acknowledge(alarm)\\\"></ion-delete-button>\\n\\t\\t\\t\\t<span class=\\\"item-note\\\">{{alarm.lastEventTime.fromNow()}}</span>\\n\\t\\t\\t\\t<h2>{{alarm.title}}<span ng-if=\\\"alarm.severity === 'CLEARED'\\\"> (Cleared)</span></h2>\\n\\t\\t\\t\\t<p>{{alarm.nodeLabel}}</p>\\n\\t\\t\\t\\t<p ng-bind-html=\\\"alarm.logMessage\\\" class=\\\"message\\\"></p>\\n\\t\\t\\t\\t<i ng-class=\\\"'icon severity severity-' + alarm.severity + ' ' + util.icon(alarm.severity)\\\" title=\\\"{{alarm.severity}}\\\"></i>\\n\\t\\t\\t\\t<ion-option-button ng-click=\\\"clear(alarm, $event)\\\" ng-if=\\\"alarm.severity !== 'CLEARED'\\\">Clear</ion-option-button>\\n\\t\\t\\t\\t<ion-option-button ng-click=\\\"escalate(alarm, $event)\\\" ng-if=\\\"alarm.severity !== 'CRITICAL'\\\">Escalate</ion-option-button>\\n\\t\\t\\t\\t<ion-option-button ng-click=\\\"toggleAck(alarm, $event)\\\">{{alarm.ackUser? 'Unack':'Ack'}}</ion-option-button>\\n\\t\\t\\t\\t<div class=\\\"bottom-fade\\\"></div>\\n\\t\\t\\t</ion-item>\\n\\t\\t</ion-list>\\n\\t\\t<!-- <ion-infinite-scroll on-infinite=\\\"getAlarms()\\\" ng-if=\\\"canLoadMore()\\\"></ion-infinite-scroll> -->\\n\\t</ion-content>\\n</ion-view>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/alarms/alarms.html\n ** module id = 184\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/alarms/alarms.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 185 */
/*!********************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/alarms/alarm-filter.html ***!
  \********************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/alarms/alarm-filter.html';\nvar html = \"<ion-modal-view>\\n\\t<ion-header-bar>\\n\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"modal.hide()\\\">Close</button>\\n\\t\\t<h1 class=\\\"title\\\">Alarm Filters</h1>\\n\\t</ion-header-bar>\\n\\t<ion-content scroll=\\\"false\\\">\\n\\t\\t<ion-list>\\n\\t\\t\\t<div class=\\\"item item-toggle\\\">\\n\\t\\t\\t\\tShow Acknowledged?\\n\\t\\t\\t\\t<label class=\\\"toggle toggle-compass\\\">\\n\\t\\t\\t\\t\\t<input type=\\\"checkbox\\\" ng-model=\\\"filter.showAcknowledged\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"track\\\">\\n\\t\\t\\t\\t\\t\\t<div class=\\\"handle\\\"></div>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</label>\\n\\t\\t\\t</div>\\n\\t\\t\\t<div class=\\\"item item-toggle\\\">\\n\\t\\t\\t\\tNewest First?\\n\\t\\t\\t\\t<label class=\\\"toggle toggle-compass\\\">\\n\\t\\t\\t\\t\\t<input type=\\\"checkbox\\\" ng-model=\\\"filter.newestFirst\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"track\\\">\\n\\t\\t\\t\\t\\t\\t<div class=\\\"handle\\\"></div>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</label>\\n\\t\\t\\t</div>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-modal-view>\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/alarms/alarm-filter.html\n ** module id = 185\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/alarms/alarm-filter.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 186 */
/*!*************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/misc/loading.html ***!
  \*************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/misc/loading.html';\nvar html = \"<ion-spinner></ion-spinner><br>\\nLoading...\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/misc/loading.html\n ** module id = 186\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/loading.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 187 */
/*!**************************************************!*\
  !*** ./src/app/dashboard/DashboardController.js ***!
  \**************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tAlarmFilter = __webpack_require__(/*! ../alarms/AlarmFilter */ 175),\n\t\t$ = __webpack_require__(/*! jquery */ 5);\n\n\t__webpack_require__(/*! ../alarms/AlarmService */ 173);\n\t__webpack_require__(/*! ../availability/AvailabilityService */ 188);\n\t__webpack_require__(/*! ../nodes/ResourceService */ 194);\n\t__webpack_require__(/*! ../outages/OutageService */ 176);\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\t__webpack_require__(/*! ../misc/Errors */ 166);\n\t__webpack_require__(/*! ../misc/Info */ 119);\n\t__webpack_require__(/*! ../misc/Modals */ 172);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tvar dashboardTemplate = __webpack_require__(/*! ngtemplate!html!./dashboard.html */ 198);\n\tvar loadingTemplate = __webpack_require__(/*! ngtemplate!html!../misc/loading.html */ 186);\n\tvar serverPopoverTemplate = __webpack_require__(/*! ngtemplate!html!./server-popover.html */ 199);\n\n\tvar severityOrder = [\n\t\t'INDETERMINATE',\n\t\t'CLEARED',\n\t\t'NORMAL',\n\t\t'WARNING',\n\t\t'MINOR',\n\t\t'MAJOR',\n\t\t'CRITICAL'\n\t];\n\n\tvar sortAlarmData = function(a, b) {\n\t\treturn severityOrder.indexOf(b.label.toUpperCase()) - severityOrder.indexOf(a.label.toUpperCase());\n\t};\n\n\tangular.module('opennms.controllers.Dashboard', [\n\t\t'ionic',\n\t\t'angular-flot',\n\t\t'rt.debounce',\n\t\t'opennms.services.Alarms',\n\t\t'opennms.services.Availability',\n\t\t'opennms.services.Errors',\n\t\t'opennms.services.Info',\n\t\t'opennms.services.Modals',\n\t\t'opennms.services.Outages',\n\t\t'opennms.services.Resources',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Settings', // for default-graph-min-range\n\t\t'opennms.services.Util'\n\t])\n\t.config(function($stateProvider) {\n\t\t$stateProvider\n\t\t.state('dashboard', {\n\t\t\turl: '/dashboard',\n\t\t\tparams: {\n\t\t\t\trefresh: true\n\t\t\t},\n\t\t\ttemplateUrl: dashboardTemplate,\n\t\t\tcontroller: 'DashboardCtrl'\n\t\t});\n\t})\n\t.controller('DashboardCtrl', function($q, $rootScope, $scope, $injector, $interval, $log, $timeout, $state, $document, $window, $ionicLoading, $ionicPopup, $ionicPopover, $ionicSlideBoxDelegate, debounce, AlarmService, AvailabilityService, Errors, Info, Modals, OutageService, ResourceService, Servers, util) {\n\t\t$log.info('DashboardCtrl: Initializing.');\n\n\t\t$scope.donuts = {};\n\n\t\tvar updateArrows = function(height) {\n\t\t\tvar arrowOffset = Math.round(height * 0.5) - 50;\n\n\t\t\tvar outageArrow = document.getElementById('outage-arrow');\n\t\t\tif (outageArrow) {\n\t\t\t\toutageArrow.style.top = arrowOffset + 'px';\n\t\t\t}\n\n\t\t\tvar alarmArrow = document.getElementById('alarm-arrow');\n\t\t\tif (alarmArrow) {\n\t\t\t\talarmArrow.style.top = arrowOffset + 'px';\n\t\t\t}\n\t\t};\n\n\t\t$scope.refreshDonutSlide = function(index) {\n\t\t\t$scope.currentDonutSlide = index;\n\t\t};\n\n\t\tvar shouldHideDonut = {\n\t\t\talarms: true,\n\t\t\toutages: true\n\t\t};\n\n\t\tvar hideDonut = function(type, value) {\n\t\t\tif (value === true) {\n\t\t\t\tshouldHideDonut[type] = true;\n\t\t\t} else {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tshouldHideDonut[type] = false;\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t};\n\n\t\t$scope.donutClass = function(type) {\n\t\t\tif (shouldHideDonut[type]) {\n\t\t\t\treturn 'invisible';\n\t\t\t} else {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t};\n\n\t\tvar updateLogo = function(info) {\n\t\t\tif (!info) {\n\t\t\t\tinfo = Info.get();\n\t\t\t}\n\t\t\tif (info.packageName === 'meridian') {\n\t\t\t\t$scope.logo = 'images/meridian.svg';\n\t\t\t} else {\n\t\t\t\t$scope.logo = 'images/horizon.svg';\n\t\t\t}\n\t\t};\n\n\t\tvar sortFavorites = function(a, b) {\n\t\t\tvar ret = a.nodeLabel.localeCompare(b.nodeLabel);\n\t\t\tif (ret === 0) {\n\t\t\t\tret = a.graphName.localeCompare(b.graphName);\n\t\t\t}\n\t\t\treturn ret;\n\t\t};\n\n\t\tvar refreshFavorites = function() {\n\t\t\t//$log.debug('refreshing favorites');\n\t\t\t$scope.graphs = {};\n\t\t\t$scope.favoriteGraphs = [];\n\t\t\treturn ResourceService.favorites().then(function(favs) {\n\t\t\t\tvar favorite,\n\t\t\t\t\tgraphPromises = [];\n\n\t\t\t\tfavs.sort(sortFavorites);\n\n\t\t\t\tfor (var i=0, len=favs.length; i < len; i++) {\n\t\t\t\t\tfavorite = favs[i];\n\t\t\t\t\tgraphPromises.push(ResourceService.graph(favorite.graphName));\n\t\t\t\t}\n\n\t\t\t\treturn $q.all(graphPromises).then(function(gds) {\n\t\t\t\t\tvar graphDefs = {}, def;\n\t\t\t\t\tfor (var i=0, len=gds.length; i < len; i++) {\n\t\t\t\t\t\tdef = gds[i];\n\t\t\t\t\t\tgraphDefs[def.name] = def;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($scope.currentGraphSlide >= favs.length) {\n\t\t\t\t\t\t// \"current\" graph is now higher than the number of graphs we have\n\t\t\t\t\t\t$scope.currentGraphSlide = 0;\n\t\t\t\t\t}\n\t\t\t\t\t$scope.graphs = graphDefs;\n\t\t\t\t\t$scope.favoriteGraphs = favs;\n\t\t\t\t});\n\t\t\t}).finally(function() {\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t$timeout(function() {\n\t\t\t\t\tvar delegate = $ionicSlideBoxDelegate.$getByHandle('graph-slide-box');\n\t\t\t\t\tdelegate.slide($scope.currentGraphSlide);\n\t\t\t\t\tdelegate.update();\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar resetFavorites = function() {\n\t\t\t$scope.graphs = [];\n\t\t\t$scope.favoriteGraphs = [];\n\t\t};\n\n\t\tvar refreshAvailability = function() {\n\t\t\treturn AvailabilityService.availability().then(function(results) {\n\t\t\t\tErrors.clear('availability');\n\t\t\t\t$scope.availability = results;\n\t\t\t\treturn results;\n\t\t\t}, function(err) {\n\t\t\t\tErrors.set('availability', err);\n\t\t\t\t$scope.availability = undefined;\n\t\t\t\treturn $q.reject(err);\n\t\t\t});\n\n\t\t};\n\n\t\tvar resetAvailability = function() {\n\t\t\t$scope.availability = undefined;\n\t\t};\n\n\t\tvar labelFormatter = function(label, series) {\n\t\t\t//return \"<div style='text-align:center; text-shadow: -1px -1px black, 1px -1px black, 1px 1px black, -1px 1px black; padding:2px; color:white;'>\" + label + '<br/>' + series.data[0][1] + \"</div>\";\n\t\t\treturn '<div class=\\'labelContents\\'><div class=\\'labelText\\'>' + label + '</div><div class=\\'valueText\\'>' + series.data[0][1] + '</div></div>';\n\t\t};\n\n\t\tvar flotOptions = {\n\t\t\tcanvas: true,\n\t\t\tgrid: {\n\t\t\t\tborderWidth:0,\n\t\t\t\tlabelMargin:0,\n\t\t\t\taxisMargin:0,\n\t\t\t\tminBorderMargin:0\n\t\t\t},\n\t\t\tyaxis: {\n\t\t\t\tticks: 0,\n\t\t\t\tshow: false\n\t\t\t},\n\t\t\tseries: {\n\t\t\t\tpie: {\n\t\t\t\t\tshow: true,\n\t\t\t\t\tradius: 0.9,\n\t\t\t\t\tinnerRadius: 0.4,\n\t\t\t\t\tcombine: {\n\t\t\t\t\t\tthreshold: 0.05\n\t\t\t\t\t},\n\t\t\t\t\tstroke: {\n\t\t\t\t\t\tcolor: 'black',\n\t\t\t\t\t\twidth: 1\n\t\t\t\t\t},\n\t\t\t\t\tlabel: {\n\t\t\t\t\t\tshow: true,\n\t\t\t\t\t\tradius: 0.65,\n\t\t\t\t\t\tformatter: labelFormatter\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tlegend: {\n\t\t\t\tshow: false\n\t\t\t}\n\t\t};\n\n\t\tvar updateTitles = function() {\n\t\t\tvar updateTitle = function(type) {\n\t\t\t\t$log.debug('updateTitles(' + type + ')');\n\t\t\t\tvar visible, hidden;\n\t\t\t\tif ($rootScope.wide) {\n\t\t\t\t\t//$log.debug('wide is enabled');\n\t\t\t\t\tvisible = $('.wide .' + type + ' .donut-title');\n\t\t\t\t\thidden = $('.portrait .' + type + ' .donut-title');\n\t\t\t\t} else {\n\t\t\t\t\t//$log.debug('wide is disabled');\n\t\t\t\t\tvisible = $('.portrait .' + type + ' .donut-title');\n\t\t\t\t\thidden = $('.wide .' + type + ' .donut-title');\n\t\t\t\t}\n\n\t\t\t\t//$log.debug('visible='+angular.toJson(visible));\n\t\t\t\t//$log.debug('hidden='+angular.toJson(hidden));\n\t\t\t\tif ($scope.donuts) {\n\t\t\t\t\tif ($scope.donuts[type]) {\n\t\t\t\t\t\tvar total = $scope.donuts[type].total;\n\t\t\t\t\t\t//$log.debug(type + ' total: ' + total);\n\t\t\t\t\t\tif (total === undefined) {\n\t\t\t\t\t\t\tvisible.hide();\n\t\t\t\t\t\t\tvisible.text('');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar html = '<div class=\"row total\"><div class=\"col\">' + total + '</div></div>' +\n\t\t\t\t\t\t\t\t'<div class=\"row type\"><div class=\"col\">' + type + '</div></div>';\n\t\t\t\t\t\t\tvisible.html(html);\n\t\t\t\t\t\t\tvisible.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tupdateTitle('outages');\n\t\t\tupdateTitle('alarms');\n\t\t};\n\n\t\tvar resetOutages = function() {\n\t\t\thideDonut('outages', true);\n\t\t\tif ($scope.donuts && $scope.donuts.outages) {\n\t\t\t\t$scope.donuts.outages = {};\n\t\t\t}\n\t\t\tupdateTitles();\n\t\t};\n\n\t\tvar refreshOutages = function() {\n\t\t\treturn OutageService.get().then(function(results) {\n\t\t\t\tvar data = {}, outages = [], outage, service, total = 0;\n\n\t\t\t\tfor (var i=0, len=results.length; i < len; i++) {\n\t\t\t\t\toutage = results[i];\n\t\t\t\t\tservice = outage.monitoredService.serviceName;\n\t\t\t\t\tif (!data[service]) {\n\t\t\t\t\t\tdata[service] = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata[service]++;\n\t\t\t\t\t}\n\t\t\t\t\ttotal++;\n\t\t\t\t}\n\n\t\t\t\tfor (service in data) {\n\t\t\t\t\tif (data.hasOwnProperty(service) && data[service]) {\n\t\t\t\t\t\toutages.push({\n\t\t\t\t\t\t\tlabel: service,\n\t\t\t\t\t\t\tdata: data[service]\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toutages.sort(function(a, b) {\n\t\t\t\t\tvar ret = b.data - a.data;\n\t\t\t\t\tif (ret === 0) {\n\t\t\t\t\t\treturn a.label.localeCompare(b.label);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn ret;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (outages.length > 50) {\n\t\t\t\t\toutages.length = 50;\n\t\t\t\t}\n\n\t\t\t\tErrors.clear('outage-chart');\n\t\t\t\t$scope.donuts.outages = {\n\t\t\t\t\ttotal: total,\n\t\t\t\t\tdata: outages,\n\t\t\t\t\toptions: angular.extend({}, flotOptions)\n\t\t\t\t};\n\t\t\t\thideDonut('outages', false);\n\t\t\t\tupdateTitles();\n\t\t\t\treturn outages;\n\t\t\t}, function(err) {\n\t\t\t\tErrors.set('outage-chart', err);\n\t\t\t\tresetOutages();\n\t\t\t\tupdateTitles();\n\t\t\t\treturn $q.reject(err);\n\t\t\t}).finally(function() {\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t});\n\n\t\t};\n\n\t\tvar resetAlarms = function() {\n\t\t\thideDonut('alarms', true);\n\t\t\tif ($scope.donuts && $scope.donuts.alarms) {\n\t\t\t\t$scope.donuts.alarms = {};\n\t\t\t}\n\t\t\tupdateTitles();\n\t\t};\n\n\t\tvar refreshAlarms = function() {\n\t\t\treturn AlarmService.severities().then(function(results) {\n\t\t\t\tvar severities = [], severity, total = 0;\n\n\t\t\t\tfor (var i=0, len=results.length; i < len; i++) {\n\t\t\t\t\tseverity = results[i];\n\t\t\t\t\ttotal += severity.count;\n\t\t\t\t\tseverities.push({\n\t\t\t\t\t\tlabel: severity.severity.capitalize(),\n\t\t\t\t\t\tdata: severity.count,\n\t\t\t\t\t\tcolor: util.color(severity.severity)\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tErrors.clear('alarm-chart');\n\t\t\t\t$scope.donuts.alarms = {\n\t\t\t\t\ttotal: total,\n\t\t\t\t\tdata: severities,\n\t\t\t\t\toptions: angular.extend({}, flotOptions)\n\t\t\t\t};\n\t\t\t\thideDonut('alarms', false);\n\t\t\t\tupdateTitles();\n\t\t\t\treturn severities;\n\t\t\t}, function(err) {\n\t\t\t\tErrors.set('alarm-chart', err);\n\t\t\t\tresetAlarms();\n\t\t\t\tupdateTitles();\n\t\t\t\treturn $q.reject(err);\n\t\t\t}).finally(function() {\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t});\n\n\t\t};\n\n\t\tvar refreshing = false;\n\t\t$scope.refreshData = debounce(500, function() {\n\t\t\tif (refreshing) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\trefreshing = true;\n\n\t\t\t$log.info('DashboardCtrl.refreshData: refreshing data.');\n\n\t\t\tvar finished = function(type) {\n\t\t\t\tutil.hideSplashscreen();\n\t\t\t\t$timeout(function() {\n\t\t\t\t\trefreshing = false;\n\t\t\t\t\t$ionicLoading.hide();\n\t\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t}, 50);\n\t\t\t};\n\n\t\t\tServers.getDefault().then(function(server) {\n\t\t\t\tif (server) {\n\t\t\t\t\treturn $q.all([\n\t\t\t\t\t\trefreshAvailability(),\n\t\t\t\t\t\trefreshOutages(),\n\t\t\t\t\t\trefreshAlarms(),\n\t\t\t\t\t\trefreshFavorites()\n\t\t\t\t\t]);\n\t\t\t\t} else {\n\t\t\t\t\treturn $q.reject('No server configured.');\n\t\t\t\t}\n\t\t\t}).finally(function() {\n\t\t\t\tfinished();\n\t\t\t});\n\t\t});\n\n\t\t$scope.resetData = function() {\n\t\t\t$log.debug('Resetting Data.');\n\t\t\t$scope.serverName = null;\n\t\t\tresetAvailability();\n\t\t\tresetOutages();\n\t\t\tresetAlarms();\n\t\t\tresetFavorites();\n\t\t};\n\n\t\t$scope.unfavorite = function(favorite) {\n\t\t\tvar graphTitle = $scope.graphs && $scope.graphs[favorite.graphName]? $scope.graphs[favorite.graphName].title : 'graph';\n\t\t\treturn $ionicPopup.confirm({\n\t\t\t\ttitle: 'Remove Favorite',\n\t\t\t\ttemplate: 'Remove ' + graphTitle + ' from favorites?',\n\t\t\t\tokType: 'button-compass'\n\t\t\t}).then(function(confirmed) {\n\t\t\t\tif (confirmed) {\n\t\t\t\t\tvar favoriteIndex = $scope.favoriteGraphs.indexOf(favorite);\n\t\t\t\t\tif (favoriteIndex >= 0) {\n\t\t\t\t\t\t$scope.favoriteGraphs = [];\n\t\t\t\t\t\t$ionicSlideBoxDelegate.$getByHandle('graph-slide-box').update();\n\t\t\t\t\t}\n\t\t\t\t\treturn ResourceService.unfavorite(favorite.resourceId, favorite.graphName).finally(function() {\n\t\t\t\t\t\treturn refreshFavorites();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn $q.reject('Canceled favorite removal.');\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t$scope.refreshGraphSlide = function(index) {\n\t\t\t$scope.currentGraphSlide = index;\n\t\t};\n\n\t\t$scope.shouldRenderGraph = function(index) {\n\t\t\t//return $scope.currentGraphSlide === index;\n\t\t\treturn $scope.currentGraphSlide >= index - 2 && $scope.currentGraphSlide <= index + 2;\n\t\t};\n\n\t\t$scope.goToDonutSlide = function(slide) {\n\t\t\t$ionicSlideBoxDelegate.$getByHandle('donut-slide-box').slide(slide);\n\t\t};\n\n\t\t$scope.showSelectServer = function($event) {\n\t\t\treturn Servers.all().then(function(servers) {\n\t\t\t\treturn $scope.serverPopover.then(function(popover) {\n\t\t\t\t\tpopover.scope.servers = servers;\n\t\t\t\t\treturn popover.show($event);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\t$scope.hideSelectServer = function() {\n\t\t\treturn $scope.serverPopover.then(function(popover) {\n\t\t\t\treturn popover.hide();\n\t\t\t});\n\t\t};\n\n\t\t$scope.serverPopover = $ionicPopover.fromTemplateUrl(serverPopoverTemplate, {\n\t\t\tscope: $scope\n\t\t}).then(function(popover) {\n\t\t\tpopover.scope.selectServer = function(server) {\n\t\t\t\t$ionicLoading.show({templateUrl: loadingTemplate, duration: 5000});\n\t\t\t\tpopover.hide();\n\t\t\t\tServers.setDefault(server);\n\t\t\t};\n\t\t\treturn popover;\n\t\t});\n\n\t\t$scope.util = util;\n\t\t$scope.modals = Modals;\n\t\t$scope.e = Errors;\n\t\t$scope.errors = [];\n\t\t$scope.currentDonutSlide = 0;\n\t\t$scope.currentGraphSlide = 0;\n\t\tServers.getDefault().then(function(server) {\n\t\t\t$scope.serverName = server && server.name? server.name : null;\n\t\t});\n\n\t\t$scope.range = {\n\t\t\tend: new Date()\n\t\t};\n\n\t\tvar defaultRange = $injector.get('default-graph-range');\n\t\t$scope.range.start = new Date($scope.range.end.getTime() - defaultRange);\n\n\t\tupdateLogo();\n\n\t\tutil.onDefaultServerUpdated(function(defaultServer) {\n\t\t\tif (defaultServer && angular.isDefined(defaultServer.name)) {\n\t\t\t\t$scope.serverName = defaultServer.name;\n\t\t\t\t$scope.refreshData();\n\t\t\t} else {\n\t\t\t\t$scope.resetData();\n\t\t\t}\n\t\t});\n\n\t\tutil.onDirty('alarms', $scope.refreshData);\n\t\tutil.onDirty('outages', $scope.refreshData);\n\t\tutil.onInfoUpdated(updateLogo);\n\t\tutil.onErrorsUpdated(function(errors) {\n\t\t\t$scope.errors = errors;\n\t\t});\n\n\t\t$scope.$watchGroup(['width', 'height', 'wide'], function(dims) {\n\t\t\tvar width  = dims[0],\n\t\t\t\theight = dims[1],\n\t\t\t\twide   = dims[2],\n\t\t\t\toldDonutSize = $scope.donutSize;\n\t\t\tif (wide) {\n\t\t\t\t$scope.donutSize = Math.round(Math.min(width, height) / 2.0);\n\t\t\t\t//$scope.donutSize = Math.round(width / 2.0);\n\t\t\t} else {\n\t\t\t\t$scope.donutSize = width;\n\t\t\t}\n\n\t\t\t$log.debug('Updated donuts: ' + oldDonutSize + ' -> ' + $scope.donutSize);\n\t\t\tupdateArrows(height);\n\t\t\tupdateTitles();\n\t\t});\n\n\t\t$scope.$on('$destroy', function() {\n\t\t\t$scope.serverPopover.then(function(popover) {\n\t\t\t\tpopover.remove();\n\t\t\t}).finally(function() {\n\t\t\t\tdelete $scope.serverPopover;\n\t\t\t});\n\t\t});\n\n\t\t$scope.$on('$ionicView.beforeEnter', function(ev, info) {\n\t\t\t/* // skip all this for now, getting weird rendering bug\n\t\t\t$log.debug('info=' + angular.toJson(info));\n\t\t\tif (info) {\n\t\t\t\tif (info.direction === 'back') {\n\t\t\t\t\t// don't refresh if we're going back\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (info.stateParams && info.stateParams.refresh === false) {\n\t\t\t\t\t// also don't refresh if we've been explicitly asked not to\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// otherwise, fall through to refreshing\n\t\t\t$log.debug(\"refreshing\");\n\t\t\t*/\n\t\t\t$scope.refreshData();\n\t\t});\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/dashboard/DashboardController.js\n ** module id = 187\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/dashboard/DashboardController.js?");

/***/ },
/* 188 */
/*!*****************************************************!*\
  !*** ./src/app/availability/AvailabilityService.js ***!
  \*****************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tAvailabilityNode = __webpack_require__(/*! ./models/AvailabilityNode */ 189),\n\t\tAvailabilitySection = __webpack_require__(/*! ./models/AvailabilitySection */ 192);\n\n\t__webpack_require__(/*! ../misc/Rest */ 121);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tangular.module('opennms.services.Availability', [\n\t\t'ionic',\n\t\t'opennms.services.Rest',\n\t\t'opennms.services.Util'\n\t])\n\t.factory('AvailabilityService', function($q, $rootScope, $log, RestService, util) {\n\t\t$log.info('AvailabilityService: Initializing.');\n\n\t\tvar hasAvailability;\n\n\t\tvar checkAvailability = function() {\n\t\t\tvar oldAvailability = hasAvailability;\n\t\t\tvar done = function(value) {\n\t\t\t\tif (oldAvailability) {\n\t\t\t\t\toldAvailability.resolve(value);\n\t\t\t\t}\n\t\t\t\thasAvailability.resolve(value);\n\t\t\t};\n\n\t\t\thasAvailability = $q.defer();\n\t\t\t$log.debug('AvailabilityService.checkAvailability: checking if availability service is valid.');\n\t\t\tRestService.getXml('/availability').then(function() {\n\t\t\t\t$log.info('AvailabilityService.checkAvailability: availability service works!');\n\t\t\t\tdone(true);\n\t\t\t}, function() {\n\t\t\t\t$log.info('AvailabilityService.checkAvailability: availability service does not work. :(');\n\t\t\t\tdone(false);\n\t\t\t});\n\t\t};\n\n\t\tvar isSupported = function() {\n\t\t\treturn hasAvailability.promise;\n\t\t};\n\n\t\tvar getAvailability = function() {\n\t\t\treturn isSupported().then(function(canDo) {\n\t\t\t\tif (canDo) {\n\t\t\t\t\treturn RestService.getXml('/availability').then(function(results) {\n\t\t\t\t\t\t/* jshint -W069 */ /* \"better written in dot notation\" */\n\t\t\t\t\t\tvar ret = [];\n\n\t\t\t\t\t\tif (results && results.availability && results.availability.section) {\n\t\t\t\t\t\t\tvar sections = results.availability.section;\n\t\t\t\t\t\t\tif (!angular.isArray(sections)) {\n\t\t\t\t\t\t\t\tsections = [sections];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i=0, len=sections.length; i < len; i++) {\n\t\t\t\t\t\t\t\tret.push(new AvailabilitySection(sections[i]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn ret;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'AvailabilityService.getAvailability';\n\t\t\t\treturn $q.reject(err);\n\t\t\t});\n\t\t};\n\n\t\tvar getCategory = function(category) {\n\t\t\treturn isSupported().then(function(canDo) {\n\t\t\t\tif (canDo) {\n\t\t\t\t\tvar url = '/availability/' + encodeURIComponent(category);\n\t\t\t\t\treturn RestService.getXml(url);\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'AvailabilityService.getCategory';\n\t\t\t\treturn $q.reject(err);\n\t\t\t});\n\t\t};\n\n\t\tvar getNodes = function(category) {\n\t\t\treturn isSupported().then(function(canDo) {\n\t\t\t\tif (canDo) {\n\t\t\t\t\tvar url = '/availability/' + encodeURIComponent(category) + '/nodes';\n\t\t\t\t\treturn RestService.getXml(url);\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'AvailabilityService.getNodes';\n\t\t\t\treturn $q.reject(err);\n\t\t\t});\n\t\t};\n\n\t\tvar getNode = function(node) {\n\t\t\treturn isSupported().then(function(canDo) {\n\t\t\t\tif (canDo) {\n\t\t\t\t\tvar nodeId = node;\n\t\t\t\t\tif (!angular.isNumber(node)) {\n\t\t\t\t\t\tnodeId = node.id;\n\t\t\t\t\t}\n\t\t\t\t\tvar url = '/availability/nodes/' + nodeId;\n\t\t\t\t\treturn RestService.getXml(url).then(function(results) {\n\t\t\t\t\t\tif (results && results.node) {\n\t\t\t\t\t\t\treturn new AvailabilityNode(results.node);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'AvailabilityService.getNode';\n\t\t\t\treturn $q.reject(err);\n\t\t\t});\n\t\t};\n\n\t\tutil.onSettingsUpdated(checkAvailability);\n\t\tutil.onServersUpdated(checkAvailability);\n\t\tcheckAvailability();\n\n\t\treturn {\n\t\t\tsupported: isSupported,\n\t\t\tavailability: getAvailability,\n\t\t\tcategory: getCategory,\n\t\t\tnodes: getNodes,\n\t\t\tnode: getNode\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/availability/AvailabilityService.js\n ** module id = 188\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/availability/AvailabilityService.js?");

/***/ },
/* 189 */
/*!*********************************************************!*\
  !*** ./src/app/availability/models/AvailabilityNode.js ***!
  \*********************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar AvailabilityIpInterface = __webpack_require__(/*! ./AvailabilityIpInterface */ 190),\n  moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name AvailabilityNode\n * @param {Object} node Availability node as JSON object\n * @constructor\n */\nfunction AvailabilityNode(node) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityNode#id\n   * @propertyOf AvailabilityNode\n   * @returns {number} Node ID\n   */\n  self.id   = Number(node['_id']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityNode#availability\n   * @propertyOf AvailabilityNode\n   * @returns {number} Node's availability (as a percentage)\n   */\n  self.availability = parseFloat(node['_availability']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityNode#serviceCount\n   * @propertyOf AvailabilityNode\n   * @returns {number} The number of services on the node.\n   */\n  self.serviceCount = parseInt(node['_service-count'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityNode#serviceDownCount\n   * @propertyOf AvailabilityNode\n   * @returns {number} The number of down services on the node.\n   */\n  self.serviceDownCount = parseInt(node['_service-down-count'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityNode#ipinterfaces\n   * @propertyOf AvailabilityNode\n   * @returns {array} An array of AvailabilityIpInterface objects.\n   */\n  self.ipinterfaces = [];\n  if (node.ipinterfaces && node.ipinterfaces.ipinterface) {\n    if (!angular.isArray(node.ipinterfaces.ipinterface)) {\n      node.ipinterfaces.ipinterface = [node.ipinterfaces.ipinterface];\n    }\n    for (var i=0, len=node.ipinterfaces.ipinterface.length; i < len; i++) {\n      self.ipinterfaces.push(new AvailabilityIpInterface(node.ipinterfaces.ipinterface[i]));\n    }\n  }\n\n}\n\nmodule.exports = AvailabilityNode;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/availability/models/AvailabilityNode.js\n ** module id = 189\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/availability/models/AvailabilityNode.js?");

/***/ },
/* 190 */
/*!****************************************************************!*\
  !*** ./src/app/availability/models/AvailabilityIpInterface.js ***!
  \****************************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar AvailabilityService = __webpack_require__(/*! ./AvailabilityService */ 191),\n  moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name AvailabilityIpInterface\n * @param {Object} iface Availability node IP interface as JSON object\n * @constructor\n */\nfunction AvailabilityIpInterface(iface) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityIpInterface#id\n   * @propertyOf AvailabilityIpInterface\n   * @returns {number} Interface ID\n   */\n  self.id   = Number(iface['_id']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityIpInterface#availability\n   * @propertyOf AvailabilityIpInterface\n   * @returns {number} Interface's availability (as a percentage)\n   */\n  self.availability = parseFloat(iface['_availability']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityIpInterface#address\n   * @propertyOf AvailabilityIpInterface\n   * @returns {string} The IP address of the interface.\n   */\n  self.address = iface['_address'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityIpInterface#services\n   * @propertyOf AvailabilityIpInterface\n   * @returns {array} An array of AvailabilityService objects.\n   */\n  self.services = [];\n  if (iface.services && iface.services.service) {\n    if (!angular.isArray(iface.services.service)) {\n      iface.services.service = [iface.services.service];\n    }\n    for (var i=0, len=iface.services.service.length; i < len; i++) {\n      self.services.push(new AvailabilityService(iface.services.service[i]));\n    }\n  }\n\n}\n\nmodule.exports = AvailabilityIpInterface;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/availability/models/AvailabilityIpInterface.js\n ** module id = 190\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/availability/models/AvailabilityIpInterface.js?");

/***/ },
/* 191 */
/*!************************************************************!*\
  !*** ./src/app/availability/models/AvailabilityService.js ***!
  \************************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name AvailabilityService\n * @param {Object} svc Availability service as JSON object\n * @constructor\n */\nfunction AvailabilityService(svc) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityService#id\n   * @propertyOf AvailabilityService\n   * @returns {number} Service ID\n   */\n  self.id   = Number(svc['_id']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityService#availability\n   * @propertyOf AvailabilityService\n   * @returns {number} Service's availability (as a percentage)\n   */\n  self.availability = parseFloat(svc['_availability']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityService#name\n   * @propertyOf AvailabilityService\n   * @returns {string} The name of the service.\n   */\n  self.name = svc['_name'];\n\n}\n\nmodule.exports = AvailabilityService;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/availability/models/AvailabilityService.js\n ** module id = 191\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/availability/models/AvailabilityService.js?");

/***/ },
/* 192 */
/*!************************************************************!*\
  !*** ./src/app/availability/models/AvailabilitySection.js ***!
  \************************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar AvailabilityCategory = __webpack_require__(/*! ./AvailabilityCategory */ 193),\n  moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name AvailabilitySection\n * @param {Object} section Availability section as JSON object\n * @constructor\n */\nfunction AvailabilitySection(section) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilitySection#name\n   * @propertyOf AvailabilitySection\n   * @returns {string} Section name\n   */\n  self.name   = section['_name'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilitySection#categories\n   * @propertyOf AvailabilitySection\n   * @returns {array} An array of categories\n   */\n  self.categories = [];\n  if (section.categories && section.categories.category) {\n    if (!angular.isArray(section.categories.category)) {\n      section.categories.category = [section.categories.category];\n    }\n    for (var i=0, len=section.categories.category.length; i < len; i++) {\n      self.categories.push(new AvailabilityCategory(section.categories.category[i]));\n    }\n  }\n\n}\n\nmodule.exports = AvailabilitySection;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/availability/models/AvailabilitySection.js\n ** module id = 192\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/availability/models/AvailabilitySection.js?");

/***/ },
/* 193 */
/*!*************************************************************!*\
  !*** ./src/app/availability/models/AvailabilityCategory.js ***!
  \*************************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name AvailabilityCategory\n * @param {Object} cat Availability category as JSON object\n * @constructor\n */\nfunction AvailabilityCategory(cat) {\n  'use strict';\n\n  var self = this;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#name\n   * @propertyOf AvailabilityCategory\n   * @returns {string} Category name\n   */\n  self.name = cat['_name'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#normalThreshold\n   * @propertyOf AvailabilityCategory\n   * @returns {number} The threshold to be considered \"normal\" severity\n   */\n  self.normalThreshold = parseFloat(cat['_normal-threshold']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#warningThreshold\n   * @propertyOf AvailabilityCategory\n   * @returns {number} The threshold to be considered \"warning\" severity\n   */\n  self.warningThreshold = parseFloat(cat['_warning-threshold']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#availability\n   * @propertyOf AvailabilityCategory\n   * @returns {number} The availability percentage of the entire category\n   */\n  self.availability = parseFloat(cat.availability);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#availabilityClass\n   * @propertyOf AvailabilityCategory\n   * @returns {string} The class to use when displaying availability\n   */\n  self.availabilityClass = cat['availability-class'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#comment\n   * @propertyOf AvailabilityCategory\n   * @returns {string} The comment associated with the category\n   */\n  self.comment = cat.comment;\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#lastUpdated\n   * @propertyOf AvailabilityCategory\n   * @returns {moment} The date the category was last updated\n   */\n  self.lastUpdated = moment(cat['last-updated']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#outageClass\n   * @propertyOf AvailabilityCategory\n   * @returns {string} The class to use when displaying outages\n   */\n  self.outageClass = cat['outage-class'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#outageText\n   * @propertyOf AvailabilityCategory\n   * @returns {string} The display text for outages\n   */\n  self.outageText = cat['outage-text'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#serviceDownCount\n   * @propertyOf AvailabilityCategory\n   * @returns {number} The number of services down\n   */\n  self.serviceDownCount = parseInt(cat['service-down-count'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name AvailabilityCategory#servicePercentage\n   * @propertyOf AvailabilityCategory\n   * @returns {number} The percentage of services available in the category\n   */\n  self.servicePercentage = parseFloat(cat['service-percentage']);\n}\n\nmodule.exports = AvailabilityCategory;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/availability/models/AvailabilityCategory.js\n ** module id = 193\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/availability/models/AvailabilityCategory.js?");

/***/ },
/* 194 */
/*!******************************************!*\
  !*** ./src/app/nodes/ResourceService.js ***!
  \******************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tBackshift = __webpack_require__(/*! backshift/dist/backshift.onms */ 195),\n\t\tmoment = __webpack_require__(/*! moment */ 14),\n\t\tRestError = __webpack_require__(/*! ../misc/RestError */ 122);\n\n\t__webpack_require__(/*! ../db/db */ 114);\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\t__webpack_require__(/*! ../misc/Rest */ 121);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tvar onmsGraphTemplate = __webpack_require__(/*! ngtemplate!html!./onms-graph.html */ 197);\n\n\tangular.module('opennms.services.Resources', [\n\t\t'ionic',\n\t\t'uuid4',\n\t\t'opennms.services.DB',\n\t\t'opennms.services.Rest',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Settings', // for default-graph-min-range\n\t\t'opennms.services.Util'\n\t])\n\t.directive('onmsGraph', function($log, $timeout, $window, $injector, RestService, Servers) {\n\t\tvar getWidth = function() {\n\t\t\treturn $window.innerWidth;\n\t\t};\n\t\tvar getHeight = function() {\n\t\t\tif ($window.orientation % 180 === 0) {\n\t\t\t\treturn $window.innerWidth;\n\t\t\t} else {\n\t\t\t\treturn $window.innerHeight - 140;\n\t\t\t}\n\t\t};\n\t\treturn {\n\t\t\tscope: {\n\t\t\t\tresourceId: '=',\n\t\t\t\tgraphDef: '=',\n\t\t\t\trange: '=range',\n\t\t\t\tdisplay: '=display'\n\t\t\t},\n\t\t\treplace: true,\n\t\t\ttemplateUrl: onmsGraphTemplate,\n\t\t\tlink: function($scope, element, attrs) {\n\t\t\t\t$scope.width = getWidth();\n\t\t\t\t$scope.height = getWidth();\n\t\t\t\tif ($scope.display === undefined) {\n\t\t\t\t\t$scope.display = true;\n\t\t\t\t}\n\n\t\t\t\tvar minDate = moment().subtract($injector.get('default-graph-min-range'), 'milliseconds').toDate();\n\t\t\t\t$scope.editDate = function(type) {\n\t\t\t\t\tvar date;\n\t\t\t\t\tif (type === 'start') {\n\t\t\t\t\t\tdate = $scope.range.start;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdate = $scope.range.end;\n\t\t\t\t\t}\n\t\t\t\t\t$window.datePicker.show({\n\t\t\t\t\t\tdate: date,\n\t\t\t\t\t\tminDate: minDate,\n\t\t\t\t\t\tmaxDate: moment().toDate(),\n\t\t\t\t\t\tmode: 'datetime'\n\t\t\t\t\t}, function(newDate) {\n\t\t\t\t\t\tif (!newDate) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$scope.$evalAsync(function() {\n\t\t\t\t\t\t\tif (type === 'start') {\n\t\t\t\t\t\t\t\t$scope.range.start = newDate;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$scope.range.end = newDate;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\t$scope.createGraph = function() {\n\t\t\t\t\tif (!$scope.ds)                { return; }\n\t\t\t\t\tif (!$scope.graphModel)        { return; }\n\t\t\t\t\tif (!$scope.graphModel.series) { return; }\n\t\t\t\t\tif (!$scope.graphModel.title)  { return; }\n\t\t\t\t\tif (!$scope.range)             { return; }\n\t\t\t\t\tif (!$scope.range.start)       { return; }\n\t\t\t\t\tif (!$scope.range.end)         { return; }\n\n\t\t\t\t\tif ($scope.graph && $scope.graph._last) {\n\t\t\t\t\t\tif ($scope.graph._last.ds         === $scope.ds &&\n\t\t\t\t\t\t\t$scope.graph._last.graphModel === $scope.graphModel &&\n\t\t\t\t\t\t\t$scope.graph._last.width      === $scope.width &&\n\t\t\t\t\t\t\t$scope.graph._last.height     === $scope.height &&\n\t\t\t\t\t\t\tangular.equals($scope.graph._last.range, $scope.range)) {\n\t\t\t\t\t\t\t$log.debug('Graph is unchanged since last render.  Skipping.');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar onmsGraphElement = angular.element(element).find('.graph').first();\n\t\t\t\t\tonmsGraphElement.width($scope.width);\n\t\t\t\t\tonmsGraphElement.height($scope.width);\n\n\t\t\t\t\t//var graph = new Backshift.Graph.DC({\n\t\t\t\t\tvar graph = new Backshift.Graph.Flot({\n\t\t\t\t\t\telement: onmsGraphElement[0],\n\t\t\t\t\t\tstart: $scope.range.start.getTime(),\n\t\t\t\t\t\tend: $scope.range.end.getTime(),\n\t\t\t\t\t\twidth: $scope.width,\n\t\t\t\t\t\theight: $scope.width,\n\t\t\t\t\t\tinteractive: false,\n\t\t\t\t\t\tdataSource: $scope.ds,\n\t\t\t\t\t\tmodel: $scope.graphModel,\n\t\t\t\t\t\texportIconSizeRatio: 0,\n\t\t\t\t\t\tbeginOnRender: false,\n\t\t\t\t\t\tzoom: false,\n\t\t\t\t\t\txaxisFont: {\n\t\t\t\t\t\t\tsize: 10,\n\t\t\t\t\t\t\tfamily: 'sans-serif'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tyaxisFont: {\n\t\t\t\t\t\t\tsize: 10,\n\t\t\t\t\t\t\tfamily: 'sans-serif'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlegendFontSize: 16,\n\t\t\t\t\t\tticks: 4\n\t\t\t\t\t});\n\n\t\t\t\t\tgraph._last = {\n\t\t\t\t\t\tds: $scope.ds,\n\t\t\t\t\t\tgraphModel: $scope.graphModel,\n\t\t\t\t\t\trange: angular.copy($scope.range),\n\t\t\t\t\t\twidth: $scope.width,\n\t\t\t\t\t\theight: $scope.width\n\t\t\t\t\t};\n\n\t\t\t\t\tif ($scope.graph && $scope.graph.destroy) {\n\t\t\t\t\t\t$scope.graph.destroy();\n\t\t\t\t\t\tdelete $scope.graph._last.graphModel;\n\t\t\t\t\t\tdelete $scope.graph._last.ds;\n\t\t\t\t\t\tdelete $scope.graph._last.range;\n\t\t\t\t\t\tdelete $scope.graph._last.width;\n\t\t\t\t\t\tdelete $scope.graph._last.height;\n\t\t\t\t\t\tdelete $scope.graph._last;\n\t\t\t\t\t}\n\n\t\t\t\t\t$scope.graph = graph;\n\n\t\t\t\t\t$log.debug('Displaying graph: ' + $scope.resourceId + ' / ' + $scope.graphModel.title);\n\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\tgraph.render();\n\t\t\t\t\t\tif ($scope.display) {\n\t\t\t\t\t\t\tgraph.begin();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgraph.onQuerySuccess();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\t$scope.redraw = function() {\n\t\t\t\t\t$scope.dirty = true;\n\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\tif ($scope.dirty) {\n\t\t\t\t\t\t\t$scope.dirty = false;\n\t\t\t\t\t\t\t$scope.createGraph();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 50);\n\t\t\t\t};\n\n\t\t\t\t$scope.refresh = function() {\n\t\t\t\t\tif ($scope.graph) {\n\t\t\t\t\t\tif ($scope.display) {\n\t\t\t\t\t\t\t$scope.graph.begin();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$scope.graph.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t$scope.$watch('range', function(newRange, oldRange) {\n\t\t\t\t\tvar startDate = moment(newRange && newRange.start? newRange.start : 0),\n\t\t\t\t\t\tendDate = moment(newRange && newRange.end? newRange.end : 0);\n\t\t\t\t\tif (oldRange && newRange.start !== oldRange.start) {\n\t\t\t\t\t\tif (startDate.isAfter(endDate)) {\n\t\t\t\t\t\t\t$scope.range.end = startDate.add(1, 'hour').toDate();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (oldRange && newRange.end !== oldRange.end) {\n\t\t\t\t\t\tif (endDate.isBefore(startDate)) {\n\t\t\t\t\t\t\t$scope.range.start = endDate.subtract(1, 'hour').toDate();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$scope.redraw();\n\t\t\t\t}, true);\n\n\t\t\t\t$scope.$watchGroup(['width', 'height'], $scope.redraw);\n\t\t\t\t$scope.$watch('display', $scope.refresh);\n\n\t\t\t\t$scope.$on('resize', function(ev, info) {\n\t\t\t\t\t$scope.width = info.width;\n\t\t\t\t\t$scope.height = info.height;\n\t\t\t\t});\n\n\t\t\t\t$scope.$watch('graphDef', function(graphDef) {\n\t\t\t\t\tif (graphDef && $scope.resourceId) {\n\t\t\t\t\t\t$scope.rrdGraphConverter = new Backshift.Utilities.RrdGraphConverter({\n\t\t\t\t\t\t\tgraphDef: graphDef,\n\t\t\t\t\t\t\tresourceId: $scope.resourceId\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$scope.$watch('rrdGraphConverter', function(rrdGraphConverter) {\n\t\t\t\t\tif (rrdGraphConverter && rrdGraphConverter.model) {\n\t\t\t\t\t\t$scope.graphModel = rrdGraphConverter.model;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$scope.$watch('graphModel', function(graphModel) {\n\t\t\t\t\tif (graphModel && graphModel.metrics) {\n\t\t\t\t\t\tServers.getDefault().then(function(server) {\n\t\t\t\t\t\t\tif (server) {\n\t\t\t\t\t\t\t\tvar options = {\n\t\t\t\t\t\t\t\t\turl: server.restUrl('measurements'),\n\t\t\t\t\t\t\t\t\tusername: server.username,\n\t\t\t\t\t\t\t\t\tpassword: server.password,\n\t\t\t\t\t\t\t\t\tmetrics: graphModel.metrics\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tvar cordovaHTTP;\n\t\t\t\t\t\t\t\tif ($injector.has('cordovaHTTP')) {\n\t\t\t\t\t\t\t\t\tcordovaHTTP = $injector.get('cordovaHTTP');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (cordovaHTTP) {\n\t\t\t\t\t\t\t\t\toptions.fetchFunction = function(url, data, success, failure) {\n\t\t\t\t\t\t\t\t\t\tcordovaHTTP.post(url, data, {\n\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t\t\t\t\tAccept: 'application/json'\n\t\t\t\t\t\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\t\t\t\t\t\t//$log.debug('cordovaHTTP response: ' + angular.toJson(response));\n\t\t\t\t\t\t\t\t\t\t\tsuccess(response.data);\n\t\t\t\t\t\t\t\t\t\t}, function(err) {\n\t\t\t\t\t\t\t\t\t\t\tvar error = new RestError(url, err.data, err.status);\n\t\t\t\t\t\t\t\t\t\t\t$log.error('cordovaHTTP error: ' + error.toString());\n\t\t\t\t\t\t\t\t\t\t\tfailure(error.toString());\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$scope.ds = new Backshift.DataSource.OpenNMS(options);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$scope.$watch('ds', function() {\n\t\t\t\t\t$scope.redraw();\n\t\t\t\t});\n\n\t\t\t\tvar cleanUp = function() {\n\t\t\t\t\tvar resourceId = $scope.resourceId;\n\t\t\t\t\tvar graphTitle = $scope.graphModel && $scope.graphModel.title? $scope.graphModel.title : 'N/A';\n\t\t\t\t\t$log.debug('Destroying graph: ' + resourceId + ' / ' + graphTitle);\n\t\t\t\t\tif ($scope.graph) {\n\t\t\t\t\t\tif ($scope.graph.destroy) {\n\t\t\t\t\t\t\t$scope.graph.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete $scope.graph._last.ds;\n\t\t\t\t\t\tdelete $scope.graph._last.graphModel;\n\t\t\t\t\t\tdelete $scope.graph._last.range;\n\t\t\t\t\t\tdelete $scope.graph._last;\n\t\t\t\t\t\t$scope.graph = undefined;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t$scope.$on('$destroy', cleanUp);\n\t\t\t\telement.on('$destroy', cleanUp);\n\t\t\t}\n\t\t};\n\t})\n\t.factory('ResourceService', function($q, $rootScope, $log, uuid4, RestService, Servers, db, util) {\n\t\t$log.info('ResourceService: Initializing.');\n\n\t\tvar _graphs = {};\n\n\t\tvar favoritesDB = db.get('favorites');\n\t\tfavoritesDB.createIndex({\n\t\t\tindex: {\n\t\t\t\tfields: ['server', 'username']\n\t\t\t}\n\t\t}).catch(function(err) {\n\t\t\t$log.error('Unable to create server/username index: ' + angular.toJson(err));\n\t\t});\n\t\tfavoritesDB.createIndex({\n\t\t\tindex: {\n\t\t\t\tfields: ['time', 'server', 'username']\n\t\t\t}\n\t\t}).catch(function(err) {\n\t\t\t$log.error('Unable to create server/username index: ' + angular.toJson(err));\n\t\t});\n\t\tfavoritesDB.createIndex({\n\t\t\tindex: {\n\t\t\t\tfields: ['server', 'username', 'resourceId', 'graphName']\n\t\t\t}\n\t\t}).catch(function(err) {\n\t\t\t$log.error('Unable to create server/username/resourceId/graphName index: ' + angular.toJson(err));\n\t\t});\n\n\t\tvar _sortFunction = function(a,b) {\n\t\t\tif (a.typeLabel && b.typeLabel) {\n\t\t\t\treturn a.typeLabel.localeCompare(b.typeLabel);\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t};\n\t\tvar getResourcesForNode = function(nodeId) {\n\t\t\treturn RestService.get('/resources/fornode/' + nodeId, {}, {Accept: 'application/json'}).then(function(res) {\n\t\t\t\t//$log.debug('ResourceService.getResourcesForNode: res=' + angular.toJson(res));\n\t\t\t\tvar ret = {\n\t\t\t\t\tlabel: res.label,\n\t\t\t\t\tid: parseInt(res.name, 10),\n\t\t\t\t\tchildren: []\n\t\t\t\t};\n\n\t\t\t\tif (res.children && res.children.resource) {\n\t\t\t\t\tif (angular.isArray(res.children.resource)) {\n\t\t\t\t\t\tret.children = res.children.resource;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tret.children = [res.children.resource];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn ret;\n\t\t\t});\n\t\t};\n\n\t\tvar getResource = function(resourceId) {\n\t\t\treturn RestService.get('/resources/' + encodeURIComponent(resourceId), {}, {Accept: 'application/json'}).then(function(res) {\n\t\t\t\tif (res.children && res.children.resource) {\n\t\t\t\t\tif (angular.isArray(res.children.resource)) {\n\t\t\t\t\t\tres.children = res.children.resource;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tres.children = [res.children.resource];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tres.children = [];\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t});\n\t\t};\n\n\t\tvar getGraphNames = function(resourceId) {\n\t\t\treturn RestService.get('/graphs/for/' + encodeURIComponent(resourceId), {}, {Accept: 'application/json'}).then(function(res) {\n\t\t\t\tif (res.name) {\n\t\t\t\t\tif (angular.isArray(res.name)) {\n\t\t\t\t\t\treturn res.name;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [res.name];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar getGraph = function(graph) {\n\t\t\tif (!_graphs.hasOwnProperty(graph)) {\n\t\t\t\t_graphs[graph] = RestService.get('/graphs/' + graph, {}, {Accept: 'application/json'});\n\t\t\t}\n\t\t\treturn _graphs[graph];\n\t\t};\n\n\t\tvar withDividers = function(resources) {\n\t\t\tif (resources && !angular.isArray(resources)) {\n\t\t\t\tresources = [resources];\n\t\t\t}\n\t\t\tif (!resources) {\n\t\t\t\tresources = [];\n\t\t\t}\n\t\t\tresources.sort(_sortFunction);\n\n\t\t\tvar ret = [], child, lastLabel;\n\t\t\tfor (var i=0, len=resources.length; i < len; i++) {\n\t\t\t\tchild = resources[i];\n\t\t\t\tif (child.typeLabel !== lastLabel) {\n\t\t\t\t\tret.push({\n\t\t\t\t\t\tisDivider: true,\n\t\t\t\t\t\tid: child.typeLabel\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tret.push(child);\n\t\t\t\tlastLabel = child.typeLabel;\n\t\t\t}\n\t\t\treturn ret;\n\t\t};\n\n\t\tvar _getServer = function(caller) {\n\t\t\treturn Servers.getDefault().then(function(server) {\n\t\t\t\tif (server && angular.isDefined(server._id) && angular.isDefined(server.username)) {\n\t\t\t\t\treturn server;\n\t\t\t\t} else {\n\t\t\t\t\treturn $q.reject('ResourceService.' + caller + ': Unable to determine default server.');\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar getFavorites = function() {\n\t\t\t//$log.debug('ResourceService.getFavorites()');\n\t\t\treturn _getServer('getFavorites').then(function(server) {\n\t\t\t\treturn favoritesDB.find({\n\t\t\t\t\tselector: {\n\t\t\t\t\t\tserver: server._id,\n\t\t\t\t\t\tusername: server.username,\n\t\t\t\t\t\ttime: {$gt: null}\n\t\t\t\t\t},\n\t\t\t\t\tsort: [{\n\t\t\t\t\t\ttime: 'asc'\n\t\t\t\t\t}]\n\t\t\t\t}).then(function(result) {\n\t\t\t\t\t//$log.debug('ResourceService.getFavorites(): result=' + angular.toJson(result));\n\t\t\t\t\tif (result && result.docs) {\n\t\t\t\t\t\treturn result.docs;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t}).catch(function(err) {\n\t\t\t\t\t$log.error('ResourceService.getFavorites(): err=' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar getFavorite = function(resourceId, graphName) {\n\t\t\t//$log.debug('ResourceService.getFavorite(' + resourceId + ',' + graphName + ')');\n\t\t\treturn _getServer('getFavorite').then(function(server) {\n\t\t\t\treturn favoritesDB.find({\n\t\t\t\t\tselector: {\n\t\t\t\t\t\tserver: server._id,\n\t\t\t\t\t\tusername: server.username,\n\t\t\t\t\t\tresourceId: resourceId,\n\t\t\t\t\t\tgraphName: graphName\n\t\t\t\t\t}\n\t\t\t\t}).then(function(result) {\n\t\t\t\t\t//$log.debug('ResourceService.getFavorite(' + resourceId + ',' + graphName + '): result=' + angular.toJson(result));\n\t\t\t\t\tif (result && result.docs && result.docs.length === 1) {\n\t\t\t\t\t\treturn result.docs[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$log.error('getFavorite(' + resourceId + ',' + graphName + '): failed result: ' + angular.toJson(result));\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}).catch(function(err) {\n\t\t\t\t\t$log.error('ResourceService.getFavorite('+resourceId+','+graphName+'): err=' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar addFavorite = function(resourceId, graphName, nodeId, nodeLabel) {\n\t\t\treturn _getServer('addFavorite').then(function(server) {\n\t\t\t\tvar favorite = {\n\t\t\t\t\t_id: uuid4.generate(),\n\t\t\t\t\tserver: server._id,\n\t\t\t\t\tusername: server.username,\n\t\t\t\t\tresourceId: resourceId,\n\t\t\t\t\tgraphName: graphName,\n\t\t\t\t\tnodeId: nodeId,\n\t\t\t\t\tnodeLabel: nodeLabel,\n\t\t\t\t\tisFavorite: true,\n\t\t\t\t\ttime: new Date().getTime()\n\t\t\t\t};\n\t\t\t\t//$log.debug('ResourceService.addFavorite(' + resourceId + ',' + graphName + '): ' + angular.toJson(favorite));\n\t\t\t\treturn favoritesDB.put(favorite).then(function(result) {\n\t\t\t\t\t//$log.debug('ResourceService.addFavorite(' + resourceId + ',' + graphName + '): result=' + angular.toJson(result));\n\t\t\t\t\tfavorite._rev = result.rev;\n\t\t\t\t\treturn favorite;\n\t\t\t\t}).catch(function(err) {\n\t\t\t\t\t$log.error('ResourceService.addFavorite(' + resourceId + ',' + graphName + ') failed: err=' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tvar removeFavorite = function(resourceId, graphName) {\n\t\t\t//$log.debug('ResourceService.removeFavorite(' + resourceId + ',' + graphName + ')');\n\t\t\treturn _getServer('removeFavorite').then(function(server) {\n\t\t\t\treturn favoritesDB.find({\n\t\t\t\t\tselector: {\n\t\t\t\t\t\tserver: server._id,\n\t\t\t\t\t\tusername: server.username,\n\t\t\t\t\t\tresourceId: resourceId,\n\t\t\t\t\t\tgraphName: graphName\n\t\t\t\t\t}\n\t\t\t\t}).then(function(result) {\n\t\t\t\t\t//$log.debug('ResourceService.removeFavorite(' + resourceId + ',' + graphName + '): result=' + angular.toJson(result));\n\t\t\t\t\tif (result && result.docs && result.docs.length === 1) {\n\t\t\t\t\t\treturn favoritesDB.remove(result.docs[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$log.error('removeFavorite: unhandled result: ' + angular.toJson(result));\n\t\t\t\t\t\treturn $q.reject(result);\n\t\t\t\t\t}\n\t\t\t\t}).catch(function(err) {\n\t\t\t\t\t$log.error('ResourceService.removeFavorite(' + resourceId + ',' + graphName + ') failed: err=' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tutil.onServerRemoved(function(server) {\n\t\t\t//$log.debug('ResourceService.onServerRemoved: cleaning up favorites for server ' + server.name);\n\t\t\treturn favoritesDB.find({\n\t\t\t\tselector: {\n\t\t\t\t\tserver: server._id,\n\t\t\t\t\tusername: server.username\n\t\t\t\t}\n\t\t\t}).then(function(result) {\n\t\t\t\tif (result && result.docs && result.docs.length > 0) {\n\t\t\t\t\tfor (var i=0, len=result.docs.length; i < len; i++) {\n\t\t\t\t\t\tresult.docs[i]._deleted = true;\n\t\t\t\t\t}\n\t\t\t\t\treturn favoritesDB.bulkDocs(result.docs);\n\t\t\t\t} else {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn {\n\t\t\tgraphNames: getGraphNames,\n\t\t\tgraph: getGraph,\n\t\t\tresources: getResourcesForNode,\n\t\t\tresource: getResource,\n\t\t\twithDividers: withDividers,\n\t\t\tfavorites: getFavorites,\n\t\t\tisFavorite: getFavorite,\n\t\t\tfavorite: addFavorite,\n\t\t\tunfavorite: removeFavorite\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/ResourceService.js\n ** module id = 194\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/ResourceService.js?");

/***/ },
/* 195 */
/*!***********************************************************!*\
  !*** ./bower_components/backshift/dist/backshift.onms.js ***!
  \***********************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* WEBPACK VAR INJECTION */(function(jQuery, $) {/**\n * Created by jwhite on 6/1/14.\n */\n\n// Addresses an issue with PhantomJS - see https://github.com/ariya/phantomjs/issues/10522\nif (!Function.prototype.bind) {\n  Function.prototype.bind = function (oThis) {\n    if (typeof this !== \"function\") {\n      // closest thing possible to the ECMAScript 5\n      // internal IsCallable function\n      throw new TypeError(\"Function.prototype.bind - what is trying to be bound is not callable\");\n    }\n\n    var aArgs = Array.prototype.slice.call(arguments, 1),\n      fToBind = this,\n      fNOP = function () {\n      },\n      fBound = function () {\n        return fToBind.apply(this instanceof fNOP && oThis\n            ? this\n            : oThis,\n          aArgs.concat(Array.prototype.slice.call(arguments)));\n      };\n\n    fNOP.prototype = this.prototype;\n    fBound.prototype = new fNOP();\n\n    return fBound;\n  };\n}\n\n/* jshint -W079 */\n\nvar Backshift = Backshift || {};\n\nBackshift.namespace = function (ns_string) {\n  var parts = ns_string.split('.'),\n    parent = Backshift,\n    i;\n\n  // split redundant leading global\n  if (parts[0] === 'Backshift') {\n    parts = parts.slice(1);\n  }\n\n  for (i = 0; i < parts.length; i += 1) {\n    // create a property if it doesn't exist\n    if (typeof parent[parts[i]] === \"undefined\") {\n      parent[parts[i]] = {};\n    }\n    parent = parent[parts[i]];\n  }\n\n  return parent;\n};\n\nBackshift.keys = function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      keys.push(key);\n    }\n  }\n  return keys;\n};\n\nBackshift.extend = function (destination, source) {\n  for (var property in source) {\n    if (source.hasOwnProperty(property)) {\n      destination[property] = source[property];\n    }\n  }\n  return destination;\n};\n\nBackshift.rows = function (matrix) {\n  var ncols = matrix.length;\n  if (ncols === 0) {\n    return [];\n  }\n  var nrows = matrix[0].length;\n\n  var rows = new Array(nrows);\n  for (var i = 0; i < nrows; i++) {\n    var row = new Array(ncols);\n    for (var j = 0; j < ncols; j++) {\n      row[j] = matrix[j][i];\n    }\n    rows[i] = row;\n  }\n\n  return rows;\n};\n\nBackshift.fail = function (msg) {\n  console.log(\"Error: \" + msg);\n  throw \"Error: \" + msg;\n};\n\nBackshift.clone = function (obj) {\n  return JSON.parse(JSON.stringify(obj));\n};\n\n/* Adapted from https://github.com/Jakobo/PTClass */\n\n/*\n Copyright (c) 2005-2010 Sam Stephenson\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n SOFTWARE.\n */\n/* Based on Alex Arnell's inheritance implementation. */\n/** section: Language\n * class Class\n *\n *  Manages Prototype's class-based OOP system.\n *\n *  Refer to Prototype's web site for a [tutorial on classes and\n *  inheritance](http://prototypejs.org/learn/class-inheritance).\n **/\n(function (globalContext) {\n  /* ------------------------------------ */\n  /* Import from object.js                */\n  /* ------------------------------------ */\n  var _toString = Object.prototype.toString,\n    NULL_TYPE = 'Null',\n    UNDEFINED_TYPE = 'Undefined',\n    BOOLEAN_TYPE = 'Boolean',\n    NUMBER_TYPE = 'Number',\n    STRING_TYPE = 'String',\n    OBJECT_TYPE = 'Object',\n    FUNCTION_CLASS = '[object Function]';\n\n  function isFunction(object) {\n    return _toString.call(object) === FUNCTION_CLASS;\n  }\n\n  function extend(destination, source) {\n    for (var property in source) if (source.hasOwnProperty(property)) // modify protect primitive slaughter\n      destination[property] = source[property];\n    return destination;\n  }\n\n  function keys(object) {\n    //if (Type(object) !== OBJECT_TYPE) { throw new TypeError(); }\n    var results = [];\n    for (var property in object) {\n      if (object.hasOwnProperty(property)) {\n        results.push(property);\n      }\n    }\n    return results;\n  }\n\n  function Type(o) {\n    switch (o) {\n      case null:\n        return NULL_TYPE;\n      case (void 0):\n        return UNDEFINED_TYPE;\n    }\n    var type = typeof o;\n    switch (type) {\n      case 'boolean':\n        return BOOLEAN_TYPE;\n      case 'number':\n        return NUMBER_TYPE;\n      case 'string':\n        return STRING_TYPE;\n    }\n    return OBJECT_TYPE;\n  }\n\n  function isUndefined(object) {\n    return typeof object === \"undefined\";\n  }\n\n  /* ------------------------------------ */\n  /* Import from Function.js              */\n  /* ------------------------------------ */\n  var slice = Array.prototype.slice;\n\n  function argumentNames(fn) {\n    var names = fn.toString().match(/^[\\s\\(]*function[^(]*\\(([^)]*)\\)/)[1]\n      .replace(/\\/\\/.*?[\\r\\n]|\\/\\*(?:.|[\\r\\n])*?\\*\\//g, '')\n      .replace(/\\s+/g, '').split(',');\n    return names.length == 1 && !names[0] ? [] : names;\n  }\n\n  function wrap(fn, wrapper) {\n    var __method = fn;\n    return function () {\n      var a = update([bind(__method, this)], arguments);\n      return wrapper.apply(this, a);\n    }\n  }\n\n  function update(array, args) {\n    var arrayLength = array.length, length = args.length;\n    while (length--) array[arrayLength + length] = args[length];\n    return array;\n  }\n\n  function merge(array, args) {\n    array = slice.call(array, 0);\n    return update(array, args);\n  }\n\n  function bind(fn, context) {\n    if (arguments.length < 2 && isUndefined(arguments[0])) return this;\n    var __method = fn, args = slice.call(arguments, 2);\n    return function () {\n      var a = merge(args, arguments);\n      return __method.apply(context, a);\n    }\n  }\n\n  /* ------------------------------------ */\n  /* Import from Prototype.js             */\n  /* ------------------------------------ */\n  var emptyFunction = function () {\n  };\n\n  var Class = (function () {\n\n    // Some versions of JScript fail to enumerate over properties, names of which\n    // correspond to non-enumerable properties in the prototype chain\n    var IS_DONTENUM_BUGGY = (function () {\n      for (var p in {toString: 1}) {\n        // check actual property name, so that it works with augmented Object.prototype\n        if (p === 'toString') return false;\n      }\n      return true;\n    })();\n\n    function subclass() {\n    };\n    function create() {\n      var parent = null, properties = [].slice.apply(arguments);\n      if (isFunction(properties[0]))\n        parent = properties.shift();\n\n      function klass() {\n        this.initialize.apply(this, arguments);\n      }\n\n      extend(klass, Class.Methods);\n      klass.superclass = parent;\n      klass.subclasses = [];\n\n      if (parent) {\n        subclass.prototype = parent.prototype;\n        klass.prototype = new subclass;\n        try {\n          parent.subclasses.push(klass)\n        } catch (e) {\n        }\n      }\n\n      for (var i = 0, length = properties.length; i < length; i++)\n        klass.addMethods(properties[i]);\n\n      if (!klass.prototype.initialize)\n        klass.prototype.initialize = emptyFunction;\n\n      klass.prototype.constructor = klass;\n      return klass;\n    }\n\n    function addMethods(source) {\n      var ancestor = this.superclass && this.superclass.prototype,\n        properties = keys(source);\n\n      // IE6 doesn't enumerate `toString` and `valueOf` (among other built-in `Object.prototype`) properties,\n      // Force copy if they're not Object.prototype ones.\n      // Do not copy other Object.prototype.* for performance reasons\n      if (IS_DONTENUM_BUGGY) {\n        if (source.toString != Object.prototype.toString)\n          properties.push(\"toString\");\n        if (source.valueOf != Object.prototype.valueOf)\n          properties.push(\"valueOf\");\n      }\n\n      for (var i = 0, length = properties.length; i < length; i++) {\n        var property = properties[i], value = source[property];\n        if (ancestor && isFunction(value) &&\n          argumentNames(value)[0] == \"$super\") {\n          var method = value;\n          value = wrap((function (m) {\n            return function () {\n              return ancestor[m].apply(this, arguments);\n            };\n          })(property), method);\n\n          value.valueOf = bind(method.valueOf, method);\n          value.toString = bind(method.toString, method);\n        }\n        this.prototype[property] = value;\n      }\n\n      return this;\n    }\n\n    return {\n      create: create,\n      Methods: {\n        addMethods: addMethods\n      }\n    };\n  })();\n\n  if (globalContext.exports) {\n    globalContext.exports.Class = Class;\n  }\n  else {\n    globalContext.Class = Class;\n  }\n})(Backshift);\n/**\n * Created by jwhite on 5/23/14.\n */\n\nBackshift.namespace('Backshift.Class.Configurable');\n\nBackshift.Class.Configurable = Backshift.Class.create({\n  configure: function (args) {\n    args = args || {};\n\n    Backshift.keys(this.defaults()).forEach(function (key) {\n      if (!args.hasOwnProperty(key)) {\n        this[key] = this[key] || this.defaults()[key];\n        return;\n      }\n\n      if (this.defaults()[key] !== null && typeof this.defaults()[key] == 'object') {\n\n        Backshift.keys(this.defaults()[key]).forEach(function (k) {\n\n          this[key][k] =\n            args[key][k] !== undefined ? args[key][k] :\n              this[key][k] !== undefined ? this[key][k] :\n                this.defaults()[key][k];\n        }, this);\n\n      } else {\n        this[key] =\n          args[key] !== undefined ? args[key] :\n            this[key] !== undefined ? this[key] :\n              this.defaults()[key];\n      }\n\n    }, this);\n  }\n});\n\nBackshift.namespace('Backshift.Utilities.RpnToJexlConverter');\n\n/**\n * References:\n *   http://oss.oetiker.ch/rrdtool/doc/rrdgraph_rpn.en.html\n *   http://commons.apache.org/proper/commons-jexl/reference/syntax.html\n *\n * @author jesse\n */\nBackshift.Utilities.RpnToJexlConverter = Backshift.Class.create({\n  initialize: function () {\n    this.operators = {};\n    this._buildOperators();\n  },\n\n  _buildOperators: function () {\n    var simpleOp = function (op) {\n      return function (stack) {\n        var b = stack.pop();\n        var a = stack.pop();\n        return \"(\" + a + \" \" + op + \" \" + b + \")\";\n      };\n    };\n\n    var funcOp = function (op, numArgs) {\n      return function (stack) {\n        var i, ret = op + \"(\";\n        for (i=0; i < numArgs; i++) {\n          ret += stack.pop() + ',';\n        }\n        return ret.substring(0, ret.length - 1) + ')';\n      };\n    };\n\n    var ifOp = function (stack) {\n      var c = stack.pop();\n      var b = stack.pop();\n      var a = stack.pop();\n      return \"(\" + a + \" != 0 ? \" + b + \" : \" + c + \")\";\n    };\n\n    var unOp = function (stack) {\n      var a = stack.pop();\n      return \"( (\" + a + \" == NaN) ? 1 : 0)\";\n    };\n\n    var infOp = function (stack) {\n      var a = stack.pop();\n      return \"( (\" + a + \" == __inf) || (\" + a + \" == __neg_inf) ? 1 : 0)\";\n    };\n\n    var booleanOp = function (op) {\n      return function (stack) {\n        var b = stack.pop();\n        var a = stack.pop();\n        return \"(\" + a + \" \" + op + \" \" + b + \" ? 1 : 0)\";\n      };\n    };\n\n    var limitOp = function (stack) {\n      var max = stack.pop();\n      var min = stack.pop();\n      var val = stack.pop();\n      return \"( \" +\n        \"( \" +\n          \"(\" + min + \" == __inf) || (\" + min + \" == __neg_inf) \" +\n          \"|| (\" + max + \" == __inf) || (\" + max + \" == __neg_inf) \" +\n          \"|| (\" + val + \" == __inf) || (\" + val + \" == __neg_inf) \" +\n          \"|| (\" + val + \" < \" + min + \") \" +\n          \"|| (\" + val + \" > \" + max + \") \" +\n        \") ? NaN : \" + val + \" \" +\n      \")\";\n    };\n\n    var minMaxNanOp = function(op) {\n      return function (stack) {\n        var b = stack.pop();\n        var a = stack.pop();\n        return \"( \" +\n          \"( \" + a + \" == NaN ) ? \" + b + \" : ( \" +\n            \"( \" + b + \" == NaN ) ? \" + a + \" : ( \" +\n              op + \"(\" + b + \",\" + a + \") \" +\n            \") \" +\n          \") \" +\n        \")\";\n      }\n    };\n\n    var addNanOp = function (stack) {\n      var b = stack.pop();\n      var a = stack.pop();\n      return \"( \" +\n        \"( \" +\n          \"( \" + a + \" == NaN ) && \" +\n          \"( \" + b + \" == NaN ) \" +\n        \") ? NaN : ( \" +\n          \"( \" + a + \" == NaN ) ? \" + b + \" : ( \" +\n            \"( \" + b + \" == NaN ) ? \" + a + \" : ( \" + a + \" + \" + b + \" ) \" +\n          \") \" +\n        \") \" +\n      \")\";\n    };\n\n    var atan2Op = function (stack) {\n      var x = stack.pop();\n      var y = stack.pop();\n      return \"math:atan2(\" + y + \",\" + x + \")\";\n    };\n\n    this.operators['+'] = simpleOp('+');\n    this.operators['-'] = simpleOp('-');\n    this.operators['*'] = simpleOp('*');\n    this.operators['/'] = simpleOp('/');\n    this.operators['%'] = simpleOp('%');\n    this.operators['IF'] = ifOp;\n    this.operators['UN'] = unOp;\n    this.operators['LT'] = booleanOp('<');\n    this.operators['LE'] = booleanOp('<=');\n    this.operators['GT'] = booleanOp('>');\n    this.operators['GE'] = booleanOp('>=');\n    this.operators['EQ'] = booleanOp('==');\n    this.operators['NE'] = booleanOp('!=');\n    this.operators['MIN'] = funcOp('math:min', 2);\n    this.operators['MAX'] = funcOp('math:max', 2);\n    this.operators['MINNAN'] = minMaxNanOp('math:min');\n    this.operators['MAXNAN'] = minMaxNanOp('math:max');\n    this.operators['ISINF'] = infOp;\n    this.operators['LIMIT'] = limitOp;\n    this.operators['ADDNAN'] = addNanOp;\n    this.operators['SIN'] = funcOp('math:sin', 1);\n    this.operators['COS'] = funcOp('math:cos', 1);\n    this.operators['LOG'] = funcOp('math:log', 1);\n    this.operators['EXP'] = funcOp('math:exp', 1);\n    this.operators['SQRT'] = funcOp('math:sqrt', 1);\n    this.operators['ATAN'] = funcOp('math:atan', 1);\n    this.operators['ATAN2'] = atan2Op;\n    this.operators['FLOOR'] = funcOp('math:floor', 1);\n    this.operators['CEIL'] = funcOp('math:ceil', 1);\n    this.operators['RAD2DEG'] = funcOp('math:toDegrees', 1);\n    this.operators['DEG2RAD'] = funcOp('math:toRadians', 1);\n    this.operators['ABS'] = funcOp('math:abs', 1);\n    this.operators['UNKN'] = function() { return 'NaN'; };\n    this.operators['INF'] = function() { return '__inf'; };\n    this.operators['NEGINF'] = function() { return '__neg_inf'; };\n\n  },\n\n  convert: function (rpn) {\n    var token, tokens, n, i, stack = [];\n    tokens = rpn.split(\",\");\n    n = tokens.length;\n    for (i = 0; i < n; i++) {\n      token = tokens[i];\n      if (this._isOperator(token)) {\n        stack.push(this._toExpression(token, stack));\n      } else {\n        stack.push(token);\n      }\n    }\n\n    if (stack.length === 1) {\n      return stack.pop();\n    } else {\n      Backshift.fail('Too many input values in RPN express. RPN: ' + rpn + ' Stack: ' + JSON.stringify(stack));\n    }\n  },\n\n  _isOperator: function (token) {\n    return token in this.operators;\n  },\n\n  _toExpression: function (token, stack) {\n    return this.operators[token](stack);\n  }\n\n});\n\nBackshift.namespace('Backshift.Utilities.RpnEvaluator');\n\n/**\n * References:\n *   http://oss.oetiker.ch/rrdtool/doc/rrdgraph_rpn.en.html\n *   http://commons.apache.org/proper/commons-jexl/reference/syntax.html\n *\n * @author jesse\n */\nBackshift.Utilities.RpnEvaluator = Backshift.Class.create({\n  initialize: function () {\n    this.operators = {};\n    this._buildOperators();\n  },\n\n  _valueOf: function(token, context) {\n    // Attempt to retrieve the named value from the context\n    if (token in context) {\n      if (context.hasOwnProperty(token)) {\n         return context[token];\n      }\n    }\n\n    // Otherwise, assume it's a number\n    return parseFloat(token);\n  },\n\n  _buildOperators: function () {\n    var self = this;\n\n    var funcOp = function (op, numArgs) {\n      return function (stack, context) {\n        var values = new Array(numArgs);\n        for (var i = 0; i < numArgs; i++) {\n          values[i] = self._valueOf(stack.pop(), context);\n        }\n        values.reverse();\n        return op.apply(null, values);\n      };\n    };\n\n    var limitOp = function (stack, context) {\n      var max = self._valueOf(stack.pop(), context);\n      var min = self._valueOf(stack.pop(), context);\n      var val = self._valueOf(stack.pop(), context);\n\n      if (val === Number.POSITIVE_INFINITY || val === Number.NEGATIVE_INFINITY) {\n        return NaN;\n      }\n      if (min == Number.POSITIVE_INFINITY || min === Number.NEGATIVE_INFINITY) {\n        return NaN;\n      }\n      if (max == Number.POSITIVE_INFINITY || max === Number.NEGATIVE_INFINITY) {\n        return NaN;\n      }\n      if (val < min || val > max) {\n        return NaN;\n      }\n      return val;\n    };\n\n    var addNanOp = function (stack, context) {\n      var b = self._valueOf(stack.pop(), context);\n      var a = self._valueOf(stack.pop(), context);\n      if (isNaN(a) && isNaN(b)) {\n        return NaN;\n      } else if (isNaN(a)) {\n        return b;\n      } else if (isNaN(b)) {\n        return a;\n      } else {\n        return a + b;\n      }\n    };\n\n    this.operators['+'] = funcOp(function(a,b) { return a + b; }, 2);\n    this.operators['-'] = funcOp(function(a,b) { return a - b; }, 2);\n    this.operators['*'] = funcOp(function(a,b) { return a * b; }, 2);\n    this.operators['/'] = funcOp(function(a,b) { return a / b; }, 2);\n    this.operators['%'] = funcOp(function(a,b) { return a % b; }, 2);\n    this.operators['IF'] = funcOp(function(a,b,c) { return a != 0 ? b : c; }, 3);\n    this.operators['UN'] = funcOp(function(a) { return isNaN(a) ? 0 : 1; }, 1);\n    this.operators['LT'] = funcOp(function(a,b) { return a < b ? 1 : 0; }, 2);\n    this.operators['LE'] = funcOp(function(a,b) { return a <= b ? 1 : 0; }, 2);\n    this.operators['GT'] = funcOp(function(a,b) { return a > b ? 1 : 0; }, 2);\n    this.operators['GE'] = funcOp(function(a,b) { return a >= b ? 1 : 0; }, 2);\n    this.operators['EQ'] = funcOp(function(a,b) { return a == b ? 1 : 0; }, 2);\n    this.operators['NE'] = funcOp(function(a,b) { return a != b ? 1 : 0; }, 2);\n    this.operators['MIN'] = funcOp(function(a,b) { return Math.min(a,b); }, 2);\n    this.operators['MAX'] = funcOp(function(a,b) { return Math.max(a,b); }, 2);\n    this.operators['MINNAN'] = funcOp(function(a,b) { if (isNaN(a)) { return b; } if (isNaN(b)) { return a; } return Math.min(a,b); }, 2);\n    this.operators['MAXNAN'] = funcOp(function(a,b) { if (isNaN(a)) { return b; } if (isNaN(b)) { return a; } return Math.max(a,b); }, 2);\n    this.operators['ISINF'] = funcOp(function(a) { return (a === Number.POSITIVE_INFINITY || a === Number.NEGATIVE_INFINITY) ? 1 : 0; }, 1);\n    this.operators['LIMIT'] = limitOp;\n    this.operators['ADDNAN'] = addNanOp;\n    this.operators['SIN'] = funcOp(function(a) { return Math.sin(a); }, 1);\n    this.operators['COS'] = funcOp(function(a) { return Math.cos(a); }, 1);\n    this.operators['LOG'] = funcOp(function(a) { return Math.log(a); }, 1);\n    this.operators['EXP'] = funcOp(function(a) { return Math.exp(a); }, 1);\n    this.operators['SQRT'] = funcOp(function(a) { return Math.sqrt(a); }, 1);\n    this.operators['ATAN'] = funcOp(function(a) { return Math.atan(a); }, 1);\n    this.operators['ATAN2'] = funcOp(function(a,b) { return Math.atan(a,b); }, 2);\n    this.operators['FLOOR'] = funcOp(function(a) { return Math.floor(a); }, 1);\n    this.operators['CEIL'] = funcOp(function(a) { return Math.ceil(a); }, 1);\n    this.operators['RAD2DEG'] = funcOp(function(a) { return a * (180/Math.PI) }, 1);\n    this.operators['DEG2RAD'] = funcOp(function(a) { return a * (Math.PI/180) }, 1);\n    this.operators['ABS'] = funcOp(function(a) { return Math.abs(a) }, 1);\n    this.operators['UNKN'] = funcOp(function() { return NaN; }, 0);\n    this.operators['INF'] = funcOp(function() { return Number.POSITIVE_INFINITY; }, 0);\n    this.operators['NEGINF'] = funcOp(function() { return Number.NEGATIVE_INFINITY; }, 0);\n  },\n\n  evaluate: function(rpn, context) {\n    var token, tokens, n, i, stack = [];\n    tokens = rpn.split(\",\");\n    n = tokens.length;\n    for (i = 0; i < n; i++) {\n      token = tokens[i];\n      if (this._isOperator(token)) {\n        stack.push(this._eval(token, stack, context));\n      } else {\n        stack.push(token);\n      }\n    }\n\n    if (stack.length === 1) {\n      return stack.pop();\n    } else {\n      Backshift.fail('Too many input values in RPN express. RPN: ' + rpn + ' Stack: ' + JSON.stringify(stack));\n    }\n  },\n\n  _isOperator: function (token) {\n    return token in this.operators;\n  },\n\n  _eval: function (token, stack, context) {\n    return this.operators[token](stack, context);\n  }\n\n});\n\nBackshift.namespace('Backshift.Utilities.RrdGraphConverter');\n\nBackshift.Utilities.RrdGraphVisitor = Backshift.Class.create({\n  initialize: function (args) {\n    this.onInit(args);\n  },\n\n  onInit: function (args) {\n    // Defined by subclasses\n  },\n\n  _visit: function (graphDef) {\n    // Inspired from http://krasimirtsonev.com/blog/article/Simple-command-line-parser-in-JavaScript\n    var CommandLineParser = (function () {\n      var parse = function (str, lookForQuotes) {\n        var args = [];\n        var readingPart = false;\n        var part = '';\n        var n = str.length;\n        for (var i = 0; i < n; i++) {\n          if (str.charAt(i) === ' ' && !readingPart) {\n            args.push(part);\n            part = '';\n          } else {\n            if (str.charAt(i) === '\\\"' && lookForQuotes) {\n              readingPart = !readingPart;\n              part += str.charAt(i);\n            } else {\n              part += str.charAt(i);\n            }\n          }\n        }\n        args.push(part);\n        return args;\n      };\n      return {\n        parse: parse\n      }\n    })();\n\n    var i, args, command, name, path, dsName, consolFun, rpnExpression, subParts, width, srcName,\n        color, legend, aggregation, value, seriesName;\n    var parts = CommandLineParser.parse(graphDef.command, true);\n    var n = parts.length;\n    for (i = 0; i < n; i++) {\n      if (parts[i].indexOf(\"--\") === 0) {\n        args = /--(.*)=(.*)/.exec(parts[i]);\n        if (args === null) {\n          continue;\n        }\n\n        if (args[1] === \"title\") {\n          this._onTitle(this.displayString(this._decodeString(args[2])));\n        } else if (args[1] === \"vertical-label\") {\n          this._onVerticalLabel(this.displayString(this._decodeString(args[2])));\n        }\n      }\n\n      args = parts[i].match(/(\\\\.|[^:])+/g);\n      if (args === null) {\n        continue;\n      }\n      command = args[0];\n\n      if (command === \"DEF\") {\n        subParts = args[1].split(\"=\");\n        name = subParts[0];\n        path = subParts[1];\n        dsName = args[2];\n        consolFun = args[3];\n        this._onDEF(name, path, dsName, consolFun);\n      } else if (command === \"CDEF\") {\n        subParts = args[1].split(\"=\");\n        name = subParts[0];\n        rpnExpression = subParts[1];\n        this._onCDEF(name, rpnExpression);\n      } else if (command.match(/LINE/)) {\n        width = parseInt(/LINE(\\d+)/.exec(command));\n        subParts = args[1].split(\"#\");\n        srcName = subParts[0];\n        color = '#' + subParts[1];\n        legend = this._decodeString(args[2]);\n        this._onLine(srcName, color, legend, width);\n      } else if (command === \"AREA\") {\n        subParts = args[1].split(\"#\");\n        srcName = subParts[0];\n        color = '#' + subParts[1];\n        legend = this._decodeString(args[2]);\n        this._onArea(srcName, color, legend);\n      } else if (command === \"STACK\") {\n        subParts = args[1].split(\"#\");\n        srcName = subParts[0];\n        color = '#' + subParts[1];\n        legend = this._decodeString(args[2]);\n        this._onStack(srcName, color, legend);\n      } else if (command === \"GPRINT\") {\n        srcName = args[1];\n        aggregation = args[2];\n        value = this._decodeString(args[3]);\n        this._onGPrint(srcName, aggregation, value);\n      } else if (command === \"COMMENT\") {\n        value = this._decodeString(args[1]);\n        this._onComment(value);\n      }\n    }\n  },\n  _onTitle: function (title) {\n\n  },\n  _onVerticalLabel: function (label) {\n\n  },\n  _onDEF: function (name, path, dsName, consolFun) {\n\n  },\n  _onCDEF: function (name, rpnExpression) {\n\n  },\n  _onLine: function (srcName, color, legend, width) {\n\n  },\n  _onArea: function (srcName, color, legend) {\n\n  },\n  _onStack: function (srcName, color, legend) {\n\n  },\n  _onGPrint: function (srcName, aggregation, value) {\n\n  },\n  _onComment: function (value) {\n\n  },\n  _seriesName: function(string) {\n\n  },\n  _decodeString: function (string) {\n    if (string === undefined) {\n      return string;\n    }\n\n    // Remove any quotes\n    string = string.replace(/\"/g, '');\n    // Replace escaped colons\n    string = string.replace(\"\\\\:\", ':');\n\n    return string;\n  },\n  displayString: function (string) {\n    if (string === undefined) {\n      return string;\n    }\n\n    // Remove any newlines\n    string = string.replace(\"\\\\n\", '');\n    // Remove any leading/trailing whitespace\n    string = string.trim();\n    return string;\n  }\n});\n\nBackshift.namespace('Backshift.Utilities.RrdGraphConverter');\n\nBackshift.Utilities.RrdGraphConverter = Backshift.Class.create(Backshift.Utilities.RrdGraphVisitor, {\n\n  onInit: function (args) {\n    this.graphDef = args.graphDef;\n    this.resourceId = args.resourceId;\n    this.convertRpnToJexl = args.convertRpnToJexl === undefined ? true : args.convertRpnToJexl;\n\n    this.model = {\n      metrics: [],\n      series: [],\n      printStatements: [],\n      properties: {}\n    };\n\n    this.rpnConverter = new Backshift.Utilities.RpnToJexlConverter();\n\n    // Replace strings.properties tokens\n    var propertyValue, i, j, n, m, metric;\n    for (i = 0, n = this.graphDef.propertiesValues.length; i < n; i++) {\n      propertyValue = this.graphDef.propertiesValues[i];\n      this.model.properties[propertyValue] = undefined;\n    }\n\n    this._visit(this.graphDef);\n\n    for (i = 0, n = this.model.printStatements.length; i < n; i++) {\n      metric = this.model.printStatements[i].metric;\n      if (metric === undefined) {\n        continue;\n      }\n\n      var foundSeries = false;\n      for (j = 0, m = this.model.series.length; j < m; j++) {\n        if (metric === this.model.series[j].metric) {\n          foundSeries = true;\n          break;\n        }\n      }\n\n      if (!foundSeries) {\n        var series = {\n          metric: metric,\n          type: \"hidden\"\n        };\n        this.model.series.push(series);\n      }\n    }\n\n    // Determine the set of metric names that are used in the series / legends\n    var nonTransientMetrics = {};\n    for (i = 0, n = this.model.series.length; i < n; i++) {\n      nonTransientMetrics[this.model.series[i].metric] = 1;\n    }\n\n    // Mark all other sources as transient - if we don't use their values, then don't return them\n    for (i = 0, n = this.model.metrics.length; i < n; i++) {\n      metric = this.model.metrics[i];\n      metric.transient = !(metric.name in nonTransientMetrics);\n    }\n  },\n\n  _onTitle: function (title) {\n    this.model.title = title;\n  },\n\n  _onVerticalLabel: function (label) {\n    this.model.verticalLabel = label;\n  },\n\n  _onDEF: function (name, path, dsName, consolFun) {\n    var columnIndex = parseInt(/\\{rrd(\\d+)}/.exec(path)[1]) - 1;\n    var attribute = this.graphDef.columns[columnIndex];\n\n    this.prefix = attribute;\n    this.model.metrics.push({\n      name: name,\n      attribute: attribute,\n      resourceId: this.resourceId,\n      datasource: dsName,\n      aggregation: consolFun\n    });\n  },\n\n  _expressionRegexp: new RegExp('\\\\{([^}]*)}', 'g'),\n\n  _onCDEF: function (name, rpnExpression) {\n    var expression = rpnExpression;\n    if(this.convertRpnToJexl) {\n      expression = this.rpnConverter.convert(rpnExpression);\n    }\n    if (this.prefix) {\n      expression = expression.replace(this._expressionRegexp, this.prefix + '.$1');\n    }\n    this.model.metrics.push({\n      name: name,\n      expression: expression\n    });\n  },\n\n  _onLine: function (srcName, color, legend, width) {\n    var series = {\n      name: this.displayString(legend),\n      metric: srcName,\n      type: \"line\",\n      color: color\n    };\n    this.maybeAddPrintStatementForSeries(series.metric, legend);\n    this.model.series.push(series);\n  },\n\n  _onArea: function (srcName, color, legend) {\n    var series = {\n      name: this.displayString(legend),\n      metric: srcName,\n      type: \"area\",\n      color: color\n    };\n    this.maybeAddPrintStatementForSeries(series.metric, legend);\n    this.model.series.push(series);\n  },\n\n  _onStack: function (srcName, color, legend) {\n    var series = {\n      name: this.displayString(legend),\n      metric: srcName,\n      type: \"stack\",\n      color: color,\n      legend: legend\n    };\n    this.maybeAddPrintStatementForSeries(series.metric, legend);\n    this.model.series.push(series);\n  },\n\n  _onGPrint: function (srcName, aggregation, value) {\n    this.model.printStatements.push({\n      metric: srcName,\n      aggregation: aggregation,\n      value: value\n    });\n  },\n\n  _onComment: function (value) {\n    this.model.printStatements.push({\n      value: value\n    });\n  },\n\n  maybeAddPrintStatementForSeries: function(metric, legend) {\n    if (legend === undefined || legend === null || legend === \"\") {\n      return;\n    }\n\n    this.model.printStatements.push({\n      metric: metric,\n      value: \"%g \" + legend\n    });\n }\n});\n\n/**\n * Created by jwhite on 5/21/14.\n */\n\nBackshift.namespace('Backshift.Graph');\n\n/** The core graph implementation */\nBackshift.Graph = Backshift.Class.create(Backshift.Class.Configurable, {\n  initialize: function (args) {\n    if (args.dataSource === undefined) {\n      Backshift.fail('Graph needs a data source.');\n    }\n    this.dataSource = args.dataSource;\n\n    if (args.element === undefined) {\n      Backshift.fail('Graph needs an element.');\n    }\n\n    this.element = args.element;\n    this.model = args.model || {};\n    if (!this.model.metrics) {\n      this.model.metrics = [];\n    }\n    if (!this.model.series) {\n      this.model.series = [];\n    }\n    if (!this.model.printStatements) {\n      this.model.printStatements = [];\n    }\n    this._title = args.title || this.model.title;\n    this._verticalLabel = args.verticalLabel || this.model.verticalLabel;\n    this._regexes = {};\n\n    this.configure(args);\n\n    this.queryInProgress = false;\n    this.lastSuccessfulQuery = 0;\n    this.timer = null;\n\n    this.onInit(args);\n  },\n\n  defaults: function () {\n    return {\n      width: 400,\n      height: 240,\n      resolution: 0,\n      start: 0,\n      end: 0,\n      last: 0,\n      refreshRate: 0,\n      beginOnRender: true,\n      stream: true,\n      checkInterval: 15 * 1000 // 15 seconds\n    };\n  },\n\n  render: function () {\n    if (this.timer !== null) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n\n    this.onRender();\n    if (this.beginOnRender) {\n      this.begin();\n    }\n  },\n\n  begin: function () {\n    this.onBegin();\n    this.refresh();\n    this.createTimer();\n    if (this.stream) {\n      this.startStreaming();\n    }\n  },\n\n  cancel: function () {\n    this.destroyTimer();\n    this.stopStreaming();\n    this.onCancel();\n  },\n\n  resize: function(size) {\n    // Implemented by subclasses\n  },\n\n  destroy: function() {\n    this.destroyTimer();\n  },\n\n  createTimer: function () {\n    var self = this;\n    self.destroyTimer();\n    self.timer = setInterval(function () {\n      if (self.shouldRefresh()) {\n        self.refresh();\n      }\n    }, self.checkInterval);\n  },\n\n  destroyTimer: function () {\n    if (this.timer !== null) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n  },\n\n  setStart: function (start) {\n    this.start = start;\n    this.refresh();\n  },\n\n  setEnd: function (end) {\n    this.end = end;\n    this.refresh();\n  },\n\n  refresh: function () {\n    var self = this;\n\n    if (!self.dataSource.supportsQueries()) {\n      return;\n    }\n\n    var timeSpan = this.getTimeSpan();\n    this.queryInProgress = true;\n    this.onBeforeQuery();\n    this.dataSource.query(timeSpan.start, timeSpan.end, this.getResolution()).then(function (results) {\n      self.queryInProgress = false;\n      self.lastSuccessfulQuery = Date.now();\n      self.updateTextFields(results);\n      self.onQuerySuccess(results);\n      self.onAfterQuery();\n    }, function (reason) {\n      self.queryInProgress = false;\n      self.onQueryFailed(reason);\n      self.onAfterQuery();\n    });\n  },\n\n  startStreaming: function () {\n    var self = this;\n    if (self.dataSource.supportsStreaming() && !self.isStreaming) {\n      self.isStreaming = true;\n      self.dataSource.callback = function(results) {\n        self.onQuerySuccess(results);\n      };\n      this.dataSource.startStreaming();\n    }\n  },\n\n  stopStreaming: function() {\n    var self = this;\n    if (self.isStreaming) {\n      self.isStreaming = false;\n      if (self.dataSource.supportsStreaming()) {\n        self.dataSource.stopStreaming();\n      }\n    }\n  },\n\n  updateTextFields: function(results) {\n    var self = this;\n\n    var title = self._title,\n      verticalLabel = self._verticalLabel,\n      value,\n      re;\n\n    if (self.model.properties) {\n      for (var prop in self.model.properties) {\n        if (!self._regexes[prop]) {\n          self._regexes[prop] = new RegExp(\"\\\\{\" + prop + \"}\", \"g\");\n        }\n        re = self._regexes[prop];\n\n        if (results.constants && results.constants[prop]) {\n          value = results.constants[prop];\n        } else {\n          value = prop;\n        }\n        if (title) { title = title.replace(re, value); }\n        if (verticalLabel) { verticalLabel = verticalLabel.replace(re, value); }\n      }\n    }\n\n    self.title = title;\n    self.verticalLabel = verticalLabel;\n  },\n\n  shouldRefresh: function () {\n    // Don't refresh in another query is already in progress\n    if (this.queryInProgress) {\n      return false;\n    }\n\n    // Don't refresh if disabled.\n    if (this.refreshRate === 0) {\n      return false;\n    }\n\n    return this.lastSuccessfulQuery <= Date.now() - this.refreshRate;\n  },\n\n  getTimeSpan: function () {\n    if (this.start === 0 && this.end === 0 && this.last === 0) {\n      Backshift.fail('Graph needs start and end, or last to be non-zero.');\n    }\n\n    var timeSpan = {};\n    if (this.last > 0) {\n      timeSpan.end = Date.now();\n      timeSpan.start = timeSpan.end - this.last;\n    } else {\n      timeSpan.end = this.end;\n      timeSpan.start = this.start;\n    }\n    return timeSpan;\n  },\n\n  getResolution: function () {\n    if (this.resolution > 0) {\n      return this.resolution;\n    } else {\n      return this.width;\n    }\n  },\n\n  showStatus: function (statusText) {\n    if (this.statusElement) {\n      this.statusElement.text(statusText);\n    } else {\n      this.statusElement = d3.select(this.element)\n        .insert('div', ':first-child');\n      this.statusElement\n        .attr('align', 'center')\n        .attr('class', 'backshift-status')\n        .text(statusText);\n    }\n  },\n\n  hideStatus: function () {\n    if (this.statusElement) {\n      this.statusElement.remove();\n    }\n  },\n\n  onInit: function (args) {\n    // Implemented by subclasses\n  },\n\n  onRender: function () {\n    // Implemented by subclasses\n  },\n\n  onBegin: function () {\n    // Implemented by subclasses\n  },\n\n  onCancel: function () {\n    // Implemented by subclasses\n  },\n\n  onBeforeQuery: function () {\n    // Implemented by subclasses\n  },\n\n  onQuerySuccess: function (results) {\n    // Implemented by subclasses\n  },\n\n  onQueryFailed: function (reason) {\n    console.log(\"Query failed with: \" + reason);\n  },\n\n  onAfterQuery: function () {\n    // Implemented by subclasses\n  }\n});\n\n/**\n * Created by jwhite on 10/12/14.\n */\n\nBackshift.namespace('Backshift.Graph.Flot');\n\n/** Renders the graoh using Flot */\nBackshift.Graph.Flot = Backshift.Class.create(Backshift.Graph, {\n\n  defaults: function ($super) {\n    return Backshift.extend($super(), {\n      width: '100%',\n      height: '100%',\n      title: undefined,\n      verticalLabel: undefined,\n      zoom: true, // whether to allow zooming\n      xaxisFont: undefined, // flot \"font\" spec, see http://flot.googlecode.com/svn/trunk/API.txt for details\n      yaxisFont: undefined, // flot \"font\" spec\n      legendFontSize: undefined, // font size (integer)\n      ticks: undefined, // number of x-axis ticks, defaults to a value based on the width\n    });\n  },\n\n  onInit: function () {\n    var container = jQuery(this.element);\n    // Set the container dimensions, Flot's canvas will use 100% of the container div\n    container.width(this.width);\n    container.height(this.height);\n  },\n\n\n  onBeforeQuery: function () {\n    this.showStatus('Loading...');\n  },\n\n  onQueryFailed: function () {\n    this.showStatus('Query failed.');\n  },\n\n  onQuerySuccess: function (results) {\n    this.hideStatus();\n    this.drawChart(results);\n  },\n\n  _shouldStack: function (k) {\n    // If there's stack following the area, set the area to stack\n    if (this.model.series[k].type === \"area\") {\n      var n = this.model.series.length;\n      for (var i = k; i < n; i++) {\n        if (this.model.series[i].type === \"stack\") {\n          return 1;\n        }\n      }\n    }\n    return this.model.series[k].type === \"stack\";\n  },\n\n  drawChart: function (results) {\n    if (!results || !results.columns) {\n      return;\n    }\n\n    var self = this;\n    var container = jQuery(this.element);\n\n    var timestamps = results.columns[0];\n    var series, values, i, j, numSeries, numValues, X, Y, columnName, shouldStack, shouldFill, seriesValues, shouldShow;\n    numSeries = this.model.series.length;\n    numValues = timestamps.length;\n\n    var from = timestamps[0];\n    var to = timestamps[timestamps.length - 1];\n\n    this.flotSeries = [];\n    this.hiddenFlotSeries = [];\n\n    var lastSeriesToStackWith = null;\n\n    // Build the columns for the series\n    for (i = 0; i < numSeries; i++) {\n      columnName = \"data\" + i;\n      series = this.model.series[i];\n      values = results.columns[results.columnNameToIndex[series.metric]];\n\n      shouldStack = this._shouldStack(i);\n      shouldFill = this.model.series[i].type === \"stack\" || this.model.series[i].type === \"area\";\n      shouldShow = this.model.series[i].type !== \"hidden\";\n\n      seriesValues = [];\n      for (j = 0; j < numValues; j++) {\n        var yOffset = 0;\n        if (shouldStack && lastSeriesToStackWith != null) {\n          yOffset = lastSeriesToStackWith.data[j][1];\n        }\n        var yVal = isNaN(values[j]) ? values[j] : values[j] + yOffset;\n\n        seriesValues.push([timestamps[j], yVal, yOffset]);\n      }\n\n      var flotSeries = {\n        label: series.name,\n        color: series.color,\n        lines: {\n          show: true,\n          fill: shouldFill,\n          fillColor: series.color\n        },\n        data: seriesValues,\n        id: columnName,\n        metric: series.metric,\n        nodatatable: (series.name === undefined || series.name === null || series.name === '')\n      };\n\n      if (shouldShow) {\n        this.flotSeries.push(flotSeries);\n\n        if (shouldStack) {\n          lastSeriesToStackWith = flotSeries;\n        }\n      } else {\n        this.hiddenFlotSeries.push(flotSeries);\n      }\n    }\n\n    var yaxisTickFormat = d3.format(\".3s\");\n\n    var options = {\n      canvas: true,\n      title: self.title,\n      axisLabels: {\n        show: true\n      },\n      hooks: {\n        draw: [self.drawHook]\n      },\n      series: {\n        lines:  {\n          zero: false\n        },\n        bars:   {\n          fill: 1,\n          barWidth: 1,\n          zero: false,\n          lineWidth: 0\n        },\n        points: {\n          fill: 1,\n          fillColor: false\n        },\n        shadowSize: 1\n      },\n      yaxis: {\n        tickFormatter: yaxisTickFormat\n      },\n      yaxes: [{\n        position: 'left',\n        axisLabel: self.verticalLabel,\n        axisLabelUseHtml: false,\n        axisLabelUseCanvas: true\n      }],\n      xaxis: { },\n      grid: {\n        minBorderMargin: 0,\n        markings: [],\n        backgroundColor: null,\n        borderWidth: 0,\n        hoverable: true,\n        color: '#c8c8c8',\n        margin: { left: 0, right: 0, top: 25, bottom: 0 }\n      },\n      selection: {\n        mode: \"x\",\n        color: '#666'\n      },\n      legend: {\n        show: false,\n        statements: self.model.printStatements\n      },\n      hiddenSeries: this.hiddenFlotSeries,\n      tooltip: {\n        show: true\n      },\n      datatable: {\n        xaxis: {\n          label: 'Date/Time',\n          format: function(x) {\n            var format = d3.time.format(\"%c\");\n            return format(new Date(x));\n          }\n        },\n        yaxis: {\n          ignoreColumnsWithNoLabel: true,\n          format: function(y) {\n            try {\n              return yaxisTickFormat(y);\n            } catch (err) {\n              return NaN;\n            }\n          }\n        }\n      },\n      zoom: {\n        interactive: true\n      },\n      pan: {\n        interactive: true\n      }\n    };\n\n    this.addTimeAxis(options, from, to);\n\n    if (self.xaxisFont) {\n      options.xaxis.font = self.getFontSpec(self.xaxisFont);\n    }\n    if (self.yaxisFont) {\n      options.yaxis.font = self.getFontSpec(self.yaxisFont);\n    }\n    if (self.legendFontSize) {\n      if (!options.legend.style) {\n        options.legend.style = {};\n      }\n      options.legend.style.fontSize = this.legendFontSize;\n    }\n\n    var chart = jQuery.plot(container, this.flotSeries, options);\n\n    // Limit the zooming and panning so that at least one point is always visible\n    var yaxis = chart.getAxes().yaxis;\n    chart.ranges = {\n      yaxis: { panRange: [yaxis.min, yaxis.max], zoomRange: false}, xaxis: { panRange: [from,to], zoomRange: null }\n    };\n  },\n\n  getFontSpec: function(fontSpec) {\n    var ret = {\n      size: 'inherit',\n      family: 'inherit',\n      style: 'inherit',\n      weight: 'inherit',\n      variant: 'inherit',\n      color: 'inherit',\n    };\n    if (fontSpec) {\n      if (fontSpec.size) {\n        ret.size = fontSpec.size;\n      }\n      if (fontSpec.family) {\n        ret.family = fontSpec.family;\n      }\n      if (fontSpec.style) {\n        ret.style = fontSpec.style;\n      }\n      if (fontSpec.weight) {\n        ret.weight = fontSpec.weight;\n      }\n      if (fontSpec.variant) {\n        ret.variant = fontSpec.variant;\n      }\n      if (fontSpec.color) {\n        ret.color = fontSpec.color;\n      }\n    }\n    return ret;\n  },\n\n  drawHook: function(plot, canvascontext) {\n    var cx = canvascontext.canvas.clientWidth / 2;\n    canvascontext.font=\"15px sans-serif\";\n    canvascontext.textAlign = 'center';\n    canvascontext.fillText(plot.getOptions().title, cx, 15);\n  },\n\n  addTimeAxis: function(options, from, to) {\n    var elem = jQuery(this.element);\n    var ticks = this.ticks || (elem.width() / 100);\n\n    options.xaxis = {\n      mode: \"time\",\n      timezone: \"browser\",\n      min: from,\n      max: to,\n      label: \"Datetime\",\n      ticks: ticks,\n      timeformat: this.time_format(ticks, from, to)\n    };\n  },\n\n  time_format: function(ticks, min, max) {\n    if (min && max && ticks) {\n      var secPerTick = ((max - min) / ticks) / 1000;\n\n      if (secPerTick <= 45) {\n        return \"%H:%M:%S\";\n      }\n      if (secPerTick <= 7200) {\n        return \"%H:%M\";\n      }\n      if (secPerTick <= 80000) {\n        return \"%m/%d %H:%M\";\n      }\n      if (secPerTick <= 2419200) {\n        return \"%m/%d\";\n      }\n      return \"%Y-%m\";\n    }\n\n    return \"%H:%M\";\n  }\n});\n\n/**\n * Created by jwhite on 5/22/14.\n */\n\nBackshift.namespace('Backshift.DataSource');\n\n/**\n * Abstract data-source used to retrieve time series data.\n *\n * @constructor\n * @param {object} args Dictionary of arguments.\n * @param          [args.metrics]\n */\nBackshift.DataSource = Backshift.Class.create(Backshift.Class.Configurable, {\n\n  initialize: function (args) {\n    if (args.metrics === undefined || args.metrics.length === 0) {\n      Backshift.fail('DataSource needs one or more metrics.');\n    }\n\n    this.metrics = args.metrics;\n\n    this.configure(args);\n\n    this.onInit(args);\n  },\n\n  defaults: function () {\n    return {};\n  },\n\n  /**\n   * @param {number} [start] Milliseconds since the Unix epoch.\n   * @param {number} [end] Milliseconds since the Unix epoch.\n   * @param {number} [resolution] Desired number of points.\n   * @param {object} [args] Additional parameter that is passed to the callbacks.\n   */\n  query: function (start, end, resolution, args) {\n    // Defined by subclasses\n  },\n\n  supportsQueries: function() {\n    return true;\n  },\n\n  supportsStreaming: function() {\n    return false;\n  },\n\n  onInit: function (args) {\n    // Defined by subclasses\n  }\n});\n\n/**\n * Created by jwhite on 6/6/14.\n */\n\nBackshift.namespace('Backshift.DataSource.OpenNMS');\n\nBackshift.DataSource.OpenNMS = Backshift.Class.create(Backshift.DataSource, {\n  defaults: function ($super) {\n    return Backshift.extend($super(), {\n      url: \"http://127.0.0.1:8980/opennms/rest/measurements\",\n      username: null,\n      password: null,\n      fetchFunction: null,\n    });\n  },\n\n  onInit: function(args) {\n    if (!this.fetchFunction) {\n      this.fetchFunction = this.post;\n    }\n  },\n\n  /* An overridable post method.\n   *\n   * @param {object} data A JSON object with data to POST.\n   * @param {function} onSuccess A function to call on success.\n   * @param {function} onFailure A function to call on failure.\n   */\n  post: function(url, data, onSuccess, onFailure) {\n    var self = this,\n      withCredentials = self.username !== null && self.password !== null,\n      headers = {};\n\n    if (withCredentials) {\n      headers['Authorization'] = \"Basic \" + window.btoa(self.username + \":\" + self.password);\n    }\n\n    jQuery.ajax({\n      url: url,\n      xhrFields: {\n        withCredentials: withCredentials\n      },\n      headers: headers,\n      type: 'POST',\n      data: JSON.stringify(data),\n      contentType: 'application/json',\n      dataType: 'json',\n      success: onSuccess,\n      error: onFailure\n    });\n\n  },\n\n  query: function (start, end, resolution, args) {\n    var self = this;\n    var dfd = jQuery.Deferred();\n\n    var data = self._getQueryRequest(start, end, resolution),\n      success = function QuerySuccess(response) {\n        dfd.resolve(self._parseResponse(response));\n      },\n      failure = function QueryFailure(jqXmr, textStatus) {\n        dfd.reject(textStatus);\n      };\n\n    self.fetchFunction(self.url, data, success, failure);\n\n    return dfd.promise();\n  },\n\n  _getQueryRequest: function (start, end, resolution) {\n    var queryRequest = {\n      \"start\": start,\n      \"end\": end,\n      \"step\": resolution > 0 ? Math.floor((end - start) / resolution) : 1,\n      \"source\": [],\n      \"expression\": []\n    };\n\n    var timeDeltaInSeconds = end - start;\n\n    var qrSource;\n    Backshift.keys(this.metrics).forEach(function (key) {\n      var metric = this.metrics[key];\n      if (metric.resourceId !== undefined) {\n        qrSource = {\n          aggregation: metric.aggregation,\n          attribute: metric.attribute,\n          label: metric.name,\n          resourceId: metric.resourceId,\n          transient: metric.transient\n        };\n        // Only set the datasource when it differs from the attribute name in order\n        // to preserve backwards compatibility with 16.x (which does not recognize the datasource field)\n        if (metric.datasource !== undefined && metric.attribute !== metric.datasource) {\n          qrSource.datasource = metric.datasource;\n        }\n        queryRequest.source.push(qrSource);\n      } else {\n        qrSource = {\n          value: metric.expression,\n          label: metric.name,\n          transient: metric.transient\n        };\n        qrSource.value = qrSource.value.replace(\"{diffTime}\", timeDeltaInSeconds);\n        queryRequest.expression.push(qrSource);\n      }\n    }, this);\n\n    if (queryRequest.source.length === 0) {\n      delete queryRequest.source;\n    }\n\n    if (queryRequest.expression.length === 0) {\n      delete queryRequest.expression;\n    }\n\n    return queryRequest;\n  },\n\n  _parseResponse: function (json) {\n    var k, columns, columnNames, columnNameToIndex, constants, numMetrics = json.labels.length;\n\n    columns = new Array(1 + numMetrics);\n    columnNames = new Array(1 + numMetrics);\n    columnNameToIndex = {};\n\n    columns[0] = json.timestamps;\n    columnNames[0] = 'timestamp';\n    columnNameToIndex['timestamp'] = 0;\n\n    for (k = 0; k < numMetrics; k++) {\n      columns[1 + k] = json.columns[k].values;\n      columnNames[1 + k] = json.labels[k];\n      columnNameToIndex[columnNames[1 + k]] = 1 + k;\n    }\n\n    if (json.constants) {\n      constants = {};\n      for (var c=0, len=json.constants.length, key, value, label; c < len; c++) {\n        key = json.constants[c].key;\n        value = json.constants[c].value;\n        for (var l=0; l < numMetrics; l++) {\n          label = json.labels[l];\n          if (key.indexOf(label+'.') === 0) {\n            // constant matches the label, extract the constant name\n            key = key.substring((label+'.').length);\n            constants[key] = (value === undefined? null: value);\n          }\n        }\n      }\n    }\n\n    return {\n      columns: columns,\n      columnNames: columnNames,\n      columnNameToIndex: columnNameToIndex,\n      constants: constants,\n    };\n  }\n});\n\n/**\n * Datasource for OpenNMS' Near Real-Time Graphing (NRTG) feature.\n *\n * Requires Horizon 17.1.0 or greater.\n *\n * Created by jwhite on 11/29/2015.\n */\nBackshift.namespace('Backshift.DataSource.NRTG');\n\nBackshift.DataSource.NRTG = Backshift.Class.create(Backshift.DataSource, {\n  defaults: function ($super) {\n    return Backshift.extend($super(), {\n      url: \"http://127.0.0.1:8980/opennms/nrt/starter\",\n      callback: function(){},\n      username: null,\n      password: null,\n      getFunction: null,\n      slidingWindow: 30,\n      pollingInterval: 1000\n    });\n  },\n\n  onInit: function(args) {\n    if (!this.getFunction) {\n      this.getFunction = this.get;\n    }\n\n    if (this.metrics.length !== 1) {\n      Backshift.fail('NRTG only supports streaming a single metric.');\n    }\n\n    // The last measurement set\n    this.lastMeasurementSet = {};\n    // Calculated rows\n    this.rows = [];\n    // Instance of the interval\n    this.pollingIntervalId = null;\n  },\n\n  supportsQueries: function() {\n    return false;\n  },\n\n  supportsStreaming: function() {\n    return true;\n  },\n\n  startStreaming: function() {\n    var self = this;\n    var dfd = jQuery.Deferred();\n\n    self.getFunction(this.url, {\n      resourceId: self.metrics[0].resourceId,\n      report: self.metrics[0].report\n    }, function(nrtgCollectionDetails) {\n      self.handleCollectionDetails(nrtgCollectionDetails);\n      dfd.resolve();\n    }, function(jqXmr, textStatus) {\n      dfd.reject(textStatus);\n    });\n\n    return dfd.promise();\n  },\n\n  stopStreaming: function () {\n    var self = this;\n    if (self.pollingIntervalId !== null) {\n      clearInterval(self.pollingIntervalId);\n      self.pollingIntervalId = null;\n    }\n  },\n\n  updatePollingInterval: function(pollingInterval) {\n    var self = this;\n    self.pollingInterval = pollingInterval;\n    if (self.pollingIntervalId !== null) {\n      clearInterval(self.pollingIntervalId);\n      var poll = function() {self.poll();}.bind(self);\n      self.pollingIntervalId = setInterval(poll, self.pollingInterval);\n    }\n  },\n\n  updateSlidingWindow: function(slidingWindow) {\n    var self = this;\n    self.slidingWindow = slidingWindow;\n    self._processRowsAndNotify();\n  },\n\n  handleCollectionDetails: function(nrtgCollectionDetails) {\n    var self = this;\n\n    // Build a graph definition using the data from the collection details\n    var graph = {\n      \"command\": nrtgCollectionDetails.rrdGraphString,\n      \"externalValues\": [],\n      \"propertiesValues\": [],\n      \"columns\": self._metricMappingsToColumns(nrtgCollectionDetails.metricsMapping)\n    };\n\n    // Generate the model from the graph definition\n    var rrdGraphConverter = new Backshift.Utilities.RrdGraphConverter({\n      graphDef: graph,\n      resourceId: self.metrics[0].resourceId,\n      convertRpnToJexl: false\n    });\n    self.model = rrdGraphConverter.model;\n\n    // Start polling\n    self.collectionTaskId = nrtgCollectionDetails.collectionTaskId;\n    var poll = function() {self.poll();}.bind(self);\n    poll();\n    self.pollingIntervalId = setInterval(poll, self.pollingInterval);\n  },\n\n  poll: function() {\n    var self = this;\n    if (self.pollInProgress === true) {\n      // If another poll is already in progress, then skip this one\n      return;\n    }\n\n    self.pollInProgress = true;\n    self.getFunction(self.url, {\n      poll: true,\n      nrtCollectionTaskId: self.collectionTaskId\n    }, function(data) {\n      self.pollInProgress = false;\n\n      // Compute the measurements\n      self._calculateMeasurements(data.measurement_sets);\n\n      // Issue the callback\n      self._processRowsAndNotify();\n    }, function(jqXmr, textStatus) {\n      // If a poll fails, log it, but don't take any actions, we'll just try again next time\n      self.pollInProgress = false;\n      console.log(\"NRTG: Poll failed with '\" + textStatus + \"'.\");\n    });\n  },\n\n  _metricMappingsToColumns: function(metricsMapping) {\n    var columns = [];\n    for (var i = 1, nmetrics = Object.keys(metricsMapping).length; i <= nmetrics; i++) {\n      var found = false;\n      for (var key in metricsMapping) {\n        if (metricsMapping.hasOwnProperty(key)) {\n          if (metricsMapping[key].indexOf(\"{rrd\" + i + \"}\") > -1) {\n            columns.push(key);\n            found = true;\n            break;\n          }\n        }\n      }\n\n      if (!found) {\n        Backshift.fail(\"Missing {rrd\" + i + \"}\");\n      }\n    }\n    return columns;\n  },\n\n  _calculateMeasurements: function(measurementSets) {\n    var self = this;\n    for (var i = 0, nsets = measurementSets.length; i < nsets; i++) {\n\n      // Index the metrics by metricId\n      var metricsById = {};\n      var timestamp = 0;\n      for (var j = 0, nmetrics = measurementSets[i].length; j < nmetrics; j++) {\n        var metric = measurementSets[i][j];\n        metricsById[metric.metricId] = metric;\n        timestamp = metric.timeStamp;\n      }\n\n      // Calculate the measurements\n      var rpnEvaluator = new Backshift.Utilities.RpnEvaluator();\n      var row = {\n        timestamp: timestamp\n      };\n      for (j = 0, nmetrics = self.model.metrics.length; j < nmetrics; j++) {\n        var modelMetric = self.model.metrics[j];\n        var isExpression = \"expression\" in modelMetric;\n\n        var value = NaN;\n        if (!isExpression) {\n          if (modelMetric.attribute in metricsById) {\n            var metric = metricsById[modelMetric.attribute];\n            value = metric.value;\n\n            // Convert counters to rates\n            var isCounter = metric.metricType.indexOf(\"counter\") > -1;\n            if (isCounter) {\n              var lastValue = NaN;\n              if (modelMetric.attribute in self.lastMeasurementSet) {\n                lastValue = self.lastMeasurementSet[modelMetric.attribute].value;\n              }\n              value = value - lastValue;\n            }\n          }\n        } else {\n          value = rpnEvaluator.evaluate(modelMetric.expression, row);\n        }\n\n        row[modelMetric.name] = value;\n      }\n\n      // Save the results\n      self.rows.push(row);\n      self.lastMeasurementSet = metricsById;\n    }\n  },\n\n  _processRowsAndNotify: function() {\n    var self = this;\n\n    // Limit the amount of rows processed if we're using a sliding window\n    var indexOfFirstRow = 0;\n    if (self.slidingWindow > 0) {\n      // Only use a subset of the rows\n      indexOfFirstRow = self.rows.length - self.slidingWindow;\n      if (indexOfFirstRow < 0) {\n        indexOfFirstRow = 0;\n      }\n    }\n\n    // Convert the rows to columns\n    var columns = {};\n    for (var i = indexOfFirstRow, nrows = self.rows.length; i < nrows; i++) {\n      var row = self.rows[i];\n      for (var key in row) {\n        if (!row.hasOwnProperty(key)) {\n          continue;\n        }\n\n        if (key in columns) {\n          columns[key].push(row[key]);\n        } else {\n          columns[key] = [row[key]];\n        }\n      }\n    }\n\n    // Drop any transient columns\n    for (j = 0, nmetrics = self.model.metrics.length; j < nmetrics; j++) {\n      var modelMetric = self.model.metrics[j];\n      if (modelMetric.transient) {\n        delete columns[modelMetric.name];\n      }\n    }\n\n    // Index the columns\n    var results = {\n      columns: [],\n      columnNames: [],\n      columnNameToIndex: {}\n    };\n\n    $.each(columns, function (columnName, columnValues) {\n      results.columns.push(columnValues);\n      results.columnNames.push(columnName);\n      results.columnNameToIndex[columnName] = results.columns.length - 1;\n    });\n\n    // Issue the callback\n    self.callback(results);\n  },\n\n  /* An overridable GET method.\n   *\n   * @param {function} onSuccess A function to call on success.\n   * @param {function} onFailure A function to call on failure.\n   */\n  get: function(url,  data, onSuccess, onFailure) {\n    var self = this,\n        withCredentials = self.username !== null && self.password !== null,\n        headers = {};\n\n    if (withCredentials) {\n      headers['Authorization'] = \"Basic \" + window.btoa(self.username + \":\" + self.password);\n    }\n\n    jQuery.ajax({\n      url: url,\n      xhrFields: {\n        withCredentials: withCredentials\n      },\n      headers: headers,\n      type: 'GET',\n      cache: false,\n      data: data,\n      dataType: 'json',\n      success: onSuccess,\n      error: onFailure\n    });\n  }\n});\n// Register as an AMD module,\nif ( true ) {\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! d3 */ 196)], __WEBPACK_AMD_DEFINE_FACTORY__ = (Backshift), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n}\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 5), __webpack_require__(/*! jquery */ 5)))\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/backshift/dist/backshift.onms.js\n ** module id = 195\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./bower_components/backshift/dist/backshift.onms.js?");

/***/ },
/* 196 */,
/* 197 */
/*!*****************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/onms-graph.html ***!
  \*****************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/nodes/onms-graph.html';\nvar html = \"<div class=\\\"onms-graph\\\">\\n\\t<div class=\\\"graph\\\"></div>\\n\\t<div class=\\\"row picker\\\">\\n\\t\\t<div class=\\\"col datepicker\\\" style=\\\"text-align: left\\\" ng-click=\\\"editDate('start')\\\">\\n\\t\\t\\tStart: <span class=\\\"datetime\\\">{{range.start | date : 'short' }} <i class=\\\"icon ion-clock\\\"></i></span>\\n\\t\\t</div>\\n\\t\\t<div class=\\\"col datepicker\\\" style=\\\"text-align: right\\\" ng-click=\\\"editDate('end')\\\">\\n\\t\\t\\tEnd: <span class=\\\"datetime\\\">{{range.end | date : 'short' }} <i class=\\\"icon ion-clock\\\"></i></span>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/onms-graph.html\n ** module id = 197\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/onms-graph.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 198 */
/*!********************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/dashboard/dashboard.html ***!
  \********************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/dashboard/dashboard.html';\nvar html = \"<ion-view class=\\\"dashboard\\\">\\n\\t<ion-nav-bar class=\\\"bar-light\\\" align-title=\\\"center\\\">\\n\\t\\t<ion-nav-buttons side=\\\"left\\\">\\n\\t\\t\\t<a class=\\\"button button-icon button-compass button-clear ion-ios-alarm-outline\\\" nav-direction=\\\"back\\\" ui-sref=\\\"alarms\\\"></a>\\n\\t\\t</ion-nav-buttons>\\n\\t\\t<ion-nav-title><img ng-src=\\\"{{logo}}\\\"></ion-nav-title>\\n\\t\\t<ion-nav-buttons side=\\\"right\\\">\\n\\t\\t\\t<a class=\\\"button button-icon button-compass button-clear ion-monitor\\\" nav-direction=\\\"forward\\\" ui-sref=\\\"nodes\\\"></a>\\n\\t\\t</ion-nav-buttons>\\n\\t</ion-nav-bar>\\n\\t<ion-header-bar class=\\\"bar bar-header bar-subheader\\\">\\n\\t\\t<h3 class=\\\"title compass\\\" ng-click=\\\"showSelectServer($event)\\\"><span ng-if=\\\"serverName\\\">{{serverName}} <i class=\\\"icon ion-arrow-down-b\\\"></i></span></h3>\\n\\t</ion-header-bar>\\n\\t<ion-content padding=\\\"false\\\" scroll=\\\"true\\\" class=\\\"has-header\\\" overflow-scroll=\\\"false\\\">\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"refreshData()\\\"></ion-refresher>\\n\\t\\t<div class=\\\"header\\\"><h3 class=\\\"title compass\\\" ng-if=\\\"serverName === null\\\" style=\\\"padding-top: 10px\\\">No server configured.</h3></div>\\n\\t\\t<ion-slide-box on-slide-changed=\\\"refreshDonutSlide(index)\\\" show-pager=\\\"false\\\" delegate-handle=\\\"donut-slide-box\\\" ng-if=\\\"!wide\\\" class=\\\"portrait\\\">\\n\\t\\t\\t<ion-slide class=\\\"outages\\\" ng-style=\\\"{width: donutSize, height: donutSize}\\\">\\n\\t\\t\\t\\t<i id=\\\"outage-arrow\\\" class=\\\"icon ion-chevron-right right-arrow compass\\\" ng-click=\\\"goToDonutSlide(1)\\\" ng-class=\\\"donutClass('outages')\\\"></i>\\n\\t\\t\\t\\t<h3 ng-if=\\\"e.hasError('outage-chart')\\\" class=\\\"item item-text-wrap title error\\\">Error: Unable to retrieve outages.<span ng-if=\\\"e.get('outage-chart').permissionDenied()\\\"><br/>Permission denied.</span></h3>\\n\\t\\t\\t\\t<flot dataset=\\\"donuts.outages.data\\\" options=\\\"donuts.outages.options\\\" ng-click=\\\"modals.outages()\\\" ng-if=\\\"donutSize &gt; 0 &amp;&amp; donuts.outages.options\\\" ng-attr-width=\\\"{{donutSize}}\\\" ng-attr-height=\\\"{{donutSize}}\\\"></flot>\\n\\t\\t\\t\\t<div class=\\\"donut-title\\\"></div>\\n\\t\\t\\t</ion-slide>\\n\\t\\t\\t<ion-slide class=\\\"alarms\\\" ng-style=\\\"{width: donutSize, height: donutSize}\\\">\\n\\t\\t\\t\\t<i id=\\\"alarm-arrow\\\" class=\\\"icon ion-chevron-left left-arrow compass\\\" ng-click=\\\"goToDonutSlide(0)\\\" ng-class=\\\"donutClass('alarms')\\\"></i>\\n\\t\\t\\t\\t<h3 ng-if=\\\"e.hasError('alarm-chart')\\\" class=\\\"item item-text-wrap title error\\\">Error: Unable to retrieve alarm data.<span ng-if=\\\"e.get('alarm-chart').permissionDenied()\\\"><br/>Permission denied.</span></h3>\\n\\t\\t\\t\\t<flot dataset=\\\"donuts.alarms.data\\\" options=\\\"donuts.alarms.options\\\" ng-if=\\\"donutSize &gt; 0 &amp;&amp; donuts.alarms.options\\\" ng-attr-width=\\\"{{donutSize}}\\\" ng-attr-height=\\\"{{donutSize}}\\\"></flot>\\n\\t\\t\\t\\t<div class=\\\"donut-title\\\"></div>\\n\\t\\t\\t</ion-slide>\\n\\t\\t</ion-slide-box>\\n\\t\\t<div class=\\\"row wide\\\" ng-if=\\\"wide\\\">\\n\\t\\t\\t<div class=\\\"outages col col-50\\\" ng-style=\\\"{width: donutSize, height: donutSize}\\\">\\n\\t\\t\\t\\t<h3 ng-if=\\\"e.hasError('outage-chart')\\\" class=\\\"item item-text-wrap title error\\\">Error: Unable to retrieve outages.<span ng-if=\\\"e.get('outage-chart').permissionDenied()\\\"><br/>Permission denied.</span></h3>\\n\\t\\t\\t\\t<flot dataset=\\\"donuts.outages.data\\\" options=\\\"donuts.outages.options\\\" ng-click=\\\"modals.outages()\\\" ng-if=\\\"donutSize &gt; 0 &amp;&amp; donuts.outages.options\\\" ng-attr-width=\\\"{{donutSize}}\\\" ng-attr-height=\\\"{{donutSize}}\\\"></flot>\\n\\t\\t\\t\\t<div class=\\\"donut-title\\\"></div>\\n\\t\\t\\t</div>\\n\\t\\t\\t<div class=\\\"alarms col col-50\\\" ng-style=\\\"{width: donutSize, height: donutSize}\\\">\\n\\t\\t\\t\\t<h3 ng-if=\\\"e.hasError('alarm-chart')\\\" class=\\\"item item-text-wrap title error\\\">Error: Unable to retrieve alarm data.<span ng-if=\\\"e.get('alarm-chart').permissionDenied()\\\"><br/>Permission denied.</span></h3>\\n\\t\\t\\t\\t<flot dataset=\\\"donuts.alarms.data\\\" options=\\\"donuts.alarms.options\\\" ng-if=\\\"donutSize &gt; 0 &amp;&amp; donuts.alarms.options\\\" ng-attr-width=\\\"{{donutSize}}\\\" ng-attr-height=\\\"{{donutSize}}\\\"></flot>\\n\\t\\t\\t\\t<div class=\\\"donut-title\\\"></div>\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t\\t<span ng-if=\\\"favoriteGraphs &amp;&amp; favoriteGraphs.length > 0\\\" class=\\\"graphs\\\">\\n\\t\\t\\t<!--<div class=\\\"spacer\\\"></div>-->\\n\\t\\t\\t<div class=\\\"header compass-bg\\\"><h3>Favorited Graphs</h3></div>\\n\\t\\t\\t<ion-slide-box on-slide-changed=\\\"refreshGraphSlide(index)\\\" delegate-handle=\\\"graph-slide-box\\\" show-pager=\\\"false\\\">\\n\\t\\t\\t\\t<ion-slide ng-repeat=\\\"favorite in favoriteGraphs track by favorite._id\\\">\\n\\t\\t\\t\\t\\t<h4 class=\\\"label\\\">{{favorite.nodeLabel}} <button class=\\\"button button-clear button-small button-compass\\\" ng-click=\\\"unfavorite(favorite)\\\"><i class=\\\"icon ion-ios-star\\\"></i></button></h4>\\n\\t\\t\\t\\t\\t\\t<onms-graph graph-def=\\\"graphs[favorite.graphName]\\\" resource-id=\\\"favorite.resourceId\\\" range=\\\"range\\\" display=\\\"shouldRenderGraph($index)\\\"></onms-graph>\\n\\t\\t\\t\\t</ion-slide>\\n\\t\\t\\t</ion-slide-box>\\n\\t\\t</span>\\n\\n\\t\\t<div class=\\\"spacer\\\"></div>\\n\\t\\t<span ng-if=\\\"availability &amp;&amp; availability.length > 0\\\" class=\\\"availability\\\">\\n\\t\\t\\t<span ng-repeat=\\\"section in availability track by section.name\\\">\\n\\t\\t\\t\\t<div class=\\\"item item-compass item-divider row\\\" style=\\\"font-size: 90%\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-50\\\">{{section.name}}</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">Outages</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col col-25\\\">Availability</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div ng-repeat=\\\"category in section.categories track by category.name\\\" class=\\\"item row noright nobottom\\\" style=\\\"font-size: 75%\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-50\\\">{{category.name}}</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col col-25 pull-right\\\" ng-class=\\\"'severity severity-' + category.outageClass.toUpperCase()\\\">{{category.outageText}}</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col col-25 pull-right monospace\\\" ng-class=\\\"'severity severity-' + category.availabilityClass.toUpperCase()\\\">{{category.availability | number:3}}%</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</span>\\n\\t\\t</span>\\n\\t</ion-content>\\n\\t<ion-footer-bar class=\\\"bar-light\\\">\\n\\t\\t<button class=\\\"button button-compass button-clear pull-right\\\" ng-click=\\\"modals.settings()\\\"><i class=\\\"icon ion-gear-a\\\"></i></button>\\n\\t</ion-footer-bar>\\n</ion-view>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/dashboard/dashboard.html\n ** module id = 198\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/dashboard/dashboard.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 199 */
/*!*************************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/dashboard/server-popover.html ***!
  \*************************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/dashboard/server-popover.html';\nvar html = \"<ion-popover-view class=\\\"fit\\\">\\n\\t<ion-content>\\n\\t\\t<ion-list>\\n\\t\\t\\t<ion-item ng-repeat=\\\"server in servers track by server.name\\\" ng-click=\\\"selectServer(server)\\\">\\n\\t\\t\\t\\t<h2>{{server.name}}</h2>\\n\\t\\t\\t</ion-item>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-popover-view>\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/dashboard/server-popover.html\n ** module id = 199\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/dashboard/server-popover.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 200 */
/*!*****************************************!*\
  !*** ./src/app/nodes/NodeController.js ***!
  \*****************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\t__webpack_require__ (/*! ngCordova */ 9);\n\n\t__webpack_require__(/*! ./NodeService */ 201);\n\t__webpack_require__(/*! ./ResourceService */ 194);\n\n\t__webpack_require__(/*! ../availability/AvailabilityService */ 188);\n\t__webpack_require__(/*! ../events/EventService */ 169);\n\t__webpack_require__(/*! ../outages/OutageService */ 176);\n\n\t__webpack_require__(/*! ../misc/Capabilities */ 203);\n\t__webpack_require__(/*! ../misc/Errors */ 166);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tvar loadingTemplate = __webpack_require__(/*! ngtemplate!html!../misc/loading.html */ 186);\n\tvar nodeDetailTemplate = __webpack_require__(/*! ngtemplate!html!./node-detail.html */ 204);\n\n\tangular.module('opennms.controllers.Node', [\n\t\t'ionic',\n\t\t'ngCordova',\n\t\t'leaflet-directive',\n\t\t'angularLocalStorage',\n\t\t'opennms.services.Availability',\n\t\t'opennms.services.Capabilities',\n\t\t'opennms.services.Errors',\n\t\t'opennms.services.Events',\n\t\t'opennms.services.Nodes',\n\t\t'opennms.services.Outages',\n\t\t'opennms.services.Resources',\n\t\t'opennms.services.Util'\n\t])\n\t.config(function($stateProvider) {\n\t\t$stateProvider\n\t\t.state('node-detail', {\n\t\t\turl: '/nodes/:node',\n\t\t\ttemplateUrl: nodeDetailTemplate,\n\t\t\tcontroller: 'NodeCtrl'\n\t\t});\n\t})\n\t.controller('NodeCtrl', function($q, $scope, $log, $timeout, $window, $cordovaGeolocation, $ionicLoading, $ionicPopup, storage, util, AvailabilityService, Capabilities, Errors, EventService, NodeService, OutageService, ResourceService) {\n\t\t$log.info('NodeCtrl: initializing.');\n\n\t\t$scope.availabilityColor = function(value) {\n\t\t\tif (value >= 99.99) {\n\t\t\t\treturn 'severity severity-NORMAL';\n\t\t\t} else if (value >= 97) {\n\t\t\t\treturn 'severity severity-WARNING';\n\t\t\t} else if (value >= 0) {\n\t\t\t\treturn 'severity severity-CRITICAL';\n\t\t\t}\n\t\t\treturn 'severity severity-INDETERMINATE';\n\t\t};\n\t\t$scope.leaflet = {\n\t\t\tmarkers: {},\n\t\t\tcenter: {},\n\t\t\tdefaults: {}\n\t\t};\n\n\t\tvar timer;\n\n\t\tvar resetModel = function() {\n\t\t\t$scope.loaded = false;\n\t\t\t$scope.node = {};\n\t\t\t$scope.canUpdateGeolocation = false;\n\t\t\t$scope.hasAddress = false;\n\t\t\t$scope.availability = undefined;\n\t\t\t$scope.outages = undefined;\n\t\t\t$scope.events = undefined;\n\t\t\t$scope.alarms = undefined;\n\t\t\t$scope.ipInterfaces = undefined;\n\t\t\t$scope.snmpInterfaces = undefined;\n\t\t\t$scope.leaflet = {\n\t\t\t\tmarkers: {},\n\t\t\t\tcenter: {},\n\t\t\t\tdefaults: {}\n\t\t\t};\n\t\t};\n\n\t\tvar showLoading = function() {\n\t\t\t/*\n\t\t\t$ionicLoading.show({\n\t\t\t\ttemplateUrl: loadingTemplate,\n\t\t\t\thideOnStateChange: true,\n\t\t\t});\n*/\n\t\t};\n\n\t\tvar hideLoading = function() {\n\t\t\t$ionicLoading.hide();\n\t\t};\n\n\t\tvar showNode = function(node) {\n\t\t\t//$log.debug('NodeCtrl.showNode: ' + angular.toJson(node));\n\t\t\t$scope.node = node;\n\t\t\t$scope.updateData();\n\t\t};\n\n\t\t$scope.updateData = function() {\n\t\t\tif (!$scope.node) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$log.debug('NodeCtrl.updateData: getting updated data for node: ' + $scope.node.id);\n\n\t\t\t$scope.address = $scope.node.getAddress();\n\t\t\tif ($scope.address && ($scope.address.city || $scope.address.state || $scope.address.zip)) {\n\t\t\t\t$scope.hasAddress = true;\n\t\t\t}\n\t\t\tif ($scope.address && ($scope.address.hasOwnProperty('latitude') && $scope.address.hasOwnProperty('longitude'))) {\n\t\t\t\t$scope.leaflet.markers = {\n\t\t\t\t\tnode: {\n\t\t\t\t\t\tlat: $scope.address.latitude,\n\t\t\t\t\t\tlng: $scope.address.longitude,\n\t\t\t\t\t\tfocus: true,\n\t\t\t\t\t\tdraggable: false\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t$scope.leaflet.center = {\n\t\t\t\t\tlat: $scope.address.latitude,\n\t\t\t\t\tlng: $scope.address.longitude,\n\t\t\t\t\tzoom: 13\n\t\t\t\t};\n\t\t\t\t$scope.leaflet.defaults = {\n\t\t\t\t\tattributionControl: false,\n\t\t\t\t\tdragging: false,\n\t\t\t\t\tzoomControl: true,\n\t\t\t\t\tscrollWheelZoom: false,\n\t\t\t\t\tdoubleClickZoom: false,\n\t\t\t\t\ttouchZoom: false,\n\t\t\t\t\ttap: true\n\t\t\t\t};\n\t\t\t\t//console.log('leaflet=' + angular.toJson($scope.leaflet));\n\t\t\t}\n\n\t\t\t$scope.canUpdateGeolocation = Capabilities.setLocation();\n\n\t\t\tvar avail = EventService.node($scope.node.id).then(function(results) {\n\t\t\t\t//$log.debug('AvailabilityService got results:',results);\n\t\t\t\t$scope.availability = results;\n\t\t\t\treturn results;\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('AvailabilityService got error:',err);\n\t\t\t\treturn err;\n\t\t\t});\n\t\t\tvar ev = EventService.node($scope.node.id, 5).then(function(results) {\n\t\t\t\t//$log.debug('EventService got results:', results);\n\t\t\t\t$scope.events = results;\n\t\t\t\treturn results;\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('EventService got error:',err);\n\t\t\t\treturn err;\n\t\t\t});\n\t\t\tvar outage = OutageService.node($scope.node.id).then(function(results) {\n\t\t\t\t//$log.debug('OutageService got results:', results);\n\t\t\t\t$scope.outages = results;\n\t\t\t\treturn results;\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('OutageService got error:',err);\n\t\t\t\treturn err;\n\t\t\t});\n\t\t\t$q.all(avail, ev, outage)['finally'](function() {\n\t\t\t\t$scope.loaded = true;\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t});\n\t\t};\n\n\t\t$scope.hasSnmpAttributes = function() {\n\t\t\treturn $scope.node && $scope.node.sysContact ||\n\t\t\t\t$scope.node.sysDescription ||\n\t\t\t\t$scope.node.sysLocation ||\n\t\t\t\t$scope.node.sysName ||\n\t\t\t\t$scope.node.sysObjectId;\n\t\t};\n\n\t\t$scope.submitCoordinates = function() {\n\t\t\t$cordovaGeolocation.getCurrentPosition({\n\t\t\t\ttimeout: 5000,\n\t\t\t\tenableHighAccuracy: true\n\t\t\t}).then(function(position) {\n\t\t\t\tvar longitude = position.coords.longitude.toFixed(6);\n\t\t\t\tvar latitude = position.coords.latitude.toFixed(6);\n\t\t\t\t$ionicPopup.confirm({\n\t\t\t\t\ttitle: 'Update Coordinates?',\n\t\t\t\t\ttemplate: 'Update <strong>' + $scope.node.label + '</strong> to latitude ' + latitude + ' and longitude ' + longitude + '?',\n\t\t\t\t\tcancelType: 'button-default',\n\t\t\t\t\tokType: 'button-compass'\n\t\t\t\t}).then(function(confirmed) {\n\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\t$log.debug('NodeCtrl.submitCoordinates: posting latitude=' + latitude + ', longitude=' + longitude);\n\t\t\t\t\t\tNodeService.setLocation($scope.node, longitude, latitude).then(function() {\n\t\t\t\t\t\t\t$log.debug('NodeCtrl.submitCoordinates: Submitted coordinates.  Refreshing.');\n\t\t\t\t\t\t\t$scope.refresh();\n\t\t\t\t\t\t}, function(err) {\n\t\t\t\t\t\t\t$log.error('NodeCtrl.submitCoordinates: failed to submit coordinates: ' + angular.toJson(err));\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$log.debug('NodeCtrl.submitCoordinates: user canceled.');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('failure:',err);\n\t\t\t});\n\t\t};\n\n\t\t$scope.refresh = function() {\n\t\t\tif ($scope.node.id) {\n\t\t\t\tshowLoading();\n\t\t\t\tNodeService.get($scope.node.id).then(function(n) {\n\t\t\t\t\tshowNode(n);\n\t\t\t\t}, function(err) {\n\t\t\t\t\terr.caller = 'NodeCtrl.refresh';\n\t\t\t\t\t$log.error(err.toString());\n\t\t\t\t}).finally(function() {\n\t\t\t\t\thideLoading();\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t$scope.showGraphButton = Capabilities.graphs();\n\t\t$scope.graphs = function() {\n\t\t\tResourceService.resources($scope.node.id).then(function(res) {\n\t\t\t\t$log.debug('graphs: got res ' + angular.toJson(res));\n\t\t\t});\n\t\t};\n\n\t\tutil.onDirty('alarms', function() {\n\t\t\tif ($scope.node && $scope.node.id) {\n\t\t\t\t$scope.refresh();\n\t\t\t}\n\t\t});\n\t\tutil.onInfoUpdated(function(info) {\n\t\t\t$scope.showGraphButton = Capabilities.graphs();\n\t\t\t$log.debug('$scope.showGraphButton = ' + $scope.showGraphButton);\n\t\t});\n\t\tutil.onSettingsUpdated(function(newSettings, oldSettings, changedSettings) {\n\t\t\tif (timer && changedSettings && changedSettings.refreshInterval) {\n\t\t\t\t$scope.updateData();\n\t\t\t}\n\t\t});\n\n\t\t$scope.$on('$ionicView.beforeEnter', function(ev, info) {\n\t\t\t$log.info('NodeCtrl: entering node view.');\n\t\t\tif (info && info.stateParams && info.stateParams.node) {\n\t\t\t\tvar nodeId = parseInt(info.stateParams.node, 10);\n\t\t\t\tif ($scope.node && $scope.node.id) {\n\t\t\t\t\tif ($scope.node.id !== nodeId) {\n\t\t\t\t\t\t$scope.node = { id: nodeId };\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$scope.node = { id: nodeId };\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$log.error('NodeCtrl: unable to determine node from view.');\n\t\t\t}\n\t\t\tif (info && info.direction === 'forward') {\n\t\t\t\t$scope.refresh();\n\t\t\t}\n\t\t});\n\n\t\t$scope.$on('$ionicView.afterLeave', function(ev, info) {\n\t\t\tif (info.direction === 'forward') {\n\t\t\t\t// we're going to the resources, keep the model in memory\n\t\t\t} else {\n\t\t\t\t$log.debug('NodeCtrl: leaving node view; cleaning up.');\n\t\t\t\tresetModel();\n\t\t\t}\n\t\t});\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/NodeController.js\n ** module id = 200\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/NodeController.js?");

/***/ },
/* 201 */
/*!**************************************!*\
  !*** ./src/app/nodes/NodeService.js ***!
  \**************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tNode = __webpack_require__(/*! ./models/Node */ 202);\n\n\t__webpack_require__(/*! ../misc/Info */ 119);\n\t__webpack_require__(/*! ../misc/Rest */ 121);\n\n\tangular.module('opennms.services.Nodes', [\n\t\t'ionic',\n\t\t'opennms.services.Info',\n\t\t'opennms.services.Rest'\n\t])\n\t.factory('NodeService', function($q, $log, Info, RestService) {\n\t\t$log.info('NodeService: Initializing.');\n\n\t\tvar searchNodes = function(search, limit) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tvar params = {\n\t\t\t\tcomparator: 'ilike',\n\t\t\t\tmatch: 'any',\n\t\t\t\tlabel: '%' + search + '%',\n\t\t\t\t'ipInterface.ipAddress': '%' + search + '%',\n\t\t\t\t'ipInterface.ipHostName': '%' + search + '%'\n\t\t\t};\n\n\t\t\tif (limit) {\n\t\t\t\tparams.limit = limit;\n\t\t\t}\n\n\t\t\tRestService.getXml('/nodes', params).then(function(results) {\n\t\t\t\t/* jshint -W069 */ /* \"better written in dot notation\" */\n\t\t\t\tvar ret = [];\n\t\t\t\tif (results && results.nodes && results.nodes.node) {\n\t\t\t\t\tvar nodes = results.nodes.node;\n\t\t\t\t\tif (!angular.isArray(nodes)) {\n\t\t\t\t\t\tnodes = [nodes];\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i=0, len=nodes.length; i < len; i++) {\n\t\t\t\t\t\tret.push(new Node(nodes[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'NodeService.searchNodes';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar getNode = function(nodeId) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tRestService.getXml('/nodes/' + nodeId).then(function(results) {\n\t\t\t\tvar ret;\n\t\t\t\tif (results && results.node) {\n\t\t\t\t\tret = new Node(results.node);\n\t\t\t\t}\n\t\t\t\tdeferred.resolve(ret);\n\t\t\t}, function(err) {\n\t\t\t\terr.caller = 'NodeService.getNode';\n\t\t\t\tdeferred.reject(err);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar setLocation = function(node, longitude, latitude) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tRestService.put('/nodes/' + node.id + '/assetRecord', {\n\t\t\t\t'geolocation.longitude': longitude,\n\t\t\t\t'geolocation.latitude': latitude\n\t\t\t}).then(function() {\n\t\t\t\tdeferred.resolve(true);\n\t\t\t}, function(err) {\n\t\t\t\tif (err.toString().contains('request was redirected')) {\n\t\t\t\t\tdeferred.resolve(true);\n\t\t\t\t} else if (err.status === 400 || err.status === 0) {\n\t\t\t\t\tdeferred.resolve(true);\n\t\t\t\t} else {\n\t\t\t\t\terr.caller = 'NodeService.setLocation';\n\t\t\t\t\tdeferred.reject(err);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\tvar getNodes = function(params) {\n\t\t\treturn RestService.getXml('/nodes', params).then(function(results) {\n\t\t\t\tvar ret = [];\n\t\t\t\tif (results && results.nodes && results.nodes.node) {\n\t\t\t\t\tvar nodes = results.nodes.node;\n\t\t\t\t\tif (!angular.isArray(nodes)) {\n\t\t\t\t\t\tnodes = [nodes];\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i=0, len=nodes.length; i < len; i++) {\n\t\t\t\t\t\tret.push(new Node(nodes[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t});\n\t\t};\n\n\t\treturn {\n\t\t\tsearch: searchNodes,\n\t\t\tget: getNode,\n\t\t\tnodes: getNodes,\n\t\t\tsetLocation: setLocation\n\t\t};\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/NodeService.js\n ** module id = 201\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/NodeService.js?");

/***/ },
/* 202 */
/*!**************************************!*\
  !*** ./src/app/nodes/models/Node.js ***!
  \**************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("/* jshint -W069 */ /* \"better written in dot notation\" */\n\nvar MonitoredService = __webpack_require__(/*! ./MonitoredService */ 178),\n  moment = __webpack_require__(/*! moment */ 14);\n\n/**\n * @ngdoc object\n * @name Node\n * @param {Object} node a node JSON object\n * @constructor\n */\nfunction Node(node) {\n  'use strict';\n\n  var self = this;\n  var nullSafe = function(str) {\n    if (str && str.trim() !== '') {\n      return str;\n    } else {\n      return undefined;\n    }\n  };\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#id\n   * @propertyOf Node\n   * @returns {number} The unique node ID\n   */\n  self.id = parseInt(node['_id'], 10);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#foreignSource\n   * @propertyOf Node\n   * @returns {string} The node's foreign source\n   */\n  self.foreignSource = nullSafe(node['_foreignSource']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#foreignId\n   * @propertyOf Node\n   * @returns {string} The node's foreignId field\n   */\n  self.foreignId = nullSafe(node['_foreignId']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#label\n   * @propertyOf Node\n   * @returns {string} The node's label\n   */\n  self.label = node['_label'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#type\n   * @propertyOf Node\n   * @returns {string} The node's type\n   */\n  self.type = node['_type'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#labelSource\n   * @propertyOf Node\n   * @returns {string} The source of the node's label\n   */\n  self.labelSource = node['labelSource'];\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#assets\n   * @propertyOf Node\n   * @returns {object} The node's assets\n   */\n  self.assets = node['assetRecord'];\n\n  if (self.assets) {\n    if (!self.isEmpty_(self.assets.lastModifiedDate)) {\n      self.assets.lastModifiedDate = moment(self.assets.lastModifiedDate);\n    }\n    if (!self.isEmpty_(self.assets.id)) {\n      self.assets.id = parseInt(self.assets.id, 10);\n    }\n    if (!self.isEmpty_(self.assets.latitude)) {\n      self.assets.latitude = parseFloat(self.assets.latitude);\n    }\n    if (!self.isEmpty_(self.assets.longitude)) {\n      self.assets.longitude = parseFloat(self.assets.longitude);\n    }\n    if (!self.isEmpty_(self.assets.node)) {\n      self.assets.node = parseInt(self.assets.node, 10);\n    }\n    if (self.assets.category === 'Unspecified') {\n      delete self.assets.category;\n    }\n  }\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#categories\n   * @propertyOf Node\n   * @returns {array} The node's list of categories\n   */\n  self.categories = node['categories'];\n  if (self.categories && !angular.isArray(self.categories)) {\n    self.categories = [self.categories];\n  }\n  if (self.categories) {\n    self.categories = self.categories.map(function(cat) {\n      return {\n        id: parseInt(cat._id, 10),\n        name: cat._name\n      };\n    });\n  }\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#createTime\n   * @propertyOf Node\n   * @returns {moment} The node's creation time\n   */\n  self.createTime = moment(node['createTime']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#lastCapsdPoll\n   * @propertyOf Node\n   * @returns {string} The last time the node was scanned by Capsd\n   */\n  self.lastCapsdPoll = moment(node['lastCapsdPoll']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#sysContact\n   * @propertyOf Node\n   * @returns {string} The node's sysContact field\n   */\n  self.sysContact = nullSafe(node['sysContact']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#sysDescription\n   * @propertyOf Node\n   * @returns {string} The node's sysDescription field\n   */\n  self.sysDescription = nullSafe(node['sysDescription']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#sysLocation\n   * @propertyOf Node\n   * @returns {string} The node's sysLocation field\n   */\n  self.sysLocation = nullSafe(node['sysLocation']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#sysName\n   * @propertyOf Node\n   * @returns {string} The node's sysName field\n   */\n  self.sysName = nullSafe(node['sysName']);\n\n  /**\n   * @description\n   * @ngdoc property\n   * @name Node#sysObjectId\n   * @propertyOf Node\n   * @returns {string} The node's sysObjectId field\n   */\n  self.sysObjectId = nullSafe(node['sysObjectId']);\n}\n\nNode.prototype.getDisplayId = function() {\n  'use strict';\n  var self = this;\n  var ret;\n\n  if (self.foreignId) {\n    if (self.foreignSource) {\n      ret = self.foreignSource + '/';\n    }\n    ret += self.foreignId;\n  }\n  return ret;\n};\n\nNode.prototype.isEmpty_ = function(str) {\n  'use strict';\n  if (str && str !== '') {\n    return false;\n  } else {\n    return true;\n  }\n};\n\nNode.prototype.getAddress = function() {\n  'use strict';\n  var assets, prop, ret,\n    self = this;\n\n  if (this.assets) {\n    assets = this.assets;\n    if (!self.isEmpty_(assets.city) && !self.isEmpty_(assets.zip) || !self.isEmpty_(assets.latitude) && !self.isEmpty_(assets.longitude)) {\n      ret = {\n        address1: undefined,\n        address2: undefined,\n        city: undefined,\n        state: undefined,\n        zip: undefined,\n        country: undefined,\n        longitude: undefined,\n        latitude: undefined\n      };\n      for (prop in ret) {\n        if (self.isEmpty_(assets[prop])) {\n          delete ret[prop];\n        } else {\n          ret[prop] = assets[prop];\n        }\n      }\n      return ret;\n    }\n  }\n  return undefined;\n};\n\nmodule.exports = Node;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/models/Node.js\n ** module id = 202\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/models/Node.js?");

/***/ },
/* 203 */
/*!**************************************!*\
  !*** ./src/app/misc/Capabilities.js ***!
  \**************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tVersionCompare = __webpack_require__(/*! version_compare */ 120);\n\n\t__webpack_require__(/*! ./Info */ 119);\n\t__webpack_require__(/*! ./util */ 129);\n\n\tangular.module('opennms.services.Capabilities', [\n\t\t'ionic',\n\t\t'opennms.services.Info',\n\t\t'opennms.services.Util'\n\t])\n\t.factory('Capabilities', function($log, Info, util) {\n\t\t$log.info('Capabilities: Initializing.');\n\n\t\tvar hasGraphs = function() {\n\t\t\tif (Info.isMeridian()) {\n\t\t\t\treturn Info.validateVersion('2016.1.0');\n\t\t\t} else {\n\t\t\t\treturn Info.validateVersion('16.0.0');\n\t\t\t}\n\t\t};\n\n\t\tvar hasOutageSummaries = function() {\n\t\t\treturn Info.validateVersion('14.0.3');\n\t\t};\n\n\t\tvar canSetLocation = function() {\n\t\t\treturn Info.validateVersion('15.0.2');\n\t\t};\n\n\t\treturn {\n\t\t\tgraphs: hasGraphs,\n\t\t\toutageSummaries: hasOutageSummaries,\n\t\t\tsetLocation: canSetLocation\n\t\t};\n\t})\n\t;\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/misc/Capabilities.js\n ** module id = 203\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/misc/Capabilities.js?");

/***/ },
/* 204 */
/*!******************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/node-detail.html ***!
  \******************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/nodes/node-detail.html';\nvar html = \"<ion-view view-title=\\\"{{node.label}}\\\" class=\\\"node-detail\\\">\\n\\t<ion-nav-bar class=\\\"bar-light\\\" align-title=\\\"center\\\">\\n\\t\\t<ion-nav-back-button class=\\\"button-compass button-clear\\\"></ion-nav-back-button>\\n\\t\\t<!-- <h1 class=\\\"title\\\">{{node.label}}</h1> -->\\n\\t\\t<ion-nav-buttons side=\\\"secondary\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" nav-direction=\\\"forward\\\" ui-sref=\\\"node-resources({node: node.id})\\\" ng-if=\\\"showGraphButton\\\"><i class=\\\"icon ion-stats-bars\\\"></i></button>\\n\\t\\t</ion-nav-buttons>\\n\\t</ion-nav-bar>\\n\\t<ion-content overflow-scroll=\\\"true\\\">\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"refresh()\\\"></ion-refresher>\\n\\t\\t<ion-list>\\n\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\tNode Details\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">ID:</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{node.id}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\" ng-if=\\\"node.foreignSource\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">Foreign Source:</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{node.foreignSource}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item class=\\\"row\\\" ng-if=\\\"node.foreignId\\\">\\n\\t\\t\\t\\t<div class=\\\"col col-33\\\">Foreign ID:</div>\\n\\t\\t\\t\\t<div class=\\\"col\\\">{{node.foreignId}}</div>\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<span ng-if=\\\"!loaded\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tSNMP Attributes\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\"><div class=\\\"col\\\"><ion-spinner></ion-spinner></div></ion-item>\\n\\t\\t\\t\\t<!--\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\"><div class=\\\"col\\\">&nbsp;</div></ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\"><div class=\\\"col\\\">&nbsp;</div></ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\"><div class=\\\"col\\\">&nbsp;</div></ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\"><div class=\\\"col\\\">&nbsp;</div></ion-item>\\n\\t\\t\\t\\t-->\\n\\t\\t\\t</span>\\n\\t\\t\\t<span ng-if=\\\"loaded &amp;&amp; hasSnmpAttributes()\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tSNMP Attributes\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\" ng-if=\\\"node.sysName\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-33\\\">Name</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{node.sysName}}</div>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row \\\" ng-if=\\\"node.sysObjectId\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-33\\\">sysObjectID</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{node.sysObjectId}}</div>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\" ng-if=\\\"node.sysLocation\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-33\\\">Location</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{node.sysLocation}}</div>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\" ng-if=\\\"node.sysContact\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-33\\\">Contact</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col\\\" ng-bind=\\\"node.sysContact\\\"></div>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"row item-text-wrap\\\" ng-if=\\\"node.sysDescription\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"col col-33\\\">Description</div>\\n\\t\\t\\t\\t\\t<div class=\\\"col\\\">{{node.sysDescription}}</div>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<span ng-if=\\\"address || canUpdateGeolocation\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tLocation\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap\\\">\\n\\t\\t\\t\\t\\t<div ng-if=\\\"address &amp;&amp; address.address1\\\">{{address.address1}}</div>\\n\\t\\t\\t\\t\\t<div ng-if=\\\"address &amp;&amp; address.address2\\\">{{address.address2}}</div>\\n\\t\\t\\t\\t\\t<div ng-if=\\\"hasAddress\\\">\\n\\t\\t\\t\\t\\t\\t<span ng-if=\\\"address.city\\\">{{address.city}},</span>\\n\\t\\t\\t\\t\\t\\t<span ng-if=\\\"address.state\\\">{{address.state}}</span>\\n\\t\\t\\t\\t\\t\\t<span ng-if=\\\"address.zip\\\">{{address.zip}}</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div ng-if=\\\"address &amp;&amp; address.country\\\">{{address.country}}</div>\\n\\t\\t\\t\\t\\t<span ng-if=\\\"address.longitude &amp;&amp; address.latitude\\\">\\n\\t\\t\\t\\t\\t\\t<br ng-if=\\\"hasAddress\\\" />\\n\\t\\t\\t\\t\\t\\t<leaflet width=\\\"100%\\\" height=\\\"400px\\\" defaults=\\\"leaflet.defaults\\\" center=\\\"leaflet.center\\\" markers=\\\"leaflet.markers\\\"></leaflet>\\n\\t\\t\\t\\t\\t\\t<br />\\n\\t\\t\\t\\t\\t\\t<div style=\\\"text-align: center\\\">\\n\\t\\t\\t\\t\\t\\t\\tLat: {{address.latitude}},\\n\\t\\t\\t\\t\\t\\t\\tLon: {{address.longitude}}\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t<button class=\\\"button button-block button-compass\\\" ng-click=\\\"submitCoordinates()\\\" ng-if=\\\"canUpdateGeolocation\\\">Set Coordinates to Current Location</button>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<span ng-if=\\\"availability &amp;&amp; availability.length > 0\\\" class=\\\"availability\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tAvailability (Last 24 Hours)\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap no-top\\\" style=\\\"padding: 0\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"row no-bottom\\\" ng-class=\\\"availabilityColor(availability.availability)\\\">\\n\\t\\t\\t\\t\\t\\t<div class=\\\"col col-75\\\">Node Availability</div>\\n\\t\\t\\t\\t\\t\\t<div class=\\\"monospace pull-right col\\\">{{availability.availability | number:2}}%</div>\\n\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t<span ng-repeat=\\\"iface in availability.ipinterfaces track by iface.id\\\" class=\\\"ifaces\\\">\\n\\t\\t\\t\\t\\t\\t<span class=\\\"row\\\" ng-class=\\\"availabilityColor(iface.availability) + ' ' + ($index === (iface.availability.length-1)? 'no-bottom':'')\\\">\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-75 shift-1\\\">{{iface.address | ip}}</div>\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"monospace pull-right col\\\">{{iface.availability | number:2}}%</div>\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span class=\\\"row\\\" ng-repeat=\\\"svc in iface.services track by svc.id\\\" ng-class=\\\"availabilityColor(svc.availability) + ' ' + ($index === (iface.services.length-1)? 'no-bottom':'')\\\">\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"col col-75 shift-2\\\">{{svc.name}}</div>\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"monospace pull-right col\\\">{{svc.availability | number:2}}%</div>\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<span ng-if=\\\"node.categories &amp;&amp; node.categories.length > 0\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tSurveillance Categories\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"item-text-wrap\\\" ng-repeat=\\\"category in node.categories track by category.id\\\">\\n\\t\\t\\t\\t\\t{{category.name}}\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<span class=\\\"events\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tRecent Events\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"angular.isUndefined(events)\\\">\\n\\t\\t\\t\\t\\t<ion-spinner></ion-spinner> Loading...\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"events &amp;&amp; events.length === 0\\\">\\n\\t\\t\\t\\t\\tNo recent events.\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-class=\\\"'item-text-wrap item-icon-right item-remove-animate severity-' + event.severity\\\" ng-repeat=\\\"event in events track by event.id\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"item-note\\\">{{event.time.fromNow()}}</span>\\n\\t\\t\\t\\t\\t<h2>{{event.title}}</h2>\\n\\t\\t\\t\\t\\t<span ng-bind-html=\\\"event.description\\\"></span>\\n\\t\\t\\t\\t\\t<i ng-class=\\\"'icon severity severity-' + event.severity + ' ' + util.icon(event.severity)\\\" title=\\\"{{event.severity}}\\\"></i>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<span class=\\\"outages\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tCurrent Outages\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"angular.isUndefined(outages)\\\">\\n\\t\\t\\t\\t\\t<ion-spinner></ion-spinner> Loading...\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"outages &amp;&amp; outages.length === 0\\\">\\n\\t\\t\\t\\t\\tNo recent outages.\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-class=\\\"'item-text-wrap item-icon-right item-remove-animate severity severity-' + outage.serviceLostEvent.severity\\\" ng-repeat=\\\"outage in outages track by outage.id\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"item-note\\\">{{outage.ifLostService.fromNow()}}</span>\\n\\t\\t\\t\\t\\t<h2>{{outage.monitoredService.serviceName}} on {{outage.ipAddress}}</h2>\\n\\t\\t\\t\\t\\t<span ng-bind-html=\\\"outage.serviceLostEvent.description\\\"></span>\\n\\t\\t\\t\\t\\t<i ng-class=\\\"'icon severity severity-' + outage.serviceLostEvent.severity + ' ' + util.icon(outage.serviceLostEvent.severity)\\\" title=\\\"{{outage.serviceLostEvent.severity}}\\\"></i>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-view>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/node-detail.html\n ** module id = 204\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/node-detail.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 205 */
/*!******************************************!*\
  !*** ./src/app/nodes/NodesController.js ***!
  \******************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\t__webpack_require__(/*! ./NodeService */ 201);\n\n\t__webpack_require__(/*! ../misc/Errors */ 166);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tvar nodesTemplate = __webpack_require__(/*! ngtemplate!html!./nodes.html */ 206);\n\tvar loadingTemplate = __webpack_require__(/*! ngtemplate!html!../misc/loading.html */ 186);\n\n\tangular.module('opennms.controllers.Nodes', [\n\t\t'ionic',\n\t\t'angularLocalStorage',\n\t\t'opennms.services.Errors',\n\t\t'opennms.services.Nodes',\n\t\t'opennms.services.Util'\n\t])\n\t.config(function($stateProvider) {\n\t\t$stateProvider\n\t\t.state('nodes', {\n\t\t\turl: '/nodes',\n\t\t\ttemplateUrl: nodesTemplate,\n\t\t\tcontroller: 'NodesCtrl'\n\t\t});\n\t})\n\t.controller('NodesCtrl', function($q, $scope, $log, $timeout, $window, $state, $ionicLoading, storage, util, Errors, NodeService) {\n\t\t$log.info('NodesCtrl: initializing.');\n\n\t\t$scope.searching = false;\n\t\t$scope.util  = util;\n\t\t$scope.searchString = storage.get('opennms.nodes.search-string') || '';\n\t\t$scope.nodes = [];\n\t\tvar emptyPromise = $q.when();\n\t\tvar lastSearch = emptyPromise;\n\n\t\t$scope.updateSearch = function(searchFor) {\n\t\t\t$scope.searching = true;\n\t\t\tvar searchPromise = NodeService.search(searchFor);\n\t\t\tsearchPromise['finally'](function() {\n\t\t\t\t$ionicLoading.hide();\n\t\t\t\t$scope.searching = false;\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t});\n\n\t\t\tsearchPromise.then(function(nodes) {\n\t\t\t\tErrors.clear('nodes');\n\t\t\t\t$scope.error = false;\n\t\t\t\t//$log.debug('Got nodes:',nodes);\n\t\t\t\t$scope.searching = false;\n\t\t\t\t$scope.nodes = nodes;\n\t\t\t\tif (nodes.length === 20 && angular.isUndefined(searchFor) || searchFor.trim() === '') {\n\t\t\t\t\t$scope.nodes.push({id:'more'});\n\t\t\t\t}\n\t\t\t}, function(err) {\n\t\t\t\tErrors.set('nodes', err);\n\t\t\t\t$scope.error = true;\n\t\t\t\t$scope.nodes = [];\n\t\t\t});\n\n\t\t\treturn searchPromise;\n\t\t};\n\n\t\tvar _delayedSearchTimeout;\n\t\tvar delayedSearch = function() {\n\t\t\tif (_delayedSearchTimeout) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t_delayedSearchTimeout = $timeout(function() {\n\t\t\t\t_delayedSearchTimeout = undefined;\n\t\t\t\tlastSearch['finally'](function() {\n\t\t\t\t\tlastSearch = $scope.updateSearch($scope.searchString);\n\t\t\t\t});\n\t\t\t}, 200);\n\t\t};\n\n\t\t$scope.viewNode = function(node) {\n\t\t\tutil.hideKeyboard();\n\t\t\t$state.go('node-detail', {node: node.id});\n\t\t};\n\n\t\t$scope.refreshData = function() {\n\t\t\t$ionicLoading.show({\n\t\t\t\ttemplateUrl: loadingTemplate,\n\t\t\t\thideOnStateChange: true\n\t\t\t});\n\t\t\t$scope.updateSearch($scope.searchString);\n\t\t};\n\n\t\t$scope.$watch('searchString', function(newValue) {\n\t\t\tstorage.set('opennms.nodes.search-string', newValue);\n\t\t\tdelayedSearch();\n\t\t});\n\n\t\tutil.onSettingsUpdated($scope.refreshData);\n\n\t\t$scope.$on('ionicView.beforeEnter', function() {\n\t\t\t$scope.refreshData();\n\t\t});\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/NodesController.js\n ** module id = 205\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/NodesController.js?");

/***/ },
/* 206 */
/*!************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/nodes.html ***!
  \************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/nodes/nodes.html';\nvar html = \"<ion-view view-title=\\\"Nodes\\\" class=\\\"nodes\\\">\\n\\t<ion-nav-bar class=\\\"bar-light\\\" align-title=\\\"center\\\">\\n\\t\\t<ion-nav-back-button class=\\\"button-compass button-clear\\\"></ion-nav-back-button>\\n\\t\\t<!--\\n\\t\\t<ion-nav-buttons side=\\\"left\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"util.dashboard('back')\\\"><i class=\\\"icon ion-ios-arrow-left\\\"> Dashboard</i></button>\\n\\t\\t</ion-nav-buttons>\\n\\t\\t-->\\n\\t\\t<ion-nav-buttons side=\\\"right\\\">\\n\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-show=\\\"searching\\\"><ion-spinner></ion-spinner></button>\\n\\t\\t</ion-nav-buttons>\\n\\t</ion-nav-bar>\\n\\t<ion-header-bar class=\\\"bar-subheader item-input-inset\\\">\\n\\t\\t<label class=\\\"item-input-wrapper\\\">\\n\\t\\t\\t<i class=\\\"icon ion-ios-search placeholder-icon\\\"></i>\\n\\t\\t\\t<input type=\\\"search\\\" placeholder=\\\"Search\\\" ng-model=\\\"searchString\\\">\\n\\t\\t</label>\\n\\t\\t<button class=\\\"button button-clear\\\" ng-click=\\\"searchString = ''\\\">Cancel</button>\\n\\t</ion-header-bar>\\n\\t<ion-content delegate-handle=\\\"nodes-scroll\\\" scroll=\\\"true\\\" overflow-scroll=\\\"false\\\">\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"updateSearch(searchString)\\\"></ion-refresher>\\n\\t\\t<ion-list>\\n\\t\\t\\t<ion-item ng-if=\\\"error\\\" class=\\\"error\\\">\\n\\t\\t\\t\\tError retrieving nodes.\\n\\t\\t\\t</ion-item>\\n\\t\\t\\t<ion-item ng-repeat=\\\"node in nodes track by node.id\\\" ui-sref=\\\"node-detail({node:node.id})\\\" nav-direction=\\\"forward\\\" class=\\\"item-text-wrap\\\">\\n\\t\\t\\t\\t<span ng-switch=\\\"node.id === 'more'\\\">\\n\\t\\t\\t\\t\\t<span ng-switch-when=\\\"true\\\">\\n\\t\\t\\t\\t\\t\\t'Search' for more...\\n\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t<span ng-switch-default>\\n\\t\\t\\t\\t\\t\\t<span class=\\\"item-note\\\">{{node.id}}</span>\\n\\t\\t\\t\\t\\t\\t<span ng-if=\\\"node.foreignId\\\">\\n\\t\\t\\t\\t\\t\\t\\t{{node.label}}\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"node-display-id\\\">{{node.getDisplayId()}}</div>\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span ng-if=\\\"!node.foreignId\\\">\\n\\t\\t\\t\\t\\t\\t\\t{{node.label}}\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t</span>\\n\\t\\t\\t</ion-item>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-view>\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/nodes.html\n ** module id = 206\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/nodes.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 207 */
/*!*********************************************!*\
  !*** ./src/app/nodes/ResourceController.js ***!
  \*********************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tmoment = __webpack_require__(/*! moment */ 14),\n\t\tBackshift = __webpack_require__(/*! backshift/dist/backshift.onms */ 195),\n\t\t$ = __webpack_require__(/*! jquery */ 5);\n\n\t__webpack_require__(/*! ./NodeService */ 201);\n\t__webpack_require__(/*! ./ResourceService */ 194);\n\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\tvar nodeResourceTemplate = __webpack_require__(/*! ngtemplate!html!./node-resource.html */ 208);\n\n\tangular.module('opennms.controllers.NodeResource', [\n\t\t'ionic',\n\t\t'angularLocalStorage',\n\t\t'opennms.services.Nodes',\n\t\t'opennms.services.Resources',\n\t\t'opennms.services.Settings' // for default-graph-min-range\n\t])\n\t.config(function($stateProvider) {\n\t\t$stateProvider\n\t\t.state('node-resource', {\n\t\t\turl: '/nodes/:node/resource/:resource',\n\t\t\ttemplateUrl: nodeResourceTemplate,\n\t\t\tcontroller: 'NodeResourceCtrl'\n\t\t});\n\t})\n\t.controller('NodeResourceCtrl', function($q, $scope, $injector, $log, $timeout, $ionicScrollDelegate, $window, NodeService, ResourceService) {\n\t\t$log.info('NodeResourceCtrl: initializing.');\n\n\t\tvar defaultRange = $injector.get('default-graph-range');\n\n\t\tvar findElementById = function(id) {\n\t\t\tvar elm, scrollEl, position = 0;\n\t\t\telm = document.getElementById(id);\n\t\t\tif (elm) {\n\t\t\t\t\tscrollEl = angular.element(elm);\n\t\t\t\t\twhile (scrollEl) {\n\t\t\t\t\t\t\tif (scrollEl.hasClass('scroll-content')) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar offsetTop = scrollEl[0].offsetTop,\n\t\t\t\t\t\t\t\t\tscrollTop = scrollEl[0].scrollTop,\n\t\t\t\t\t\t\t\t\tclientTop = scrollEl[0].clientTop;\n\t\t\t\t\t\t\tposition += offsetTop - scrollTop + clientTop;\n\t\t\t\t\t\t\tscrollEl = scrollEl.parent();\n\t\t\t\t\t}\n\t\t\t\t\t$log.debug('offset='+position);\n\t\t\t\t\tif (position < 10) {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t\treturn position;\n\t\t\t} else {\n\t\t\t\t\t$log.error('can\\'t find element ' + id);\n\t\t\t\t\treturn 0;\n\t\t\t}\n\t\t};\n\n\t\t$scope.favorites = {};\n\t\t$scope.range = {\n\t\t};\n\t\t$scope.range.end = new Date();\n\t\t$scope.range.start = new Date($scope.range.end.getTime() - defaultRange);\n\n\t\t$scope.getId = function(graph) {\n\t\t\treturn 'graph-' + encodeURIComponent(graph.name);\n\t\t};\n\n\t\t$scope.display = {};\n\n\t\t$scope.calculateHeight = function(graph) {\n\t\t\t$scope.shouldDisplay(graph);\n\t\t\treturn $scope.width + 80;\n\t\t};\n\n\t\t$scope.shouldDisplay = function(graph) {\n\t\t\tif (graph && graph.name) {\n\t\t\t\tvar id = 'graph-' + graph.name;\n\t\t\t\tvar el = $(document.getElementById(id));\n\t\t\t\tvar visible = el.visible(true);\n\t\t\t\tif ($scope.display[id] !== visible) {\n\t\t\t\t\t$log.debug(graph.name + ': ' + $scope.display[id] + ' -> ' + visible);\n\t\t\t\t}\n\t\t\t\t$scope.display[id] = visible;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\t\t$scope.refresh = function() {\n\t\t\t$log.debug('refreshing: ' + $scope.resourceId);\n\t\t\tif ($scope.nodeId) {\n\t\t\t\tNodeService.get($scope.nodeId).then(function(node) {\n\t\t\t\t\t$scope.node = node;\n\t\t\t\t});\n\t\t\t}\n\t\t\tif ($scope.resourceId) {\n\t\t\t\tResourceService.favorites().then(function(favorites) {\n\t\t\t\t\tvar favorite,\n\t\t\t\t\t\tscopeFavorites = {};\n\n\t\t\t\t\tfor (var i=0, len=favorites.length; i < len; i++) {\n\t\t\t\t\t\tfavorite = favorites[i];\n\t\t\t\t\t\tif (favorite.resourceId === $scope.resourceId) {\n\t\t\t\t\t\t\tscopeFavorites[favorite.graphName] = favorite;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$log.debug('got favorites: ' + angular.toJson(scopeFavorites));\n\t\t\t\t\t$scope.favorites = scopeFavorites;\n\t\t\t\t});\n\t\t\t\tResourceService.graphNames($scope.resourceId).then(function(graphs) {\n\t\t\t\t\tvar promises = [];\n\t\t\t\t\tfor (var i=0, len=graphs.length; i < len; i++) {\n\t\t\t\t\t\tpromises.push(ResourceService.graph(graphs[i]));\n\t\t\t\t\t}\n\t\t\t\t\t$q.all(promises).then(function(graphDefs) {\n\t\t\t\t\t\t$scope.graphDefinitions = graphDefs;\n\t\t\t\t\t\tif (graphDefs && graphDefs.length && graphDefs.length > 0) {\n\t\t\t\t\t\t\t$scope.shown = graphDefs[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tResourceService.resource($scope.resourceId).then(function(ret) {\n\t\t\t\t\tif (ret.children && ret.children.resource) {\n\t\t\t\t\t\t$scope.children = ResourceService.withDividers(ret.children.resource);\n\t\t\t\t\t}\n\t\t\t\t\t$scope.resource = ret;\n\t\t\t\t}).finally(function() {\n\t\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t}\n\t\t};\n\n\t\t$scope.isFavorite = function(graphName) {\n\t\t\treturn $scope.favorites && $scope.favorites[graphName];\n\t\t};\n\n\t\t$scope.toggleFavorite = function(ev, graph) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t\tif ($scope.isFavorite(graph.name)) {\n\t\t\t\tResourceService.unfavorite($scope.resourceId, graph.name).then(function(fav) {\n\t\t\t\t\tdelete $scope.favorites[graph.name];\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tResourceService.favorite($scope.resourceId, graph.name, $scope.nodeId, $scope.node.label).then(function(fav) {\n\t\t\t\t\t$scope.favorites[graph.name] = fav;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t$scope.isOpen = function(graphName) {\n\t\t\treturn $scope.shown && $scope.shown.name && graphName && $scope.shown.name === graphName;\n\t\t};\n\n\t\t$scope.toggleOpen = function(graph) {\n\t\t\tif ($scope.shown && $scope.shown.name && graph && graph.name && $scope.shown.name === graph.name) {\n\t\t\t\t//$log.debug('hiding: ' + angular.toJson(graph));\n\t\t\t\tdelete $scope.shown;\n\t\t\t} else {\n\t\t\t\t//$log.debug('showing: ' + angular.toJson(graph));\n\t\t\t\t$scope.shown = graph;\n\t\t\t\t$timeout(function() {\n\t\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t\tvar position = findElementById('graph-' + graph.name);\n\t\t\t\t\t$log.debug('Found element position: ' + position);\n\t\t\t\t\t$ionicScrollDelegate.$getByHandle('node-resources-scroll').scrollTo(0, position, true);\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t};\n\n\t\tvar resetModel = function() {\n\t\t\t$scope.graphDefinitions = [];\n\t\t\t$scope.children = [];\n\t\t\t$scope.node = {};\n\t\t};\n\n\t\t$scope.$on('$ionicView.beforeEnter', function(ev, info) {\n\t\t\t$log.info('NodeResourceCtrl: entering node view.');\n\t\t\t//$log.debug('info=' + angular.toJson(info));\n\t\t\tif (info && info.stateParams) {\n\t\t\t\tif (info.stateParams.node) {\n\t\t\t\t\tvar nodeId = parseInt(info.stateParams.node, 10);\n\t\t\t\t\t$scope.nodeId = nodeId;\n\t\t\t\t}\n\t\t\t\tif (info.stateParams.resource) {\n\t\t\t\t\t$scope.resourceId = info.stateParams.resource;\n\t\t\t\t}\n\t\t\t\t//$log.debug('node id = ' + $scope.nodeId + ', resource id = ' + $scope.resourceId);\n\t\t\t} else {\n\t\t\t\t$log.error('NodeResourcesCtrl: unable to determine node or resource from view.');\n\t\t\t}\n\t\t\tif (info && info.direction === 'forward') {\n\t\t\t\t$scope.refresh();\n\t\t\t}\n\t\t});\n\n\t\t$scope.$on('$ionicView.afterLeave', function(ev, info) {\n\t\t\t$log.debug('info=' + angular.toJson(info));\n\t\t\tif (info && info.direction === 'forward') {\n\t\t\t\t// we're going deeper, keep the model in memory\n\t\t\t} else if (info) {\n\t\t\t\t$log.debug('NodeResourceCtrl: leaving node resource view; cleaning up.');\n\t\t\t\tresetModel();\n\t\t\t}\n\t\t});\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/ResourceController.js\n ** module id = 207\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/ResourceController.js?");

/***/ },
/* 208 */
/*!********************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/node-resource.html ***!
  \********************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/nodes/node-resource.html';\nvar html = \"<ion-view view-title=\\\"{{node.label}}\\\" class=\\\"node-resource\\\">\\n\\t<ion-nav-bar class=\\\"bar-light\\\" align-title=\\\"center\\\">\\n\\t\\t<ion-nav-back-button class=\\\"button-compass button-clear\\\"></ion-nav-back-button>\\n\\t</ion-nav-bar>\\n\\t<ion-content delegate-handle=\\\"node-resources-scroll\\\" scroll=\\\"true\\\" overflow-scroll=\\\"false\\\">\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"refresh()\\\"></ion-refresher>\\n\\t\\t<ion-list>\\n\\t\\t\\t<ion-item class=\\\"item-text-wrap\\\"><h3 class=\\\"title compass\\\">{{resource.label? (resource.label + ' (1-Hour)'):''}}</h3></ion-item>\\n\\t\\t\\t<span ng-if=\\\"children &amp;&amp; children.length &gt; 0\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tSub-Resources\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<span ng-repeat=\\\"resource in children track by resource.id\\\">\\n\\t\\t\\t\\t\\t<ion-item ng-if=\\\"resource.isDivider\\\" class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\t\\t{{resource.id}}\\n\\t\\t\\t\\t\\t\\tdivider\\n\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t\\t<ion-item ng-if=\\\"!resource.isDivider\\\" class=\\\"item-text-wrap\\\" ui-sref=\\\"node-resource({node:id, resource:resource.id})\\\">\\n\\t\\t\\t\\t\\t\\t{{resource.label}}\\n\\t\\t\\t\\t\\t\\t{{resource}}\\n\\t\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t<ion-item class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\tGraphs\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t\\t<span class=\\\"graphs\\\" collection-repeat=\\\"graph in graphDefinitions track by graph.name\\\" item-height=\\\"calculateHeight()\\\" item-width=\\\"100%\\\" id=\\\"graph-{{graph.name}}\\\">\\n\\t\\t\\t\\t<ion-item class=\\\"item item-icon-right item-divider item-compass\\\" ng-click=\\\"toggleFavorite($event, graph)\\\">\\n\\t\\t\\t\\t\\t{{graph.title}}\\n\\t\\t\\t\\t\\t<i ng-class=\\\"'icon ' + (isFavorite(graph.name)? 'ion-ios-star':'ion-ios-star-outline')\\\"></i>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item class=\\\"item item-accordion item-complex graph\\\">\\n\\t\\t\\t\\t\\t<onms-graph graph-def=\\\"graph\\\" resource-id=\\\"resource.id\\\" range=\\\"range\\\" display=\\\"display['graph-'+graph.name]\\\" ng-attr-width=\\\"width\\\" ng-attr-height=\\\"width\\\"></onms-graph>\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-view>\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/node-resource.html\n ** module id = 208\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/node-resource.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 209 */
/*!**********************************************!*\
  !*** ./src/app/nodes/ResourcesController.js ***!
  \**********************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2);\n\n\t__webpack_require__(/*! ./ResourceService */ 194);\n\n\tvar nodeResourcesTemplate = __webpack_require__(/*! ngtemplate!html!./node-resources.html */ 210);\n\n\tangular.module('opennms.controllers.NodeResources', [\n\t\t'ionic',\n\t\t'angularLocalStorage',\n\t\t'opennms.services.Resources'\n\t])\n\t.config(function($stateProvider) {\n\t\t$stateProvider\n\t\t.state('node-resources', {\n\t\t\turl: '/nodes/:node/resources',\n\t\t\ttemplateUrl: nodeResourcesTemplate,\n\t\t\tcontroller: 'NodeResourcesCtrl'\n\t\t});\n\t})\n\t.controller('NodeResourcesCtrl', function($q, $scope, $log, ResourceService) {\n\t\t$log.info('NodeResourcesCtrl: initializing.');\n\n\t\tvar sortFunction = function(a,b) {\n\t\t\t//$log.debug('sortFunction: a=' + angular.toJson(a));\n\t\t\t//$log.debug('sortFunction: b=' + angular.toJson(b));\n\t\t\tif (a.typeLabel) {\n\t\t\t\tif (b.typeLabel) {\n\t\t\t\t\treturn a.typeLabel.localeCompare(b.typeLabel);\n\t\t\t\t} else {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (b.typeLabel) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t$scope.refresh = function() {\n\t\t\t$log.info('NodeResources.refresh: refreshing: ' + $scope.nodeId);\n\t\t\tif ($scope.nodeId) {\n\t\t\t\tResourceService.resources($scope.nodeId).then(function(ret) {\n\t\t\t\t\t$scope.resourceLabel = ret.label;\n\t\t\t\t\tvar children = ret.children;\n\t\t\t\t\tchildren.sort(sortFunction);\n\t\t\t\t\t$scope.resources = ResourceService.withDividers(children);\n\t\t\t\t}, function(err) {\n\t\t\t\t\t$log.error('NodeResources.refresh: failed: ' + angular.toJson(err));\n\t\t\t\t\treturn $q.reject(err);\n\t\t\t\t}).finally(function() {\n\t\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$log.debug('NodeResources.refresh: no nodeId set.');\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t}\n\t\t};\n\n\t\tvar resetModel = function() {\n\t\t\t$scope.resources = [];\n\t\t};\n\n\t\t$scope.$on('$ionicView.beforeEnter', function(ev, info) {\n\t\t\t$log.info('NodeResourcesCtrl: entering node view.');\n\t\t\tif (info && info.stateParams && info.stateParams.node) {\n\t\t\t\tvar nodeId = parseInt(info.stateParams.node, 10);\n\t\t\t\t$scope.nodeId = nodeId;\n\t\t\t} else {\n\t\t\t\t$log.error('NodeResourcesCtrl: unable to determine node from view.');\n\t\t\t}\n\t\t\tif (info && info.direction === 'forward') {\n\t\t\t\t$scope.refresh();\n\t\t\t}\n\t\t});\n\n\t\t$scope.$on('$ionicView.afterLeave', function(ev, info) {\n\t\t\tif (info && info.direction === 'forward') {\n\t\t\t\t// we're going deeper, keep the model in memory\n\t\t\t} else if (info) {\n\t\t\t\t$log.debug('NodeResourcesCtrl: leaving node view; cleaning up.');\n\t\t\t\tresetModel();\n\t\t\t}\n\t\t});\n\t});\n\n}());\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/nodes/ResourcesController.js\n ** module id = 209\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/ResourcesController.js?");

/***/ },
/* 210 */
/*!*********************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/node-resources.html ***!
  \*********************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/nodes/node-resources.html';\nvar html = \"<ion-view view-title=\\\"{{resourceLabel}}\\\" class=\\\"node-resources\\\">\\n\\t<ion-nav-bar class=\\\"bar-light\\\" align-title=\\\"center\\\">\\n\\t\\t<ion-nav-back-button class=\\\"button-compass button-clear\\\"></ion-nav-back-button>\\n\\t</ion-nav-bar>\\n\\t<ion-content delegate-handle=\\\"node-resources-scroll\\\">\\n\\t\\t<ion-refresher pulling-text=\\\"Pull to Refresh...\\\" on-refresh=\\\"refresh()\\\"></ion-refresher>\\n\\t\\t<ion-list>\\n\\t\\t\\t<span ng-repeat=\\\"resource in resources track by resource.id\\\">\\n\\t\\t\\t\\t<ion-item ng-if=\\\"resource.isDivider\\\" class=\\\"item-divider item-compass\\\">\\n\\t\\t\\t\\t\\t{{resource.id}}\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t\\t<ion-item ng-if=\\\"!resource.isDivider\\\" class=\\\"item-text-wrap\\\" ui-sref=\\\"node-resource({node:nodeId, resource:resource.id})\\\">\\n\\t\\t\\t\\t\\t{{resource.label}}\\n\\t\\t\\t\\t</ion-item>\\n\\t\\t\\t</span>\\n\\t\\t</ion-list>\\n\\t</ion-content>\\n</ion-view>\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/nodes/node-resources.html\n ** module id = 210\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/nodes/node-resources.html?./~/ngtemplate-loader!./~/html-loader");

/***/ },
/* 211 */
/*!************************************************!*\
  !*** ./src/app/settings/SettingsController.js ***!
  \************************************************/
/***/ function(module, exports, __webpack_require__) {

	eval("(function() {\n\t'use strict';\n\n\tvar angular = __webpack_require__(/*! angular */ 2),\n\t\tServer = __webpack_require__(/*! ../servers/models/Server */ 168);\n\n\t__webpack_require__(/*! ../availability/AvailabilityService */ 188);\n\t__webpack_require__(/*! ../servers/Servers */ 167);\n\t__webpack_require__(/*! ../settings/SettingsService */ 13);\n\n\t__webpack_require__(/*! ../misc/Capabilities */ 203);\n\t__webpack_require__(/*! ../misc/Errors */ 166);\n\t__webpack_require__(/*! ../misc/Info */ 119);\n\t__webpack_require__(/*! ../misc/util */ 129);\n\n\tvar editServerTemplate = __webpack_require__(/*! ngtemplate!html!./edit-server.html */ 212);\n\n\tangular.module('opennms.controllers.Settings', [\n\t\t'ionic',\n\t\t'opennms.services.Availability',\n\t\t'opennms.services.Capabilities',\n\t\t'opennms.services.Errors',\n\t\t'opennms.services.Info',\n\t\t'opennms.services.Servers',\n\t\t'opennms.services.Settings',\n\t\t'opennms.services.Util'\n\t])\n\t.factory('ServerModal', function($q, $rootScope, $log, $ionicModal, Servers, Settings) {\n\t\tvar $scope = $rootScope.$new();\n\n\t\t$scope.openModal = function(server) {\n\t\t\tif (server) {\n\t\t\t\t$scope.adding = false;\n\t\t\t\t$scope.server = angular.copy(server);\n\t\t\t} else {\n\t\t\t\t$scope.adding = true;\n\t\t\t\t$scope.server = {};\n\t\t\t}\n\n\t\t\treturn $ionicModal.fromTemplateUrl(editServerTemplate, {\n\t\t\t\tscope: $scope,\n\t\t\t\tanimation: 'slide-in-up',\n\t\t\t\tfocusFirstInput: false\n\t\t\t}).then(function(modal) {\n\t\t\t\t$scope.modal = modal;\n\t\t\t\tmodal.show();\n\t\t\t\treturn modal;\n\t\t\t}, function(err) {\n\t\t\t\t$log.error('ServerModal.open: failed: ' + angular.toJson(err));\n\t\t\t\treturn $q.reject(err);\n\t\t\t});\n\t\t};\n\n\t\t$scope.closeModal = function() {\n\t\t\tif ($scope.server) {\n\t\t\t\t$scope.server = undefined;\n\t\t\t}\n\t\t\tif ($scope.modal) {\n\t\t\t\t$scope.modal.hide();\n\t\t\t\t$scope.modal.remove();\n\t\t\t\t$scope.modal = undefined;\n\t\t\t}\n\t\t};\n\n\t\t$scope.saveServer = function() {\n\t\t\tvar server = $scope.server;\n\t\t\t$log.debug('ServerModal.save: Saving server: ' + angular.toJson(server));\n\t\t\tif (server && server.name && server.url) {\n\t\t\t\tServers.save(server)['finally'](function() {\n\t\t\t\t\t$scope.closeModal();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$log.warn('Server did not have a name or URL!');\n\t\t\t\t$scope.closeModal();\n\t\t\t}\n\t\t};\n\n\t\treturn {\n\t\t\topen: $scope.openModal,\n\t\t\tclose: $scope.closeModal\n\t\t};\n\t})\n\t.controller('SettingsCtrl', function($scope, $log, $timeout, $window, $filter, $ionicListDelegate, $ionicPlatform, $ionicPopup, ServerModal, AvailabilityService, Capabilities, Errors, Info, Servers, Settings, util) {\n\t\t$log.info('Settings initializing.');\n\t\t$scope.util = util;\n\n\t\t$scope.addServer = function() {\n\t\t\tServerModal.open().then(function() {\n\t\t\t\t$ionicListDelegate.$getByHandle('server-list').closeOptionButtons();\n\t\t\t});\n\t\t};\n\n\t\t$scope.editServer = function(server) {\n\t\t\tserver.originalName = server.name;\n\t\t\tServerModal.open(server).then(function() {\n\t\t\t\t$ionicListDelegate.$getByHandle('server-list').closeOptionButtons();\n\t\t\t});\n\t\t};\n\n\t\t$scope.deleteServer = function(server) {\n\t\t\treturn Servers.remove(server).then(function() {\n\t\t\t\treturn server;\n\t\t\t});\n\t\t};\n\n\t\t$scope.selectServer = function(server) {\n\t\t\t$ionicListDelegate.$getByHandle('server-list').closeOptionButtons();\n\t\t\t$log.debug('SettingsCtrl.selectServer: ' + server.name);\n\t\t\tServers.setDefault(server);\n\t\t};\n\n\t\tvar initDefaultServer = function() {\n\t\t\tServers.getDefault().then(function(defaultServer) {\n\t\t\t\t$scope.defaultServer = defaultServer;\n\t\t\t});\n\t\t};\n\n\t\tvar init = function() {\n\t\t\t$log.debug('SettingsCtrl.init(): ' + $scope.launchAddServer);\n\t\t\tinitDefaultServer();\n\t\t\tServers.all().then(function(servers) {\n\t\t\t\tif ($scope.launchAddServer) {\n\t\t\t\t\t$scope.launchAddServer = false;\n\t\t\t\t\tif (servers.length === 0) {\n\t\t\t\t\t\t$scope.addServer();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$scope.servers = servers;\n\t\t\t});\n\t\t\tSettings.get().then(function(settings) {\n\t\t\t\t$scope.settings = settings;\n\t\t\t});\n\t\t\tSettings.version().then(function(version) {\n\t\t\t\t$scope.version = version;\n\t\t\t});\n\t\t\tSettings.build().then(function(build) {\n\t\t\t\t$scope.build = build;\n\t\t\t});\n\t\t\t$scope.errors = Errors.get();\n\t\t\t$scope.info = Info.get();\n\t\t\t$scope.canSetLocation = Capabilities.setLocation();\n\t\t\tAvailabilityService.supported().then(function(isSupported) {\n\t\t\t\t$scope.hasAvailability = isSupported;\n\t\t\t}).finally(function() {\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t});\n\t\t};\n\t\tinit();\n\n\t\t$scope.save = function() {\n\t\t\tSettings.set($scope.settings);\n\t\t\tif ($scope.hide) {\n\t\t\t\t$scope.hide();\n\t\t\t}\n\t\t};\n\t\t$scope.formatType = function(type) {\n\t\t\tif (type) {\n\t\t\t\tvar chunks = type.split('-');\n\t\t\t\tvar ret = '';\n\t\t\t\tfor (var i=0, len=chunks.length; i < len; i++) {\n\t\t\t\t\tret += chunks[i].capitalize();\n\t\t\t\t\tif (i+1 !== chunks.length) {\n\t\t\t\t\t\tret += ' ';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\treturn type;\n\t\t};\n\n\t\t$scope.getErrorMessage = function(error) {\n\t\t\tif (error.message && error.message.toString) {\n\t\t\t\treturn error.message.toString();\n\t\t\t} else {\n\t\t\t\treturn error.message;\n\t\t\t}\n\t\t};\n\n\t\t$scope.clearErrors = function() {\n\t\t\tErrors.reset();\n\t\t};\n\n\t\t$scope.isDefaultServer = function(server) {\n\t\t\treturn server && $scope.defaultServer && server._id === $scope.defaultServer._id;\n\t\t};\n\n\t\t$scope.getRefreshInterval = function() {\n\t\t\treturn Math.round(parseInt($scope.settings.refreshInterval, 10)/1000);\n\t\t};\n\n\t\t$scope.handleKey = function(ev) {\n\t\t\tif (ev.which === 13) {\n\t\t\t\tutil.hideKeyboard();\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t}\n\t\t};\n\n\t\tutil.onInfoUpdated(function() {\n\t\t\t$scope.info = Info.get();\n\t\t\t$scope.canSetLocation = Capabilities.setLocation();\n\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t});\n\t\tutil.onSettingsUpdated(function() {\n\t\t\tinit();\n\t\t});\n\t\tutil.onServersUpdated(function(newServers) {\n\t\t\t$scope.servers = newServers;\n\t\t\tinitDefaultServer();\n\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t});\n\t\tutil.onServerRemoved(function() {\n\t\t\tServers.all().then(function(servers) {\n\t\t\t\t$scope.servers = servers;\n\t\t\t\tinitDefaultServer();\n\t\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t\t});\n\t\t});\n\t\tutil.onErrorsUpdated(function() {\n\t\t\t$scope.errors = Errors.get();\n\t\t\t$scope.$broadcast('scroll.refreshComplete');\n\t\t});\n\t\tutil.onInfoUpdated(init);\n\n\t\t$scope.$on('modal.shown', init);\n\t});\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/settings/SettingsController.js\n ** module id = 211\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/settings/SettingsController.js?");

/***/ },
/* 212 */
/*!*********************************************************************************!*\
  !*** ./~/ngtemplate-loader!./~/html-loader!./src/app/settings/edit-server.html ***!
  \*********************************************************************************/
/***/ function(module, exports) {

	eval("var path = '/Users/patrick/Development/BuildRoot/SCCOpenNMS-2.1/src/app/settings/edit-server.html';\nvar html = \"<ion-modal-view class=\\\"settings\\\" ng-controller=\\\"SettingsCtrl\\\">\\n\\t<form name=\\\"editServer\\\" novalidate>\\n\\t\\t<ion-header-bar class=\\\"bar-light\\\">\\n\\t\\t\\t<div class=\\\"buttons\\\">\\n\\t\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"closeModal()\\\">Cancel</button>\\n\\t\\t\\t</div>\\n\\t\\t\\t<h1 class=\\\"title\\\">{{adding? 'Add':'Edit'}} Server</h1>\\n\\t\\t\\t<div class=\\\"buttons\\\">\\n\\t\\t\\t\\t<button class=\\\"button button-compass button-clear\\\" ng-click=\\\"saveServer()\\\" ng-disabled=\\\"editServer.$invalid\\\">Save</button>\\n\\t\\t\\t</div>\\n\\t\\t</ion-header-bar>\\n\\t\\t<ion-content scroll=\\\"true\\\">\\n\\t\\t\\t<ion-list>\\n\\t\\t\\t\\t<label class=\\\"item item-input item-stacked-label\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"input-label\\\">Name</span>\\n\\t\\t\\t\\t\\t<input name=\\\"name\\\" type=\\\"text\\\" placeholder=\\\"displayable name for server ('default', 'home', etc.)\\\" ng-model=\\\"server.name\\\" ng-model-options=\\\"{debounce:200}\\\" required autofocus>\\n\\t\\t\\t\\t</label>\\n\\t\\t\\t\\t<label class=\\\"item item-input item-stacked-label\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"input-label\\\">Server URL <span ng-show=\\\"editServer.url.$error.url\\\" class=\\\"error\\\">please enter a valid URL</span></span>\\n\\t\\t\\t\\t\\t<input name=\\\"url\\\" type=\\\"url\\\" placeholder=\\\"e.g., http://demo.opennms.org/opennms/\\\" ng-model=\\\"server.url\\\" ng-model-options=\\\"{debounce:200}\\\" autocapitalize=\\\"off\\\" required>\\n\\t\\t\\t\\t</label>\\n\\t\\t\\t\\t<label class=\\\"item item-input item-floating-label\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"input-label\\\">Username</span>\\n\\t\\t\\t\\t\\t<input name=\\\"username\\\" type=\\\"text\\\" placeholder=\\\"Username\\\" ng-model=\\\"server.username\\\" ng-model-options=\\\"{debounce:200}\\\" autocapitalize=\\\"off\\\" autocorrect=\\\"off\\\" required>\\n\\t\\t\\t\\t</label>\\n\\t\\t\\t\\t<label class=\\\"item item-input item-floating-label\\\">\\n\\t\\t\\t\\t\\t<span class=\\\"input-label\\\">Password</span>\\n\\t\\t\\t\\t\\t<input name=\\\"password\\\" type=\\\"password\\\" placeholder=\\\"Password\\\" ng-model=\\\"server.password\\\" ng-model-options=\\\"{debounce:200}\\\" autocapitalize=\\\"off\\\" required>\\n\\t\\t\\t\\t</label>\\n\\t\\t\\t</ion-list>\\n\\t\\t</ion-content>\\n\\t</form>\\n</ion-modal-view>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ngtemplate-loader!./~/html-loader!./src/app/settings/edit-server.html\n ** module id = 212\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./src/app/settings/edit-server.html?./~/ngtemplate-loader!./~/html-loader");

/***/ }
]);